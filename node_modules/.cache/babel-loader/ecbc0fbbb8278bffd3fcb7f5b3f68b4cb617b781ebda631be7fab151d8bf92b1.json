{"ast":null,"code":"var _jsxFileName = \"E:\\\\infyle\\\\Grocerry_final\\\\frontend\\\\src\\\\pages\\\\PriceList.jsx\",\n  _s = $RefreshSig$();\n// import React, { useEffect, useState, useRef } from \"react\";\n// import axios from \"axios\";\n// import \"./PriceList.css\"\n// const API_URL = \"https://grocerrybackend.vercel.app/api/prices\";\n// const CATEGORY_URL = \"https://grocerrybackend.vercel.app/api/categories\";\n\n// export default function PriceList() {\n//   const [items, setItems] = useState([]);\n//   const [categories, setCategories] = useState([]);\n//   const [subcategories, setSubcategories] = useState([]);\n//   const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\n//   const [search, setSearch] = useState(\"\");\n//   const [loading, setLoading] = useState(false);\n\n//   // FORM state\n//   const [form, setForm] = useState({\n//     name: \"\",\n//     category: \"\",\n//     subcategory: \"\",\n//     description: \"\",\n//     basePrice: \"\",\n//     difference: \"\",\n//     validTill: \"\",\n//     file: null,\n//   });\n\n//   const [editId, setEditId] = useState(null);\n//   const [isCopyMode, setIsCopyMode] = useState(false);\n//   const [showForm, setShowForm] = useState(false);\n//   const [showModal, setShowModal] = useState(false);\n//   const [activeMenu, setActiveMenu] = useState(null);\n\n//   const [addingCategory, setAddingCategory] = useState(false);\n//   const [newCategoryName, setNewCategoryName] = useState(\"\");\n//   const [newCategoryImage, setNewCategoryImage] = useState(null);\n//   const [newCategoryPreview, setNewCategoryPreview] = useState(null);\n\n//   const [addingSub, setAddingSub] = useState(false);\n//   const [newSubName, setNewSubName] = useState(\"\");\n//   const [newSubImage, setNewSubImage] = useState(null);\n//   const [newSubPreview, setNewSubPreview] = useState(null);\n\n//   const [selectedItems, setSelectedItems] = useState([]);\n//   const [bulkMode, setBulkMode] = useState(false);\n\n//   const [csvFile, setCsvFile] = useState(null);\n//   const csvInputRef = useRef();\n\n//   const [currentPage, setCurrentPage] = useState(1);\n//   const itemsPerPage = 30;\n\n//   const [filterCategory, setFilterCategory] = useState(\"\");\n// const [filterSubcategory, setFilterSubcategory] = useState(\"\");\n// const [filterSubs, setFilterSubs] = useState([]);\n\n// useEffect(() => {\n//   if (!filterCategory) {\n//     setFilterSubs([]);\n//     setFilterSubcategory(\"\");\n//     return;\n//   }\n\n//   const cat = categories.find(c => c._id === filterCategory);\n//   setFilterSubs(cat?.subcategories || []);\n//   setFilterSubcategory(\"\");\n// }, [filterCategory, categories]);\n\n//   // useEffect(() => {\n//   //   fetchItems();\n//   //   fetchCategories();\n\n//   //   const handleResize = () => setIsMobile(window.innerWidth < 768);\n//   //   window.addEventListener(\"resize\", handleResize);\n//   //   return () => window.removeEventListener(\"resize\", handleResize);\n//   // }, []);\n//   // 1. Pehle categories load karo\n// useEffect(() => {\n//   fetchCategories();\n// }, []);\n\n// // 2. Categories load hone ke baad items load karo\n// useEffect(() => {\n//   if (categories.length > 0) {\n//     fetchItems();\n//   }\n// }, [categories]);\n\n// // 3. Resize listener\n// useEffect(() => {\n//   const handleResize = () => setIsMobile(window.innerWidth < 768);\n//   window.addEventListener(\"resize\", handleResize);\n//   return () => window.removeEventListener(\"resize\", handleResize);\n// }, []);\n\n//   const fetchItems = async () => {\n//     try {\n//       setLoading(true);\n//       const res = await axios.get(API_URL);\n//       // if (res.data && res.data.success) setItems(res.data.data || []);\n//       if (res.data && res.data.success) {\n//   const raw = res.data.data;\n\n//   // Agar categories abhi load nahi hui = raw items set\n//   if (!categories.length) {\n//     setItems(raw);\n//     return;\n//   }\n\n//   // Mapping to category + subcategory object\n//   const enriched = raw.map((item) => {\n//     const cat = categories.find(\n//       (c) =>\n//         c._id === item.category ||\n//         c._id === item.category?._id\n//     );\n\n//     const sub = cat?.subcategories?.find(\n//       (s) =>\n//         s._id === item.subcategory ||\n//         s._id === item.subcategory?._id\n//     );\n\n//     return {\n//       ...item,\n//       category: cat\n//         ? { _id: cat._id, name: cat.name }\n//         : item.category,\n\n//       subcategory: sub\n//         ? { _id: sub._id, name: sub.name }\n//         : item.subcategory,\n//     };\n//   });\n\n//   setItems(enriched);\n// }\n\n//     } catch (err) {\n//       console.error(\"Fetch items error\", err);\n//       alert(\"Could not fetch items\");\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   const fetchCategories = async () => {\n//     try {\n//       const res = await axios.get(CATEGORY_URL);\n//       if (res.data && res.data.success) setCategories(res.data.categories || []);\n//     } catch (err) {\n//       console.error(\"Fetch categories error\", err);\n//       alert(\"Could not fetch categories\");\n//     }\n//   };\n\n//   useEffect(() => {\n//     if (!form.category) {\n//       setSubcategories([]);\n//       setForm((prev) => ({ ...prev, subcategory: \"\" }));\n//       return;\n//     }\n\n//     const cat = categories.find((c) => c._id === form.category);\n//     const subs = (cat && cat.subcategories) || [];\n//     setSubcategories(subs);\n\n//     const exists = subs.some((s) => s._id === form.subcategory);\n//     if (!exists) setForm((prev) => ({ ...prev, subcategory: \"\" }));\n//   }, [form.category, categories]);\n\n//   const handleCreateCategory = async () => {\n//     if (!newCategoryName.trim()) return alert(\"Enter category name\");\n//     try {\n//       const fd = new FormData();\n//       fd.append(\"name\", newCategoryName.trim());\n//       if (newCategoryImage) fd.append(\"image\", newCategoryImage);\n\n//       const res = await axios.post(CATEGORY_URL, fd);\n//       if (res.data && res.data.success) {\n//         alert(\"Category created\");\n//         setNewCategoryName(\"\");\n//         setNewCategoryImage(null);\n//         setNewCategoryPreview(null);\n//         setAddingCategory(false);\n//         fetchCategories();\n//       } else {\n//         alert(\"Category creation failed\");\n//       }\n//     } catch (err) {\n//       console.error(\"Create category error\", err);\n//       alert(\"Category creation failed\");\n//     }\n//   };\n\n//   const handleCreateSub = async () => {\n//     if (!newSubName.trim()) return alert(\"Enter subcategory name\");\n//     if (!form.category) return alert(\"Select category first\");\n\n//     try {\n//       const fd = new FormData();\n//       fd.append(\"name\", newSubName.trim());\n//       if (newSubImage) fd.append(\"image\", newSubImage);\n\n//       const res = await axios.post(`${CATEGORY_URL}/${form.category}/sub`, fd);\n//       if (res.data && res.data.success) {\n//         alert(\"Subcategory created\");\n//         setNewSubName(\"\");\n//         setNewSubImage(null);\n//         setNewSubPreview(null);\n//         setAddingSub(false);\n//         fetchCategories();\n//       } else {\n//         alert(\"Subcategory creation failed\");\n//       }\n//     } catch (err) {\n//       console.error(\"Create sub error\", err);\n//       alert(\"Subcategory creation failed\");\n//     }\n//   };\n\n//   const handleChange = (e) => {\n//     const { name, value, files } = e.target;\n//     if (files && files.length) {\n//       setForm((p) => ({ ...p, file: files[0] }));\n//     } else {\n//       setForm((p) => ({ ...p, [name]: value }));\n//     }\n//   };\n\n//   const handleSubmit = async (e) => {\n//     e.preventDefault();\n//     setLoading(true);\n\n//     try {\n//       if (!form.name || !form.category || !form.basePrice) {\n//         alert(\"Name, category & base price are required\");\n//         setLoading(false);\n//         return;\n//       }\n\n//       const fd = new FormData();\n//       Object.keys(form).forEach((k) => {\n//         const val = form[k];\n//         if (val !== undefined && val !== null) {\n//           fd.append(k, val);\n//         }\n//       });\n\n//       let res;\n//       if (isCopyMode) {\n//         res = await axios.post(API_URL, fd);\n//         alert(\"Copied as new item\");\n//       } else if (editId) {\n//         res = await axios.put(`${API_URL}/${editId}`, fd);\n//         alert(\"Updated\");\n//       } else {\n//         res = await axios.post(API_URL, fd);\n//         alert(\"Added\");\n//       }\n\n//       await fetchItems();\n//       await fetchCategories();\n\n//       setForm({\n//         name: \"\",\n//         category: \"\",\n//         subcategory: \"\",\n//         description: \"\",\n//         basePrice: \"\",\n//         difference: \"\",\n//         validTill: \"\",\n//         file: null,\n//       });\n//       setEditId(null);\n//       setIsCopyMode(false);\n//       setShowModal(false);\n//       setShowForm(false);\n//     } catch (err) {\n//       console.error(\"Save error\", err);\n//       alert(\"Save failed\");\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   const handleEdit = (item) => {\n//     setForm({\n//       name: item.name || \"\",\n//       category: item.category?._id?.toString() || \"\",\n//       subcategory: item.subcategory?._id?.toString() || \"\",\n//       description: item.description || \"\",\n//       basePrice: item.basePrice ?? \"\",\n//       difference: item.difference ?? \"\",\n//       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n//       file: null,\n//     });\n\n//     const cat = categories.find((c) => c._id === item.category?._id);\n//     setSubcategories(cat?.subcategories || []);\n\n//     setEditId(item._id);\n//     setIsCopyMode(false);\n//     setShowModal(true);\n//     setActiveMenu(null);\n//   };\n\n//   const handleCopyToEdit = (item) => {\n//     setForm({\n//       name: item.name || \"\",\n//       category: item.category?._id?.toString() || \"\",\n//       subcategory: item.subcategory?._id?.toString() || \"\",\n//       description: item.description || \"\",\n//       basePrice: item.basePrice ?? \"\",\n//       difference: item.difference ?? \"\",\n//       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n//       file: null,\n//     });\n\n//     const cat = categories.find((c) => c._id === item.category?._id);\n//     setSubcategories(cat?.subcategories || []);\n\n//     setEditId(null);\n//     setIsCopyMode(true);\n//     setShowModal(true);\n//     setActiveMenu(null);\n//   };\n\n//   const handleDelete = async (id) => {\n//     if (!window.confirm(\"Delete item?\")) return;\n//     try {\n//       await axios.delete(`${API_URL}/${id}`);\n//       setItems((prev) => prev.filter((x) => x._id !== id));\n//       setSelectedItems((prev) => prev.filter((x) => x !== id));\n//       setActiveMenu(null);\n//     } catch (err) {\n//       console.error(\"Delete error\", err);\n//       alert(\"Delete failed\");\n//     }\n//   };\n\n//   const handleStatusToggle = async (item) => {\n//     try {\n//       const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\n//       await axios.put(`${API_URL}/status/${item._id}`, { status: newStatus });\n//       setItems((prev) => prev.map((x) => (x._id === item._id ? { ...x, status: newStatus } : x)));\n//     } catch (err) {\n//       console.error(\"Status toggle error\", err);\n//       alert(\"Status update failed\");\n//     }\n//   };\n\n//   const handleBulkDelete = async () => {\n//     if (!selectedItems.length) return alert(\"No items selected\");\n//     if (!window.confirm(\"Delete selected items?\")) return;\n\n//     try {\n//       await Promise.all(selectedItems.map((id) => axios.delete(`${API_URL}/${id}`)));\n//       setSelectedItems([]);\n//       fetchItems();\n//       setBulkMode(false);\n//     } catch (err) {\n//       console.error(\"Bulk delete error\", err);\n//       alert(\"Bulk delete failed\");\n//     }\n//   };\n\n//   const updateLocalItemField = (id, key, value) => {\n//     setItems((prev) => prev.map((x) => (x._id === id ? { ...x, [key]: value } : x)));\n//   };\n\n//   const handleBulkSave = async () => {\n//     if (!selectedItems.length) return alert(\"No items selected for bulk save\");\n\n//     const updates = items\n//       .filter((x) => selectedItems.includes(x._id))\n//       .map((x) => ({\n//         id: x._id,\n//         name: x.name,\n//         basePrice: x.basePrice,\n//         difference: x.difference,\n//         validTill: x.validTill,\n//       }));\n\n//     try {\n//       await axios.post(`${API_URL}/bulk-update`, { products: updates });\n//       setBulkMode(false);\n//       setSelectedItems([]);\n//       fetchItems();\n//     } catch (err) {\n//       console.error(\"Bulk save error\", err);\n//       alert(\"Bulk save failed\");\n//     }\n//   };\n\n//   const handleCsvSelect = (e) => {\n//     setCsvFile(e.target.files[0]);\n//   };\n\n//   const handleImportCsv = async () => {\n//     if (!csvFile) return alert(\"Select CSV file\");\n//     try {\n//       const fd = new FormData();\n//       fd.append(\"file\", csvFile);\n//       const res = await axios.post(`${API_URL}/import`, fd);\n//       if (res.data && res.data.success) {\n//         alert(`Imported ${res.data.inserted || 0} items`);\n//         setCsvFile(null);\n//         if (csvInputRef.current) csvInputRef.current.value = null;\n//         fetchItems();\n//       } else {\n//         alert(\"CSV import failed\");\n//       }\n//     } catch (err) {\n//       console.error(\"CSV import error\", err);\n//       alert(\"CSV import failed\");\n//     }\n//   };\n\n//   // const handleExportCsv = async () => {\n//   //   try {\n//   //     const res = await axios.get(`${API_URL}/export`, { responseType: \"blob\" });\n//   //     const url = window.URL.createObjectURL(new Blob([res.data]));\n//   //     const a = document.createElement(\"a\");\n//   //     a.href = url;\n//   //     a.download = \"prices.csv\";\n//   //     a.click();\n//   //     URL.revokeObjectURL(url);\n//   //   } catch (err) {\n//   //     console.error(\"CSV export error\", err);\n//   //     alert(\"CSV export failed\");\n//   //   }\n//   // };\n// const handleExportCsv = () => {\n//   if (!items.length) return alert(\"No items to export\");\n\n//   const header = [\n//     \"id\",\n//     \"name\",\n//     \"categoryName\",\n//     \"subcategoryName\",\n//     \"basePrice\",\n//     \"difference\",\n//     \"finalPrice\",\n//     \"status\",\n//     \"validTill\",\n//     \"description\",\n//     \"imageUrl\",\n//   ];\n\n//   const rows = items.map((p) => [\n//     p._id,\n//     p.name || \"\",\n//     p.category?.name || \"\",\n//     p.subcategory?.name || \"\",\n//     p.basePrice ?? \"\",\n//     p.difference ?? \"\",\n//     (Number(p.basePrice) + Number(p.difference || 0)) || \"\",\n//     p.status || \"\",\n//     p.validTill ? new Date(p.validTill).toISOString().split(\"T\")[0] : \"\",\n//     p.description || \"\",\n//     p.image || \"\",\n//   ]);\n\n//   const csvArray = [header, ...rows];\n//   const csvContent =\n//     \"data:text/csv;charset=utf-8,\" +\n//     csvArray\n//       .map((r) => r.map((c) => `\"${String(c).replace(/\"/g, '\"\"')}\"`).join(\",\"))\n//       .join(\"\\n\");\n\n//   const encodedUri = encodeURI(csvContent);\n//   const link = document.createElement(\"a\");\n//   link.href = encodedUri;\n//   link.download = `all_prices_${Date.now()}.csv`;\n//   link.click();\n// };\n\n//   const handleExportSelectedCsv = () => {\n//     if (!selectedItems.length) return alert(\"Select items to export\");\n\n//     const selectedData = items.filter((x) => selectedItems.includes(x._id));\n//     const header = [\n//       \"id\",\n//       \"name\",\n//       \"categoryName\",\n//       \"subcategoryName\",\n//       \"basePrice\",\n//       \"difference\",\n//       \"finalPrice\",\n//       \"status\",\n//       \"validTill\",\n//       \"description\",\n//       \"imageUrl\",\n//     ];\n\n//     const rows = selectedData.map((p) => [\n//       p._id,\n//       p.name || \"\",\n//       p.category?.name || \"\",\n//       p.subcategory?.name || \"\",\n//       p.basePrice ?? \"\",\n//       p.difference ?? \"\",\n//       (Number(p.basePrice) + Number(p.difference || 0)) || \"\",\n//       p.status || \"\",\n//       p.validTill ? new Date(p.validTill).toISOString().split(\"T\")[0] : \"\",\n//       p.description || \"\",\n//       p.image || \"\",\n//     ]);\n\n//     const csvArray = [header, ...rows];\n//     const csvContent =\n//       \"data:text/csv;charset=utf-8,\" +\n//       csvArray.map((r) => r.map((c) => `\"${String(c).replace(/\"/g, '\"\"')}\"`).join(\",\")).join(\"\\n\");\n\n//     const encodedUri = encodeURI(csvContent);\n//     const link = document.createElement(\"a\");\n//     link.href = encodedUri;\n//     link.download = `selected_prices_${Date.now()}.csv`;\n//     link.click();\n//   };\n\n//   // const filteredItems = items.filter((item) => {\n//   //   const t = search.toLowerCase();\n//   //   return (\n//   //     (item.name || \"\").toString().toLowerCase().includes(t) ||\n//   //     (item.category?.name || \"\").toLowerCase().includes(t) ||\n//   //     (item.subcategory?.name || \"\").toLowerCase().includes(t)\n//   //   );\n//   // });\n//   const filteredItems = items.filter((item) => {\n//   const t = search.toLowerCase();\n\n//   const matchText =\n//     (item.name || \"\").toLowerCase().includes(t) ||\n//     (item.category?.name || \"\").toLowerCase().includes(t) ||\n//     (item.subcategory?.name || \"\").toLowerCase().includes(t);\n\n//   const matchCategory =\n//     !filterCategory || item.category?._id === filterCategory;\n\n//   const matchSub =\n//     !filterSubcategory || item.subcategory?._id === filterSubcategory;\n\n//   return matchText && matchCategory && matchSub;\n// });\n\n//   const indexOfLast = currentPage * itemsPerPage;\n//   const currentItems = filteredItems.slice(indexOfLast - itemsPerPage, indexOfLast);\n//   const totalPages = Math.max(1, Math.ceil(filteredItems.length / itemsPerPage));\n\n//   return (\n//     <div style={styles.container}>\n//       {/* HEADER */}\n//       <div style={styles.header}>\n//         <h1 style={styles.title}>Product Management</h1>\n//         {/* <p style={styles.subtitle}>Manage prices, categories, images, CSV & bulk actions.</p> */}\n//       </div>\n\n//       {/* SEARCH */}\n\n//      <div className=\"mobile-topbar\">\n//   <input\n//     type=\"text\"\n//     placeholder=\"Search product, category or subcategory...\"\n//     value={search}\n//     onChange={(e) => {\n//       setSearch(e.target.value);\n//       setCurrentPage(1);\n//     }}\n//     style={styles.searchInput}\n//   />\n\n//   <button\n//     style={styles.addButton}\n//     onClick={() => {\n//       setShowForm(!showForm);\n//       setEditId(null);\n//       setIsCopyMode(false);\n//     }}\n//   >\n//     {showForm ? \"‚úñ\" : \"Add Product\"}\n//   </button>\n// </div>\n// <div className=\"filter-bar\">\n//   <select\n//     value={filterCategory}\n//     onChange={(e) => setFilterCategory(e.target.value)}\n//     className=\"filter-select\"\n//   >\n//     <option value=\"\">Filter by Category</option>\n//     {categories.map((c) => (\n//       <option key={c._id} value={c._id}>{c.name}</option>\n//     ))}\n//   </select>\n\n//   <select\n//     value={filterSubcategory}\n//     onChange={(e) => setFilterSubcategory(e.target.value)}\n//     className=\"filter-select\"\n//     disabled={!filterSubs.length}\n//   >\n//     <option value=\"\">Filter by Subcategory</option>\n//     {filterSubs.map((s) => (\n//       <option key={s._id} value={s._id}>{s.name}</option>\n//     ))}\n//   </select>\n\n// </div>\n\n//       {/* BULK BAR */}\n//       {selectedItems.length > 0 && (\n//         // <div style={styles.bulkBar}>\n//         <div className=\"bulk-bar\">\n\n//           {/* <span style={styles.bulkText}>{selectedItems.length} selected</span> */}\n\n//           {!bulkMode ? (\n//             // <div style={{ display: \"flex\", gap: 10, flexWrap: \"wrap\" }}>\n//             <div className=\"bulk-actions\">\n\n//               <button style={styles.btnDelete} onClick={handleBulkDelete}>\n//                 üóë Bulk Delete\n//               </button>\n\n//               <button style={styles.btnPrimary} onClick={() => setBulkMode(true)}>\n//                 ‚úè Bulk Edit\n//               </button>\n\n//               {/* <button style={styles.btnSmall} onClick={handleExportSelectedCsv}>\n//                 ‚§ì Export Selected\n//               </button> */}\n//             </div>\n//           ) : (\n//             <div style={styles.bulkPanel}>\n//               <h3 style={styles.bulkPanelTitle}>‚úè Bulk Edit Selected Items</h3>\n\n//               {items\n//                 .filter((item) => selectedItems.includes(item._id))\n//                 .map((item) => (\n//                   <div key={item._id} style={styles.bulkItemBox}>\n//                     <h4 style={styles.bulkItemTitle}>{item.name}</h4>\n\n//                     <div style={styles.formGrid}>\n//                       <div style={styles.formGroup}>\n//                         <label style={styles.label}>Name</label>\n//                         <input\n//                           type=\"text\"\n//                           value={item.name}\n//                           onChange={(e) => updateLocalItemField(item._id, \"name\", e.target.value)}\n//                           style={styles.input}\n//                         />\n//                       </div>\n\n//                       <div style={styles.formGroup}>\n//                         <label style={styles.label}>Base Price</label>\n//                         <input\n//                           type=\"number\"\n//                           value={item.basePrice}\n//                           onChange={(e) =>\n//                             updateLocalItemField(item._id, \"basePrice\", Number(e.target.value))\n//                           }\n//                           style={styles.input}\n//                         />\n//                       </div>\n\n//                       <div style={styles.formGroup}>\n//                         <label style={styles.label}>Category</label>\n//                         <select\n//                           value={item.category?._id || \"\"}\n//                           onChange={(e) => {\n//                             const newCat = e.target.value;\n//                             updateLocalItemField(item._id, \"category\", { _id: newCat });\n//                             const catObj = categories.find((c) => c._id === newCat);\n//                             const firstSub = catObj?.subcategories?.[0]?._id || \"\";\n//                             updateLocalItemField(item._id, \"subcategory\", { _id: firstSub });\n//                           }}\n//                           style={styles.select}\n//                         >\n//                           <option value=\"\">Select Category</option>\n//                           {categories.map((c) => (\n//                             <option key={c._id} value={c._id}>\n//                               {c.name}\n//                             </option>\n//                           ))}\n//                         </select>\n//                       </div>\n\n//                       <div style={styles.formGroup}>\n//                         <label style={styles.label}>Subcategory</label>\n//                         <select\n//                           value={item.subcategory?._id || \"\"}\n//                           onChange={(e) =>\n//                             updateLocalItemField(item._id, \"subcategory\", { _id: e.target.value })\n//                           }\n//                           style={styles.select}\n//                         >\n//                           <option value=\"\">Select Subcategory</option>\n//                           {categories\n//                             .find((c) => c._id === item.category?._id)\n//                             ?.subcategories?.map((s) => (\n//                               <option key={s._id} value={s._id}>\n//                                 {s.name}\n//                               </option>\n//                             ))}\n//                         </select>\n//                       </div>\n\n//                       <div style={styles.formGroup}>\n//                         <label style={styles.label}>Difference</label>\n//                         <input\n//                           type=\"number\"\n//                           value={item.difference || 0}\n//                           onChange={(e) =>\n//                             updateLocalItemField(item._id, \"difference\", Number(e.target.value))\n//                           }\n//                           style={styles.input}\n//                         />\n//                       </div>\n//                     </div>\n//                   </div>\n//                 ))}\n\n//               <div style={{ display: \"flex\", gap: 0, marginTop: 12 }}>\n//                 <button style={styles.btnPrimary} onClick={handleBulkSave}>\n//                   ‚úî Save All\n//                 </button>\n//                 <button style={styles.btnCancel} onClick={() => setBulkMode(false)}>\n//                   ‚úñ Cancel\n//                 </button>\n//               </div>\n//             </div>\n//           )}\n//         </div>\n//       )}\n\n//       {/* FORM */}\n//       {showForm && (\n//         <div style={styles.formCard}>\n//           <h2 style={styles.formTitle}>‚ûï Add \n\n//           </h2>\n\n//           <form onSubmit={handleSubmit}>\n//             <div style={styles.formGrid}>\n//               <div style={styles.formGroup}>\n//                 <label style={styles.label}>Product Name *</label>\n//                 <input required name=\"name\" value={form.name} onChange={handleChange} style={styles.input} />\n//               </div>\n\n//               <div style={styles.formGroup}>\n//                 <label style={styles.label}>Category *</label>\n//                 <div style={styles.categoryRow}>\n//                   <select\n//                     required\n//                     name=\"category\"\n//                     value={form.category}\n//                     onChange={(e) => {\n//                       handleChange(e);\n//                       setForm((p) => ({ ...p, subcategory: \"\" }));\n//                     }}\n//                     style={styles.select}\n//                   >\n//                     <option value=\"\">Select Category</option>\n//                     {categories.map((c) => (\n//                       <option value={c._id} key={c._id}>\n//                         {c.name}\n//                       </option>\n//                     ))}\n//                   </select>\n\n//                   <button type=\"button\" style={styles.btnSmall} onClick={() => setAddingCategory((v) => !v)}>\n//                     {addingCategory ? \"Close\" : \"Add\"}\n//                   </button>\n//                 </div>\n//               </div>\n\n//               {addingCategory && (\n//                 <div style={styles.addCategoryBox}>\n//                   <label style={styles.label}>Add New Category</label>\n//                   <div style={styles.categoryRow}>\n//                     <input\n//                       value={newCategoryName}\n//                       onChange={(e) => setNewCategoryName(e.target.value)}\n//                       placeholder=\"Category name\"\n//                       style={styles.input}\n//                     />\n//                     <input\n//                       type=\"file\"\n//                       accept=\"image/*\"\n//                       onChange={(e) => {\n//                         setNewCategoryImage(e.target.files[0]);\n//                         setNewCategoryPreview(e.target.files[0] ? URL.createObjectURL(e.target.files[0]) : null);\n//                       }}\n//                       style={styles.fileInput}\n//                     />\n//                     <button style={styles.btnPrimary} type=\"button\" onClick={handleCreateCategory}>\n//                       Create\n//                     </button>\n//                   </div>\n//                   {newCategoryPreview && <img src={newCategoryPreview} style={styles.preview} alt=\"preview\" />}\n//                 </div>\n//               )}\n\n//               <div style={styles.formGroup}>\n//                 <label style={styles.label}>Subcategory</label>\n//                 <div style={styles.categoryRow}>\n//                   <select name=\"subcategory\" value={form.subcategory} onChange={handleChange} disabled={!subcategories.length} style={styles.select}>\n//                     <option value=\"\">Select Subcategory</option>\n//                     {subcategories.map((s) => (\n//                       <option value={s._id} key={s._id}>\n//                         {s.name}\n//                       </option>\n//                     ))}\n//                   </select>\n\n//                   {form.category && (\n//                     <button type=\"button\" style={styles.btnSmall} onClick={() => setAddingSub((v) => !v)}>\n//                       {addingSub ? \"Close\" : \"Add\"}\n//                     </button>\n//                   )}\n//                 </div>\n//               </div>\n\n//               {addingSub && (\n//                 <div style={styles.addCategoryBox}>\n//                   <label style={styles.label}>Add New Subcategory</label>\n//                   <div style={styles.categoryRow}>\n//                     <input value={newSubName} onChange={(e) => setNewSubName(e.target.value)} placeholder=\"Subcategory name\" style={styles.input} />\n//                     <input\n//                       type=\"file\"\n//                       accept=\"image/*\"\n//                       onChange={(e) => {\n//                         setNewSubImage(e.target.files[0]);\n//                         setNewSubPreview(e.target.files[0] ? URL.createObjectURL(e.target.files[0]) : null);\n//                       }}\n//                       style={styles.fileInput}\n//                     />\n//                     <button style={styles.btnPrimary} type=\"button\" onClick={handleCreateSub}>\n//                       Create\n//                     </button>\n//                   </div>\n//                   {newSubPreview && <img src={newSubPreview} style={styles.preview} alt=\"preview\" />}\n//                 </div>\n//               )}\n\n//               <div style={styles.formGroup}>\n//                 <label style={styles.label}>Base Price *</label>\n//                 <input type=\"number\" required name=\"basePrice\" value={form.basePrice} onChange={handleChange} style={styles.input} />\n//               </div>\n\n//               <div style={styles.formGroup}>\n//                 <label style={styles.label}>Difference</label>\n//                 <input type=\"number\" name=\"difference\" value={form.difference} onChange={handleChange} style={styles.input} />\n//               </div>\n\n//               <div style={styles.formGroup}>\n//                 <label style={styles.label}>Valid Till</label>\n//                 <input type=\"date\" name=\"validTill\" value={form.validTill} onChange={handleChange} style={styles.input} />\n//               </div>\n\n//               <div style={styles.formGroup}>\n//                 <label style={styles.label}>Image</label>\n//                 <input type=\"file\" accept=\"image/*\" onChange={handleChange} style={styles.fileInput} />\n//               </div>\n//             </div>\n\n//             <div style={styles.formGroup}>\n//               <label style={styles.label}>Description</label>\n//               <textarea name=\"description\" value={form.description} onChange={handleChange} style={styles.textarea}></textarea>\n//             </div>\n\n//             <div style={styles.formActions}>\n//               <button style={styles.btnPrimary} disabled={loading}>\n//                 {loading ? \"Saving...\" : \"Add Product\"}\n//               </button>\n//             </div>\n//           </form>\n//         </div>\n//       )}\n\n//       {/* CSV CONTROLS */}\n//       {/* <div style={styles.csvControls}>\n//         <div>\n//           <input type=\"file\" accept=\".csv\" ref={csvInputRef} onChange={handleCsvSelect} style={styles.fileInput} />\n//           <button style={styles.btnSmall} onClick={handleImportCsv}>\n//             Import CSV\n//           </button>\n//         </div>\n\n//         <div style={{ display: \"flex\", gap: 8 }}>\n//           <button style={styles.btnPrimary} onClick={handleExportCsv}>\n//             Export All CSV\n//           </button>\n\n//           <button style={styles.btnSmall} onClick={handleExportSelectedCsv}>\n//             Export Selected CSV\n//           </button>\n//         </div>\n//       </div> */}\n// <div className=\"csv-topbar\">\n//   <div className=\"csv-row\">\n//     <input\n//       type=\"file\"\n//       accept=\".csv\"\n//       ref={csvInputRef}\n//       onChange={handleCsvSelect}\n//       style={styles.fileInput}\n//     />\n\n//     <button style={styles.btnSmall} onClick={handleImportCsv}>\n//       Import\n//     </button>\n\n//     <button style={styles.btnPrimary} onClick={handleExportCsv}>\n//       Export All\n//     </button>\n\n//     <button style={styles.btnSmall} onClick={handleExportSelectedCsv}>\n//        Selected \n//     </button>\n//   </div>\n// </div>\n\n//       {/* TABLE */}\n//       <div style={styles.tableCard}>\n//         <div style={styles.tableHeader}>\n//           <h2 style={styles.tableTitle}> Items</h2>\n//           <span style={styles.totalCount}>Total: {filteredItems.length}</span>\n//         </div>\n\n//         <div style={styles.tableWrapper}>\n//           <table style={styles.table}>\n//             <thead>\n//               <tr>\n//                 <th style={styles.th}>\n//                   <input\n//                     type=\"checkbox\"\n//                     checked={selectedItems.length === filteredItems.length && filteredItems.length > 0}\n//                     onChange={() => {\n//                       if (selectedItems.length === filteredItems.length) setSelectedItems([]);\n//                       else setSelectedItems(filteredItems.map((x) => x._id));\n//                     }}\n//                   />\n//                 </th>\n//                 <th style={styles.th}>Sr</th>\n//                 <th style={styles.th}>Image</th>\n//                 <th style={styles.th}>Name</th>\n//                 <th style={styles.th}>Category</th>\n//                 <th style={styles.th}>Subcategory</th>\n//                 <th style={styles.th}>Base</th>\n//                 <th style={styles.th}>Diff</th>\n//                 <th style={styles.th}>Final</th>\n//                 <th style={styles.th}>Status</th>\n//                 <th style={styles.th}>Valid Till</th>\n//                 <th style={styles.th}>Actions</th>\n//               </tr>\n//             </thead>\n\n//             <tbody>\n//               {currentItems.map((item, i) => (\n//                 <tr key={item._id} style={styles.tr}>\n//                   <td style={styles.td}>\n//                     <input\n//                       type=\"checkbox\"\n//                       checked={selectedItems.includes(item._id)}\n//                       onChange={() =>\n//                         setSelectedItems((prev) => (prev.includes(item._id) ? prev.filter((x) => x !== item._id) : [...prev, item._id]))\n//                       }\n//                     />\n//                   </td>\n\n//                   <td style={styles.td}>{(currentPage - 1) * itemsPerPage + (i + 1)}</td>\n\n//                   <td style={styles.td}>{item.image ? <img src={item.image} style={styles.tableImg} alt=\"\" /> : \"No Img\"}</td>\n\n//                   <td style={styles.td}>{item.name}</td>\n//                   <td style={styles.td}>{item.category?.name || \"-\"}</td>\n//                   <td style={styles.td}>{item.subcategory?.name || \"-\"}</td>\n\n//                   <td style={styles.td}>‚Çπ{item.basePrice}</td>\n//                   <td style={styles.td}>{item.difference || 0}</td>\n//                   <td style={styles.td}>‚Çπ{Number(item.basePrice) + Number(item.difference || 0)}</td>\n\n//                   <td style={styles.td}>\n//                     <button\n//                       style={item.status === \"active\" ? styles.statusActive : styles.statusInactive}\n//                       onClick={() => handleStatusToggle(item)}\n//                     >\n//                       {item.status === \"active\" ? \"Active\" : \"Inactive\"}\n//                     </button>\n//                   </td>\n\n//                   <td style={styles.td}>{item.validTill ? new Date(item.validTill).toLocaleDateString() : \"-\"}</td>\n\n//                   <td style={styles.td}>\n//                     <div style={{ position: \"relative\" }}>\n//                       <button\n//                         style={styles.menuButton}\n//                         onClick={() => setActiveMenu(activeMenu === item._id ? null : item._id)}\n//                       >\n//                         ‚ãÆ\n//                       </button>\n\n//                       {activeMenu === item._id && (\n//                         <div style={styles.dropdown}>\n//                           <button style={styles.dropdownItem} onClick={() => handleEdit(item)}>\n//                             ‚úè Edit\n//                           </button>\n//                           <button style={styles.dropdownItem} onClick={() => handleCopyToEdit(item)}>\n//                             üìÑ Copy\n//                           </button>\n//                           <button style={styles.dropdownItemDelete} onClick={() => handleDelete(item._id)}>\n//                             üóë Delete\n//                           </button>\n//                         </div>\n//                       )}\n//                     </div>\n//                   </td>\n//                 </tr>\n//               ))}\n//             </tbody>\n//           </table>\n//         </div>\n\n//         {/* PAGINATION */}\n//         <div style={styles.pagination}>\n//           <button style={styles.paginationBtn} disabled={currentPage === 1} onClick={() => setCurrentPage((p) => p - 1)}>\n//             Previous\n//           </button>\n\n//           {Array.from({ length: totalPages }, (_, i) => (\n//             <button\n//               key={i}\n//               style={i + 1 === currentPage ? styles.paginationBtnActive : styles.paginationBtn}\n//               onClick={() => setCurrentPage(i + 1)}\n//             >\n//               {i + 1}\n//             </button>\n//           ))}\n\n//           <button style={styles.paginationBtn} disabled={currentPage === totalPages} onClick={() => setCurrentPage((p) => p + 1)}>\n//             Next\n//           </button>\n//         </div>\n//       </div>\n\n//       {/* MODAL FOR EDIT/COPY */}\n//       {showModal && (\n//         <div style={styles.modalOverlay} onClick={() => setShowModal(false)}>\n//           <div style={styles.modal} onClick={(e) => e.stopPropagation()}>\n//             <h2 style={styles.modalTitle}>{isCopyMode ? \" Copy Product\" : \" Edit Product\"}</h2>\n\n//             <form onSubmit={handleSubmit}>\n//               <div style={styles.formGrid}>\n//                 <div style={styles.formGroup}>\n//                   <label style={styles.label}>Product Name *</label>\n//                   <input required name=\"name\" value={form.name} onChange={handleChange} style={styles.input} />\n//                 </div>\n\n//                 <div style={styles.formGroup}>\n//                   <label style={styles.label}>Category *</label>\n//                   <select\n//                     required\n//                     name=\"category\"\n//                     value={form.category}\n//                     onChange={(e) => {\n//                       handleChange(e);\n//                       setForm((p) => ({ ...p, subcategory: \"\" }));\n//                     }}\n//                     style={styles.select}\n//                   >\n//                     <option value=\"\">Select Category</option>\n//                     {categories.map((c) => (\n//                       <option value={c._id} key={c._id}>\n//                         {c.name}\n//                       </option>\n//                     ))}\n//                   </select>\n//                 </div>\n\n//                 <div style={styles.formGroup}>\n//                   <label style={styles.label}>Subcategory</label>\n//                   <select name=\"subcategory\" value={form.subcategory} onChange={handleChange} disabled={!subcategories.length} style={styles.select}>\n//                     <option value=\"\">Select Subcategory</option>\n//                     {subcategories.map((s) => (\n//                       <option value={s._id} key={s._id}>\n//                         {s.name}\n//                       </option>\n//                     ))}\n//                   </select>\n//                 </div>\n\n//                 <div style={styles.formGroup}>\n//                   <label style={styles.label}>Base Price *</label>\n//                   <input type=\"number\" required name=\"basePrice\" value={form.basePrice} onChange={handleChange} style={styles.input} />\n//                 </div>\n\n//                 <div style={styles.formGroup}>\n//                   <label style={styles.label}>Difference</label>\n//                   <input type=\"number\" name=\"difference\" value={form.difference} onChange={handleChange} style={styles.input} />\n//                 </div>\n\n//                 <div style={styles.formGroup}>\n//                   <label style={styles.label}>Valid Till</label>\n//                   <input type=\"date\" name=\"validTill\" value={form.validTill} onChange={handleChange} style={styles.input} />\n//                 </div>\n\n//                 <div style={styles.formGroup}>\n//                   <label style={styles.label}>Image</label>\n//                   <input type=\"file\" accept=\"image/*\" onChange={handleChange} style={styles.fileInput} />\n//                 </div>\n//               </div>\n\n//               <div style={styles.formGroup}>\n//                 <label style={styles.label}>Description</label>\n//                 <textarea name=\"description\" value={form.description} onChange={handleChange} style={styles.textarea}></textarea>\n//               </div>\n\n//               <div style={styles.formActions}>\n//                 <button style={styles.btnPrimary} disabled={loading}>\n//                   {loading ? \"Saving...\" : isCopyMode ? \"Save Copy\" : \"Update\"}\n//                 </button>\n\n//                 <button\n//                   type=\"button\"\n//                   style={styles.btnCancel}\n//                   onClick={() => {\n//                     setShowModal(false);\n//                     setEditId(null);\n//                     setIsCopyMode(false);\n//                     setForm({\n//                       name: \"\",\n//                       category: \"\",\n//                       subcategory: \"\",\n//                       description: \"\",\n//                       basePrice: \"\",\n//                       difference: \"\",\n//                       validTill: \"\",\n//                       file: null,\n//                     });\n//                   }}\n//                 >\n//                   Cancel\n//                 </button>\n//               </div>\n//             </form>\n//           </div>\n//         </div>\n//       )}\n//     </div>\n//   );\n// }\n\n// const styles = {\n//   container: {\n\n//   },\n//   header: {\n\n//   },\n//   title: {\n//     fontSize: \"21px\",\n//     fontWeight: \"700\",\n//     color: \"#0d3b66\",\n//     marginBottom: \"6px\",\n//   },\n//   subtitle: {\n//    fontSize: \"16px\",\n//   },\n//   searchBar: {\n//     maxWidth: \"320px\",\n//     margin: \"0 auto 25px auto\",\n//   },\n//   searchInput: {\n//     width: \"100%\",\n//     padding: \"12px 15px\",\n//     borderRadius: \"12px\",\n//     border: \"1px solid #ced4da\",\n//     background: \"#f9fbfc\",\n//     fontSize: \"15px\",\n//     outline: \"none\",\n//     boxShadow: \"0 2px 6px rgba(0, 0, 0, 0.06)\",\n//   },\n//   addButtonWrapper: {\n//     textAlign: \"left\",\n//     marginBottom: \"25px\",\n//   },\n//   addButton: {\n//     background: \"#007bff\",\n//     color: \"#fff\",\n//     border: \"none\",\n//     borderRadius: \"12px\",\n//     padding: \"12px 24px\",\n//     fontSize: \"16px\",\n//     fontWeight: \"600\",\n//     cursor: \"pointer\",\n//     transition: \"0.25s ease\",\n//   },\n//   bulkBar: {\n//     background: \"#e9f2ff\",\n//     border: \"1px solid #c4d9ff\",\n//     borderRadius: \"14px\",\n//     padding: \"15px 18px\",\n//     marginBottom: \"25px\",\n//     display: \"flex\",\n//     justifyContent: \"space-between\",\n//     alignItems: \"center\",\n//     flexWrap: \"wrap\",\n//     gap: \"14px\",\n//     boxShadow: \"0 3px 10px rgba(0, 80, 160, 0.1)\",\n//   },\n//   bulkText: {\n//     fontSize: \"15px\",\n//     fontWeight: \"600\",\n//     color: \"#0d3b66\",\n//   },\n//   bulkPanel: {\n//     width: \"100%\",\n//     background: \"#f7faff\",\n//     border: \"1px solid #cfe2ff\",\n//     padding: \"20px\",\n//     borderRadius: \"14px\",\n//     marginTop: \"10px\",\n//     boxShadow: \"0 4px 14px rgba(0, 60, 120, 0.08)\",\n//   },\n//   bulkPanelTitle: {\n//     textAlign: \"center\",\n//     fontSize: \"18px\",\n//     fontWeight: \"700\",\n//     marginBottom: \"15px\",\n//   },\n//   bulkItemBox: {\n//     background: \"#ffffff\",\n//     border: \"1px solid #dbe5f5\",\n//     padding: \"18px\",\n//     borderRadius: \"12px\",\n//     marginBottom: \"16px\",\n//     boxShadow: \"0 2px 10px rgba(0, 0, 50, 0.05)\",\n//   },\n//   bulkItemTitle: {\n//     fontSize: \"16px\",\n//     fontWeight: \"600\",\n//     marginBottom: \"12px\",\n//     color: \"#0d3b66\",\n//     borderLeft: \"4px solid #007bff\",\n//     paddingLeft: \"10px\",\n//   },\n//   formCard: {\n//     borderRadius: \"16px\",\n//     padding: \"25px\",\n//     marginBottom: \"28px\",\n//     background: \"#ffffff\",\n//     boxShadow: \"0 4px 16px rgba(0, 0, 0, 0.08)\",\n//     border: \"1px solid #eef2f7\",\n//   },\n//   formTitle: {\n//     fontSize: \"21px\",\n//     fontWeight: \"700\",\n//     color: \"#0d3b66\",\n//     marginBottom: \"15px\",\n//   },\n//   formGrid: {\n//     display: \"grid\",\n//     gridTemplateColumns: \"repeat(auto-fit, minmax(230px, 1fr))\",\n//     gap: \"18px\",\n//   },\n//   formGroup: {\n//     display: \"flex\",\n//     flexDirection: \"column\",\n//     gap: \"6px\",\n//   },\n//   label: {\n//     fontWeight: \"600\",\n//     fontSize: \"14px\",\n//     color: \"#233142\",\n//   },\n//   input: {\n//     padding: \"10px\",\n//     borderRadius: \"10px\",\n//     border: \"1px solid #cfd6e0\",\n//     background: \"#f8fafc\",\n//     transition: \"0.2s ease\",\n//     fontSize: \"14px\",\n//   },\n//   select: {\n//     padding: \"10px\",\n//     borderRadius: \"10px\",\n//     border: \"1px solid #cfd6e0\",\n//     background: \"#f8fafc\",\n//     transition: \"0.2s ease\",\n//     fontSize: \"14px\",\n//   },\n//   textarea: {\n//     padding: \"10px\",\n//     borderRadius: \"10px\",\n//     border: \"1px solid #cfd6e0\",\n//     background: \"#f8fafc\",\n//     transition: \"0.2s ease\",\n//     resize: \"none\",\n//     minHeight: \"80px\",\n//     fontSize: \"14px\",\n//   },\n//   fileInput: {\n//     padding: \"8px\",\n//     fontSize: \"13px\",\n//   },\n//   categoryRow: {\n//     display: \"flex\",\n//     gap: \"10px\",\n//     alignItems: \"center\",\n//   },\n//   addCategoryBox: {\n//     gridColumn: \"1 / -1\",\n//     background: \"#f1f7ff\",\n//     border: \"1px solid #cfe1ff\",\n//     padding: \"16px\",\n//     borderRadius: \"12px\",\n//   },\n//   preview: {\n//     width: \"110px\",\n//     height: \"110px\",\n//     borderRadius: \"12px\",\n//     marginTop: \"10px\",\n//     objectFit: \"cover\",\n//     border: \"1px solid #b7c9e2\",\n//   },\n//   formActions: {\n//     marginTop: \"15px\",\n//     display: \"flex\",\n//     gap: \"12px\",\n//     flexWrap: \"wrap\",\n//   },\n//   btnPrimary: {\n//     background: \"#007bff\",\n//     color: \"#fff\",\n//     border: \"none\",\n//     borderRadius: \"10px\",\n//     padding: \"9px 16px\",\n\n//     cursor: \"pointer\",\n//     transition: \"0.25s ease\",\n//   },\n//   btnSmall: {\n//     background: \"#43a047\",\n//     color: \"#fff\",\n//     border: \"none\",\n//     borderRadius: \"10px\",\n//     padding: \"9px 16px\",\n//     fontWeight: \"600\",\n//     cursor: \"pointer\",\n//     transition: \"0.25s ease\",\n//   },\n//   btnDelete: {\n//     background: \"#e63946\",\n//     color: \"#fff\",\n//     border: \"none\",\n//     borderRadius: \"10px\",\n//     padding: \"9px 16px\",\n//     fontWeight: \"600\",\n//     cursor: \"pointer\",\n//     transition: \"0.25s ease\",\n//   },\n//   btnCancel: {\n//     background: \"#adb5bd\",\n//     color: \"#fff\",\n//     border: \"none\",\n//     borderRadius: \"10px\",\n//     padding: \"9px 16px\",\n//     fontWeight: \"600\",\n//     cursor: \"pointer\",\n//     transition: \"0.25s ease\",\n//   },\n//   csvControls: {\n//     borderRadius: \"12px\",\n//     padding: \"16px\",\n//     background: \"#f7faff\",\n//     border: \"1px solid #d8e6ff\",\n//     display: \"flex\",\n//     alignItems: \"center\",\n//     justifyContent: \"space-between\",\n//     marginBottom: \"28px\",\n//     flexWrap: \"wrap\",\n//     gap: \"12px\",\n//   },\n//   tableCard: {\n\n//   },\n//   tableHeader: {\n//     display: \"flex\",\n//     justifyContent: \"space-between\",\n//     marginBottom: \"15px\",\n//   },\n//   tableTitle: {\n//     fontSize: \"21px\",\n//     fontWeight: \"700\",\n//     color: \"#0d3b66\",\n//   },\n//   totalCount: {\n//     fontSize: \"15px\",\n//     color: \"#6c757d\",\n//     fontWeight: \"600\",\n//   },\n//   tableWrapper: {\n//     overflowX: \"auto\",\n//   },\n//   table: {\n//     width: \"100%\",\n//     borderCollapse: \"collapse\",\n//     fontSize: \"14px\",\n//   },\n//   th: {\n//     background: \"#e9f2ff\",\n//     padding: \"12px\",\n//     fontWeight: \"700\",\n//     color: \"#0d3b66\",\n//     textAlign: \"left\",\n//     whiteSpace: \"nowrap\",\n//   },\n//   tr: {\n//     borderBottom: \"1px solid #edf2f7\",\n//   },\n//   td: {\n//     padding: \"12px 10px\",\n//     whiteSpace: \"nowrap\",\n//   },\n//   tableImg: {\n//     width: \"55px\",\n//     height: \"55px\",\n//     borderRadius: \"8px\",\n//     objectFit: \"cover\",\n//     border: \"1px solid #cfd9e5\",\n//   },\n//   statusActive: {\n//     background: \"#93d8ba\",\n//     padding: \"7px 12px\",\n//     borderRadius: \"8px\",\n//     color: \"black\",\n//     fontWeight: \"600\",\n//     border: \"none\",\n//     cursor: \"pointer\",\n//   },\n//   statusInactive: {\n//     background: \"#d9b1b1\",\n//     padding: \"7px 12px\",\n//     borderRadius: \"8px\",\n//     color: \"black\",\n//     fontWeight: \"600\",\n//     border: \"none\",\n//     cursor: \"pointer\",\n//   },\n//   menuButton: {\n//     background: \"#f0f0f0\",\n//     border: \"none\",\n//     borderRadius: \"6px\",\n//     padding: \"6px 12px\",\n//     fontSize: \"20px\",\n//     fontWeight: \"bold\",\n//     cursor: \"pointer\",\n//     transition: \"0.2s ease\",\n//   },\n//   dropdown: {\n//     position: \"absolute\",\n//     right: \"0\",\n//     top: \"35px\",\n//     background: \"#fff\",\n//     border: \"1px solid #ddd\",\n//     borderRadius: \"8px\",\n//     boxShadow: \"0 4px 12px rgba(0,0,0,0.15)\",\n//     zIndex: \"100\",\n//     minWidth: \"140px\",\n//   },\n//   dropdownItem: {\n//     display: \"block\",\n//     width: \"100%\",\n//     padding: \"10px 15px\",\n//     background: \"transparent\",\n//     border: \"none\",\n//     textAlign: \"left\",\n//     cursor: \"pointer\",\n//     fontSize: \"14px\",\n//     fontWeight: \"500\",\n//     transition: \"0.2s ease\",\n//     borderBottom: \"1px solid #f0f0f0\",\n//   },\n//   dropdownItemDelete: {\n//     display: \"block\",\n//     width: \"100%\",\n//     padding: \"10px 15px\",\n//     background: \"transparent\",\n//     border: \"none\",\n//     textAlign: \"left\",\n//     cursor: \"pointer\",\n//     fontSize: \"14px\",\n//     fontWeight: \"500\",\n//     color: \"#e63946\",\n//     transition: \"0.2s ease\",\n//   },\n//   pagination: {\n//     marginTop: \"18px\",\n//     display: \"flex\",\n//     justifyContent: \"center\",\n//     gap: \"10px\",\n//     flexWrap: \"wrap\",\n//   },\n//   paginationBtn: {\n//     padding: \"9px 13px\",\n//     borderRadius: \"8px\",\n//     background: \"#fff\",\n//     border: \"1px solid #ddd\",\n//     cursor: \"pointer\",\n//     fontSize: \"14px\",\n//   },\n//   paginationBtnActive: {\n//     padding: \"9px 13px\",\n//     borderRadius: \"8px\",\n//     background: \"#007bff\",\n//     color: \"white\",\n//     border: \"1px solid #0062cc\",\n//     cursor: \"pointer\",\n//     fontSize: \"14px\",\n//   },\n//   modalOverlay: {\n//     position: \"fixed\",\n//     top: 0,\n//     left: 0,\n//     right: 0,\n//     bottom: 0,\n//     background: \"rgba(0, 0, 0, 0.5)\",\n//     display: \"flex\",\n//     justifyContent: \"center\",\n//     alignItems: \"center\",\n//     zIndex: \"1000\",\n//     padding: \"20px\",\n//   },\n//   modal: {\n//     background: \"#fff\",\n//     borderRadius: \"16px\",\n//     padding: \"30px\",\n//     maxWidth: \"700px\",\n//     width: \"100%\",\n//     maxHeight: \"90vh\",\n//     overflowY: \"auto\",\n//     boxShadow: \"0 10px 40px rgba(0, 0, 0, 0.3)\",\n//   },\n//   modalTitle: {\n//     fontSize: \"22px\",\n//     fontWeight: \"700\",\n//     color: \"#0d3b66\",\n//     marginBottom: \"20px\",\n//     textAlign: \"center\",\n//   },\n\n// }\nimport React, { useEffect, useState, useRef } from \"react\";\nimport axios from \"axios\";\nimport \"./PriceList.css\";\n\n// API endpoints ‚Äî keep as-is or replace with your env vars\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API_URL = process.env.REACT_APP_API_URL_PRICES || \"https://grocerrybackend.vercel.app/api/prices\";\nconst CATEGORY_URL = process.env.REACT_APP_API_URL_CATEGORIES || \"https://grocerrybackend.vercel.app/api/categories\";\nexport default function PriceList() {\n  _s();\n  // data\n  const [items, setItems] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [subcategories, setSubcategories] = useState([]);\n\n  // ui\n  const [loading, setLoading] = useState(false);\n  const [search, setSearch] = useState(\"\");\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\n\n  // form / modal\n  const [form, setForm] = useState({\n    name: \"\",\n    category: \"\",\n    subcategory: \"\",\n    description: \"\",\n    basePrice: \"\",\n    difference: \"\",\n    // used only on create ‚Äî diff updates should use diff endpoint\n    validTill: \"\",\n    file: null\n  });\n  const [editId, setEditId] = useState(null); // if set => edit mode\n  const [isCopyMode, setIsCopyMode] = useState(false);\n  const [showForm, setShowForm] = useState(false); // inline add form\n  const [showModal, setShowModal] = useState(false); // edit/copy modal\n  const [activeMenu, setActiveMenu] = useState(null);\n\n  // bulk/select\n  const [selectedItems, setSelectedItems] = useState([]);\n  const [bulkMode, setBulkMode] = useState(false);\n\n  // CSV\n  const [csvFile, setCsvFile] = useState(null);\n  const csvInputRef = useRef();\n\n  // pagination\n  const [currentPage, setCurrentPage] = useState(1);\n  const itemsPerPage = 30;\n\n  // filters\n  const [filterCategory, setFilterCategory] = useState(\"\");\n  const [filterSubcategory, setFilterSubcategory] = useState(\"\");\n  const [filterSubs, setFilterSubs] = useState([]);\n  useEffect(() => {\n    // load categories first\n    fetchCategories();\n\n    // resize listener\n    const onResize = () => setIsMobile(window.innerWidth < 768);\n    window.addEventListener(\"resize\", onResize);\n    return () => window.removeEventListener(\"resize\", onResize);\n  }, []);\n  useEffect(() => {\n    // once categories loaded, fetch items\n    if (categories.length > 0) fetchItems();\n  }, [categories]);\n  useEffect(() => {\n    if (!filterCategory) {\n      setFilterSubs([]);\n      setFilterSubcategory(\"\");\n      return;\n    }\n    const cat = categories.find(c => c._id === filterCategory);\n    setFilterSubs((cat === null || cat === void 0 ? void 0 : cat.subcategories) || []);\n    setFilterSubcategory(\"\");\n  }, [filterCategory, categories]);\n\n  // keep form.subcategories updated when form.category changes\n  useEffect(() => {\n    if (!form.category) {\n      setSubcategories([]);\n      setForm(prev => ({\n        ...prev,\n        subcategory: \"\"\n      }));\n      return;\n    }\n    const cat = categories.find(c => c._id === form.category);\n    const subs = (cat === null || cat === void 0 ? void 0 : cat.subcategories) || [];\n    setSubcategories(subs);\n    const exists = subs.some(s => s._id === form.subcategory);\n    if (!exists) setForm(prev => ({\n      ...prev,\n      subcategory: \"\"\n    }));\n  }, [form.category, categories]);\n\n  /* ----------------------- API Fetchers ----------------------- */\n  const fetchCategories = async () => {\n    try {\n      const res = await axios.get(CATEGORY_URL);\n      if (res.data && res.data.success) setCategories(res.data.categories || []);\n    } catch (err) {\n      console.error(\"fetchCategories error\", err);\n      alert(\"Failed to load categories\");\n    }\n  };\n  const fetchItems = async () => {\n    setLoading(true);\n    try {\n      const res = await axios.get(API_URL);\n      if (!(res.data && res.data.success)) return setItems([]);\n      const raw = res.data.data || [];\n\n      // enrich items with category/subcategory objects when possible\n      const enriched = raw.map(item => {\n        var _cat$subcategories, _ref, _item$lastFinalPrice;\n        const cat = categories.find(c => {\n          var _item$category;\n          return c._id === (((_item$category = item.category) === null || _item$category === void 0 ? void 0 : _item$category._id) || item.category);\n        });\n        const sub = cat === null || cat === void 0 ? void 0 : (_cat$subcategories = cat.subcategories) === null || _cat$subcategories === void 0 ? void 0 : _cat$subcategories.find(s => {\n          var _item$subcategory;\n          return s._id === (((_item$subcategory = item.subcategory) === null || _item$subcategory === void 0 ? void 0 : _item$subcategory._id) || item.subcategory);\n        });\n\n        // compute a friendly final price for UI\n        const finalVal = typeof item.currentFinalPrice === \"number\" && !isNaN(item.currentFinalPrice) ? item.currentFinalPrice : (_ref = (_item$lastFinalPrice = item.lastFinalPrice) !== null && _item$lastFinalPrice !== void 0 ? _item$lastFinalPrice : item.basePrice) !== null && _ref !== void 0 ? _ref : 0;\n        return {\n          ...item,\n          category: cat ? {\n            _id: cat._id,\n            name: cat.name\n          } : item.category,\n          subcategory: sub ? {\n            _id: sub._id,\n            name: sub.name\n          } : item.subcategory,\n          _uiFinalPrice: finalVal\n        };\n      });\n      setItems(enriched);\n    } catch (err) {\n      console.error(\"fetchItems error\", err);\n      alert(\"Failed to load items\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /* ----------------------- FORM / CRUD ----------------------- */\n  const handleChange = e => {\n    const {\n      name,\n      value,\n      files\n    } = e.target;\n    if (files && files.length) return setForm(p => ({\n      ...p,\n      file: files[0]\n    }));\n    setForm(p => ({\n      ...p,\n      [name]: value\n    }));\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    try {\n      if (!form.name || !form.category || !form.basePrice) {\n        alert(\"Name, category and base price are required\");\n        setLoading(false);\n        return;\n      }\n      const fd = new FormData();\n      Object.keys(form).forEach(k => {\n        const val = form[k];\n        if (val !== undefined && val !== null && val !== \"\") fd.append(k, val);\n      });\n      let res;\n      if (isCopyMode) {\n        res = await axios.post(API_URL, fd);\n        alert(\"Copied as new item\");\n      } else if (editId) {\n        res = await axios.put(`${API_URL}/${editId}`, fd);\n        alert(\"Updated\");\n      } else {\n        // create\n        res = await axios.post(API_URL, fd);\n        alert(\"Added\");\n      }\n\n      // refresh\n      await fetchItems();\n      await fetchCategories();\n\n      // reset form\n      setForm({\n        name: \"\",\n        category: \"\",\n        subcategory: \"\",\n        description: \"\",\n        basePrice: \"\",\n        difference: \"\",\n        validTill: \"\",\n        file: null\n      });\n      setEditId(null);\n      setIsCopyMode(false);\n      setShowModal(false);\n      setShowForm(false);\n    } catch (err) {\n      console.error(\"save error\", err);\n      alert(\"Save failed\");\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleEdit = item => {\n    var _item$category2, _item$category2$_id, _item$subcategory2, _item$subcategory2$_i, _item$basePrice, _item$todayDiff;\n    setForm({\n      name: item.name || \"\",\n      category: ((_item$category2 = item.category) === null || _item$category2 === void 0 ? void 0 : (_item$category2$_id = _item$category2._id) === null || _item$category2$_id === void 0 ? void 0 : _item$category2$_id.toString()) || item.category || \"\",\n      subcategory: ((_item$subcategory2 = item.subcategory) === null || _item$subcategory2 === void 0 ? void 0 : (_item$subcategory2$_i = _item$subcategory2._id) === null || _item$subcategory2$_i === void 0 ? void 0 : _item$subcategory2$_i.toString()) || item.subcategory || \"\",\n      description: item.description || \"\",\n      basePrice: (_item$basePrice = item.basePrice) !== null && _item$basePrice !== void 0 ? _item$basePrice : \"\",\n      difference: (_item$todayDiff = item.todayDiff) !== null && _item$todayDiff !== void 0 ? _item$todayDiff : \"\",\n      validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n      file: null\n    });\n    const cat = categories.find(c => {\n      var _item$category3;\n      return c._id === (((_item$category3 = item.category) === null || _item$category3 === void 0 ? void 0 : _item$category3._id) || item.category);\n    });\n    setSubcategories((cat === null || cat === void 0 ? void 0 : cat.subcategories) || []);\n    setEditId(item._id);\n    setIsCopyMode(false);\n    setShowModal(true);\n    setActiveMenu(null);\n  };\n  const handleCopyToEdit = item => {\n    var _item$category4, _item$category4$_id, _item$subcategory3, _item$subcategory3$_i, _item$basePrice2, _item$todayDiff2;\n    setForm({\n      name: item.name || \"\",\n      category: ((_item$category4 = item.category) === null || _item$category4 === void 0 ? void 0 : (_item$category4$_id = _item$category4._id) === null || _item$category4$_id === void 0 ? void 0 : _item$category4$_id.toString()) || item.category || \"\",\n      subcategory: ((_item$subcategory3 = item.subcategory) === null || _item$subcategory3 === void 0 ? void 0 : (_item$subcategory3$_i = _item$subcategory3._id) === null || _item$subcategory3$_i === void 0 ? void 0 : _item$subcategory3$_i.toString()) || item.subcategory || \"\",\n      description: item.description || \"\",\n      basePrice: (_item$basePrice2 = item.basePrice) !== null && _item$basePrice2 !== void 0 ? _item$basePrice2 : \"\",\n      difference: (_item$todayDiff2 = item.todayDiff) !== null && _item$todayDiff2 !== void 0 ? _item$todayDiff2 : \"\",\n      validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n      file: null\n    });\n    const cat = categories.find(c => {\n      var _item$category5;\n      return c._id === (((_item$category5 = item.category) === null || _item$category5 === void 0 ? void 0 : _item$category5._id) || item.category);\n    });\n    setSubcategories((cat === null || cat === void 0 ? void 0 : cat.subcategories) || []);\n    setEditId(null);\n    setIsCopyMode(true);\n    setShowModal(true);\n    setActiveMenu(null);\n  };\n  const handleDelete = async id => {\n    if (!window.confirm(\"Delete item?\")) return;\n    try {\n      await axios.delete(`${API_URL}/${id}`);\n      setItems(prev => prev.filter(x => x._id !== id));\n      setSelectedItems(prev => prev.filter(x => x !== id));\n      setActiveMenu(null);\n    } catch (err) {\n      console.error(\"delete error\", err);\n      alert(\"Delete failed\");\n    }\n  };\n  const handleStatusToggle = async item => {\n    try {\n      const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\n      await axios.put(`${API_URL}/status/${item._id}`, {\n        status: newStatus\n      });\n      setItems(prev => prev.map(x => x._id === item._id ? {\n        ...x,\n        status: newStatus\n      } : x));\n    } catch (err) {\n      console.error(\"status toggle error\", err);\n      alert(\"Status update failed\");\n    }\n  };\n\n  /* ----------------------- DIFF update (MAIN) ----------------------- */\n  // This calls the backend endpoint: PUT /diff/:id with { diff }\n  const handleDiffUpdate = async (id, diff) => {\n    try {\n      await axios.put(`${API_URL}/diff/${id}`, {\n        diff: Number(diff || 0)\n      });\n      // update local UI by refetching the item(s)\n      await fetchItems();\n      alert(\"Difference applied\");\n    } catch (err) {\n      console.error(\"Diff update error\", err);\n      alert(\"Failed to update difference\");\n    }\n  };\n\n  /* ----------------------- BULK ----------------------- */\n  const handleBulkDelete = async () => {\n    if (!selectedItems.length) return alert(\"No items selected\");\n    if (!window.confirm(\"Delete selected items?\")) return;\n    try {\n      await Promise.all(selectedItems.map(id => axios.delete(`${API_URL}/${id}`)));\n      setSelectedItems([]);\n      fetchItems();\n      setBulkMode(false);\n    } catch (err) {\n      console.error(\"bulk delete error\", err);\n      alert(\"Bulk delete failed\");\n    }\n  };\n  const updateLocalItemField = (id, key, value) => {\n    setItems(prev => prev.map(x => x._id === id ? {\n      ...x,\n      [key]: value\n    } : x));\n  };\n  const handleBulkSave = async () => {\n    if (!selectedItems.length) return alert(\"No items selected for bulk save\");\n    const updates = items.filter(x => selectedItems.includes(x._id)).map(x => ({\n      id: x._id,\n      name: x.name,\n      basePrice: x.basePrice,\n      difference: x.difference,\n      validTill: x.validTill\n    }));\n    try {\n      await axios.post(`${API_URL}/bulk-update`, {\n        products: updates\n      });\n      setBulkMode(false);\n      setSelectedItems([]);\n      fetchItems();\n    } catch (err) {\n      console.error(\"bulk save error\", err);\n      alert(\"Bulk save failed\");\n    }\n  };\n\n  /* ----------------------- CSV ----------------------- */\n  const handleCsvSelect = e => {\n    var _e$target$files;\n    return setCsvFile(((_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0]) || null);\n  };\n  const handleImportCsv = async () => {\n    if (!csvFile) return alert(\"Select CSV file\");\n    try {\n      const fd = new FormData();\n      fd.append(\"file\", csvFile);\n      const res = await axios.post(`${API_URL}/import`, fd);\n      if (res.data && res.data.success) {\n        alert(`Imported ${res.data.inserted || 0} items`);\n        setCsvFile(null);\n        if (csvInputRef.current) csvInputRef.current.value = null;\n        fetchItems();\n      } else alert(\"CSV import failed\");\n    } catch (err) {\n      console.error(\"csv import error\", err);\n      alert(\"CSV import failed\");\n    }\n  };\n  const handleExportCsv = () => {\n    if (!items.length) return alert(\"No items to export\");\n    const header = [\"id\", \"name\", \"categoryName\", \"subcategoryName\", \"basePrice\", \"difference\", \"finalPrice\", \"status\", \"validTill\", \"description\", \"imageUrl\"];\n    const rows = items.map(p => {\n      var _p$category, _p$subcategory, _p$basePrice, _ref2, _p$todayDiff, _ref3, _ref4, _ref5, _p$_uiFinalPrice;\n      return [p._id, p.name || \"\", ((_p$category = p.category) === null || _p$category === void 0 ? void 0 : _p$category.name) || \"\", ((_p$subcategory = p.subcategory) === null || _p$subcategory === void 0 ? void 0 : _p$subcategory.name) || \"\", (_p$basePrice = p.basePrice) !== null && _p$basePrice !== void 0 ? _p$basePrice : \"\", (_ref2 = (_p$todayDiff = p.todayDiff) !== null && _p$todayDiff !== void 0 ? _p$todayDiff : p.difference) !== null && _ref2 !== void 0 ? _ref2 : 0, (_ref3 = (_ref4 = (_ref5 = (_p$_uiFinalPrice = p._uiFinalPrice) !== null && _p$_uiFinalPrice !== void 0 ? _p$_uiFinalPrice : p.currentFinalPrice) !== null && _ref5 !== void 0 ? _ref5 : p.lastFinalPrice) !== null && _ref4 !== void 0 ? _ref4 : p.basePrice) !== null && _ref3 !== void 0 ? _ref3 : \"\", p.status || \"\", p.validTill ? new Date(p.validTill).toISOString().split('T')[0] : \"\", p.description || \"\", p.image || \"\"];\n    });\n    const csvArray = [header, ...rows];\n    const csvContent = \"data:text/csv;charset=utf-8,\" + csvArray.map(r => r.map(c => `\"${String(c).replace(/\"/g, '\"\"')}\"`).join(',')).join('\\n');\n    const encodedUri = encodeURI(csvContent);\n    const link = document.createElement('a');\n    link.href = encodedUri;\n    link.download = `all_prices_${Date.now()}.csv`;\n    link.click();\n  };\n  const handleExportSelectedCsv = () => {\n    if (!selectedItems.length) return alert(\"Select items to export\");\n    const selected = items.filter(x => selectedItems.includes(x._id));\n    const header = [\"id\", \"name\", \"categoryName\", \"subcategoryName\", \"basePrice\", \"difference\", \"finalPrice\", \"status\", \"validTill\", \"description\", \"imageUrl\"];\n    const rows = selected.map(p => {\n      var _p$category2, _p$subcategory2, _p$basePrice2, _ref6, _p$todayDiff2, _ref7, _ref8, _ref9, _p$_uiFinalPrice2;\n      return [p._id, p.name || \"\", ((_p$category2 = p.category) === null || _p$category2 === void 0 ? void 0 : _p$category2.name) || \"\", ((_p$subcategory2 = p.subcategory) === null || _p$subcategory2 === void 0 ? void 0 : _p$subcategory2.name) || \"\", (_p$basePrice2 = p.basePrice) !== null && _p$basePrice2 !== void 0 ? _p$basePrice2 : \"\", (_ref6 = (_p$todayDiff2 = p.todayDiff) !== null && _p$todayDiff2 !== void 0 ? _p$todayDiff2 : p.difference) !== null && _ref6 !== void 0 ? _ref6 : 0, (_ref7 = (_ref8 = (_ref9 = (_p$_uiFinalPrice2 = p._uiFinalPrice) !== null && _p$_uiFinalPrice2 !== void 0 ? _p$_uiFinalPrice2 : p.currentFinalPrice) !== null && _ref9 !== void 0 ? _ref9 : p.lastFinalPrice) !== null && _ref8 !== void 0 ? _ref8 : p.basePrice) !== null && _ref7 !== void 0 ? _ref7 : \"\", p.status || \"\", p.validTill ? new Date(p.validTill).toISOString().split('T')[0] : \"\", p.description || \"\", p.image || \"\"];\n    });\n    const csvArray = [header, ...rows];\n    const csvContent = \"data:text/csv;charset=utf-8,\" + csvArray.map(r => r.map(c => `\"${String(c).replace(/\"/g, '\"\"')}\"`).join(',')).join('\\n');\n    const encodedUri = encodeURI(csvContent);\n    const link = document.createElement('a');\n    link.href = encodedUri;\n    link.download = `selected_prices_${Date.now()}.csv`;\n    link.click();\n  };\n\n  /* ----------------------- Filtering / Pagination ----------------------- */\n  const filteredItems = items.filter(item => {\n    var _item$category6, _item$subcategory4, _item$category7, _item$subcategory5;\n    const t = search.trim().toLowerCase();\n    const textMatch = !t || (item.name || \"\").toLowerCase().includes(t) || (((_item$category6 = item.category) === null || _item$category6 === void 0 ? void 0 : _item$category6.name) || \"\").toLowerCase().includes(t) || (((_item$subcategory4 = item.subcategory) === null || _item$subcategory4 === void 0 ? void 0 : _item$subcategory4.name) || \"\").toLowerCase().includes(t);\n    const catMatch = !filterCategory || ((_item$category7 = item.category) === null || _item$category7 === void 0 ? void 0 : _item$category7._id) === filterCategory;\n    const subMatch = !filterSubcategory || ((_item$subcategory5 = item.subcategory) === null || _item$subcategory5 === void 0 ? void 0 : _item$subcategory5._id) === filterSubcategory;\n    return textMatch && catMatch && subMatch;\n  });\n  const indexOfLast = currentPage * itemsPerPage;\n  const currentItems = filteredItems.slice(indexOfLast - itemsPerPage, indexOfLast);\n  const totalPages = Math.max(1, Math.ceil(filteredItems.length / itemsPerPage));\n\n  /* ----------------------- Render ----------------------- */\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"price-list-root\",\n    style: {\n      padding: 14\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header-row\",\n      style: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        marginBottom: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            margin: 0\n          },\n          children: \"Product Management\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1943,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: '#666',\n            fontSize: 13\n          },\n          children: [filteredItems.length, \" items\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1944,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1942,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 8,\n          alignItems: 'center'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"Search...\",\n          value: search,\n          onChange: e => {\n            setSearch(e.target.value);\n            setCurrentPage(1);\n          },\n          style: {\n            padding: 8,\n            borderRadius: 8,\n            border: '1px solid #ddd'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1948,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: () => {\n            setShowForm(s => !s);\n            setEditId(null);\n            setIsCopyMode(false);\n          },\n          children: showForm ? 'Close' : 'Add Product'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1950,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: () => fetchItems(),\n          disabled: loading,\n          children: loading ? 'Loading...' : 'Refresh'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1954,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1947,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1941,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: 8,\n        marginBottom: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"select\", {\n        value: filterCategory,\n        onChange: e => setFilterCategory(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"All Categories\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1961,\n          columnNumber: 11\n        }, this), categories.map(c => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: c._id,\n          children: c.name\n        }, c._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1962,\n          columnNumber: 34\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1960,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: filterSubcategory,\n        onChange: e => setFilterSubcategory(e.target.value),\n        disabled: !filterSubs.length,\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"All Subcategories\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1966,\n          columnNumber: 11\n        }, this), filterSubs.map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: s._id,\n          children: s.name\n        }, s._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1967,\n          columnNumber: 34\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1965,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginLeft: 'auto',\n          display: 'flex',\n          gap: 8\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \".csv\",\n          ref: csvInputRef,\n          onChange: handleCsvSelect\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1971,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: handleImportCsv,\n          children: \"Import\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1972,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: handleExportCsv,\n          children: \"Export All\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1973,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: handleExportSelectedCsv,\n          children: \"Export Selected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1974,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1970,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1959,\n      columnNumber: 7\n    }, this), selectedItems.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bulk-bar\",\n      style: {\n        padding: 10,\n        border: '1px solid #eee',\n        marginBottom: 12,\n        borderRadius: 8\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [selectedItems.length, \" selected\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1981,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginLeft: 'auto',\n          display: 'flex',\n          gap: 8\n        },\n        children: !bulkMode ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            onClick: () => setBulkMode(true),\n            children: \"Bulk Edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1985,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn danger\",\n            onClick: handleBulkDelete,\n            children: \"Bulk Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1986,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            onClick: handleBulkSave,\n            children: \"Save All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1990,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            onClick: () => setBulkMode(false),\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1991,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1982,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1980,\n      columnNumber: 9\n    }, this), showForm && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: 12,\n        border: '1px solid #eee',\n        borderRadius: 8,\n        marginBottom: 16\n      },\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'grid',\n            gridTemplateColumns: 'repeat(auto-fit, minmax(220px,1fr))',\n            gap: 10\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Name *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2004,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"name\",\n              value: form.name,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2005,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2003,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Category *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2009,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                gap: 8\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"select\", {\n                name: \"category\",\n                value: form.category,\n                onChange: e => {\n                  handleChange(e);\n                  setForm(p => ({\n                    ...p,\n                    subcategory: ''\n                  }));\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2012,\n                  columnNumber: 21\n                }, this), categories.map(c => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: c._id,\n                  children: c.name\n                }, c._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2013,\n                  columnNumber: 44\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2011,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: () => {/* could toggle create category */},\n                children: \"Add\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2015,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2010,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2008,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Subcategory\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2020,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              name: \"subcategory\",\n              value: form.subcategory,\n              onChange: handleChange,\n              disabled: !subcategories.length,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"Select\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2022,\n                columnNumber: 19\n              }, this), subcategories.map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: s._id,\n                children: s.name\n              }, s._id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2023,\n                columnNumber: 45\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2021,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2019,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Base Price *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2028,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"basePrice\",\n              type: \"number\",\n              value: form.basePrice,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2029,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2027,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Difference\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2033,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"difference\",\n              type: \"number\",\n              value: form.difference,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2034,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2032,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Valid Till\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2038,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"validTill\",\n              type: \"date\",\n              value: form.validTill,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2039,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2037,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2043,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"file\",\n              type: \"file\",\n              accept: \"image/*\",\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2044,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2042,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              gridColumn: '1/-1'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Description\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2048,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              name: \"description\",\n              value: form.description,\n              onChange: handleChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2049,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2047,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2002,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 10\n          },\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            type: \"submit\",\n            disabled: loading,\n            children: loading ? 'Saving...' : isCopyMode ? 'Save Copy' : editId ? 'Update' : 'Add Product'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2055,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2054,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2001,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 2000,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        overflowX: 'auto'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        style: {\n          width: '100%',\n          borderCollapse: 'collapse'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"checkbox\",\n                checked: selectedItems.length === filteredItems.length && filteredItems.length > 0,\n                onChange: () => {\n                  if (selectedItems.length === filteredItems.length) setSelectedItems([]);else setSelectedItems(filteredItems.map(x => x._id));\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2066,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2066,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Sr\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2067,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2068,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2069,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Category\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2070,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Subcategory\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2071,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Base\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2072,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Diff\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2073,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Final\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2074,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Status\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2075,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Valid Till\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2076,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Actions\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2077,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2065,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2064,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: currentItems.map((item, i) => {\n            var _item$category8, _item$subcategory6, _ref0, _item$todayDiff3, _form$_quickDiffFor$i, _form$_quickDiffFor;\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"checkbox\",\n                  checked: selectedItems.includes(item._id),\n                  onChange: () => setSelectedItems(prev => prev.includes(item._id) ? prev.filter(x => x !== item._id) : [...prev, item._id])\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2083,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2083,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: (currentPage - 1) * itemsPerPage + (i + 1)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2084,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: item.image,\n                  alt: \"\",\n                  style: {\n                    width: 50,\n                    height: 50,\n                    objectFit: 'cover'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2085,\n                  columnNumber: 35\n                }, this) : 'No Img'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2085,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2086,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: ((_item$category8 = item.category) === null || _item$category8 === void 0 ? void 0 : _item$category8.name) || '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2087,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: ((_item$subcategory6 = item.subcategory) === null || _item$subcategory6 === void 0 ? void 0 : _item$subcategory6.name) || '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2088,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: [\"\\u20B9\", item.basePrice]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2089,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: (_ref0 = (_item$todayDiff3 = item.todayDiff) !== null && _item$todayDiff3 !== void 0 ? _item$todayDiff3 : item.difference) !== null && _ref0 !== void 0 ? _ref0 : 0\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2090,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: [\"\\u20B9\", item._uiFinalPrice]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2091,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handleStatusToggle(item),\n                  className: item.status === 'active' ? 'status-active' : 'status-inactive',\n                  children: item.status\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2093,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2092,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: item.validTill ? new Date(item.validTill).toLocaleDateString() : '-'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2095,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    position: 'relative'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => setActiveMenu(activeMenu === item._id ? null : item._id),\n                    children: \"\\u22EE\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2098,\n                    columnNumber: 21\n                  }, this), activeMenu === item._id && /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      position: 'absolute',\n                      right: 0,\n                      top: 24,\n                      background: '#fff',\n                      border: '1px solid #ddd',\n                      borderRadius: 6\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => handleEdit(item),\n                      children: \"Edit\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2101,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => handleCopyToEdit(item),\n                      children: \"Copy\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2102,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => handleDelete(item._id),\n                      style: {\n                        color: 'red'\n                      },\n                      children: \"Delete\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2103,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        padding: 8,\n                        borderTop: '1px solid #eee'\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"small\", {\n                        children: \"Quick diff (applies on yesterday final)\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2106,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          display: 'flex',\n                          gap: 6,\n                          marginTop: 6\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                          type: \"number\",\n                          placeholder: \"Diff\",\n                          value: (_form$_quickDiffFor$i = (_form$_quickDiffFor = form._quickDiffFor) === null || _form$_quickDiffFor === void 0 ? void 0 : _form$_quickDiffFor[item._id]) !== null && _form$_quickDiffFor$i !== void 0 ? _form$_quickDiffFor$i : '',\n                          onChange: e => {\n                            // store quick diff in local temporary state within form\n                            setForm(prev => ({\n                              ...prev,\n                              _quickDiffFor: {\n                                ...(prev._quickDiffFor || {}),\n                                [item._id]: e.target.value\n                              }\n                            }));\n                          },\n                          style: {\n                            width: 90\n                          }\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2108,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                          onClick: () => handleDiffUpdate(item._id, Number((form._quickDiffFor || {})[item._id] || 0)),\n                          children: \"Apply\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 2112,\n                          columnNumber: 29\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 2107,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2104,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2100,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2097,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2096,\n                columnNumber: 17\n              }, this)]\n            }, item._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2082,\n              columnNumber: 15\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2080,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2063,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 2062,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        gap: 6,\n        justifyContent: 'center',\n        marginTop: 12\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setCurrentPage(p => Math.max(1, p - 1)),\n        disabled: currentPage === 1,\n        children: \"Previous\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2127,\n        columnNumber: 9\n      }, this), Array.from({\n        length: totalPages\n      }, (_, i) => /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setCurrentPage(i + 1),\n        style: i + 1 === currentPage ? {\n          fontWeight: 'bold'\n        } : {},\n        children: i + 1\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2129,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setCurrentPage(p => Math.min(totalPages, p + 1)),\n        disabled: currentPage === totalPages,\n        children: \"Next\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2131,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2126,\n      columnNumber: 7\n    }, this), showModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-overlay\",\n      onClick: () => setShowModal(false),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal\",\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: isCopyMode ? 'Copy Product' : 'Edit Product'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2138,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'grid',\n              gridTemplateColumns: 'repeat(auto-fit,minmax(220px,1fr))',\n              gap: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Name\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2142,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                name: \"name\",\n                value: form.name,\n                onChange: handleChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2143,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2141,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Category\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2147,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                name: \"category\",\n                value: form.category,\n                onChange: e => {\n                  handleChange(e);\n                  setForm(p => ({\n                    ...p,\n                    subcategory: ''\n                  }));\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2149,\n                  columnNumber: 21\n                }, this), categories.map(c => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: c._id,\n                  children: c.name\n                }, c._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2150,\n                  columnNumber: 44\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2148,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2146,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Subcategory\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2155,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                name: \"subcategory\",\n                value: form.subcategory,\n                onChange: handleChange,\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"Select\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2157,\n                  columnNumber: 21\n                }, this), subcategories.map(s => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: s._id,\n                  children: s.name\n                }, s._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2158,\n                  columnNumber: 47\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2156,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2154,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Base Price\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2163,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                name: \"basePrice\",\n                type: \"number\",\n                value: form.basePrice,\n                onChange: handleChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2164,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2162,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Difference (for create only)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2168,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                name: \"difference\",\n                type: \"number\",\n                value: form.difference,\n                onChange: handleChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2169,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2167,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Valid Till\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2173,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                name: \"validTill\",\n                type: \"date\",\n                value: form.validTill,\n                onChange: handleChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2174,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2172,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Image\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2178,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                name: \"file\",\n                type: \"file\",\n                accept: \"image/*\",\n                onChange: handleChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2179,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2177,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                gridColumn: '1/-1'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2183,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                name: \"description\",\n                value: form.description,\n                onChange: handleChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2184,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2182,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2140,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginTop: 10,\n              display: 'flex',\n              gap: 8\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn\",\n              type: \"submit\",\n              children: isCopyMode ? 'Save Copy' : 'Update'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2189,\n              columnNumber: 17\n            }, this), editId && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn\",\n              type: \"button\",\n              onClick: () => {\n                if (!window.confirm('Apply diff update from form?')) return;\n                handleDiffUpdate(editId, Number(form.difference || 0));\n              },\n              children: \"Apply Diff\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2190,\n              columnNumber: 28\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn\",\n              type: \"button\",\n              onClick: () => {\n                setShowModal(false);\n                setEditId(null);\n                setIsCopyMode(false);\n                setForm({\n                  name: '',\n                  category: '',\n                  subcategory: '',\n                  description: '',\n                  basePrice: '',\n                  difference: '',\n                  validTill: '',\n                  file: null\n                });\n              },\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2191,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2188,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 2139,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2137,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 2136,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 1940,\n    columnNumber: 5\n  }, this);\n}\n_s(PriceList, \"X72O8o9mQmYZ9DXhpRE8yRRfaBY=\");\n_c = PriceList;\nvar _c;\n$RefreshReg$(_c, \"PriceList\");","map":{"version":3,"names":["React","useEffect","useState","useRef","axios","jsxDEV","_jsxDEV","Fragment","_Fragment","API_URL","process","env","REACT_APP_API_URL_PRICES","CATEGORY_URL","REACT_APP_API_URL_CATEGORIES","PriceList","_s","items","setItems","categories","setCategories","subcategories","setSubcategories","loading","setLoading","search","setSearch","isMobile","setIsMobile","window","innerWidth","form","setForm","name","category","subcategory","description","basePrice","difference","validTill","file","editId","setEditId","isCopyMode","setIsCopyMode","showForm","setShowForm","showModal","setShowModal","activeMenu","setActiveMenu","selectedItems","setSelectedItems","bulkMode","setBulkMode","csvFile","setCsvFile","csvInputRef","currentPage","setCurrentPage","itemsPerPage","filterCategory","setFilterCategory","filterSubcategory","setFilterSubcategory","filterSubs","setFilterSubs","fetchCategories","onResize","addEventListener","removeEventListener","length","fetchItems","cat","find","c","_id","prev","subs","exists","some","s","res","get","data","success","err","console","error","alert","raw","enriched","map","item","_cat$subcategories","_ref","_item$lastFinalPrice","_item$category","sub","_item$subcategory","finalVal","currentFinalPrice","isNaN","lastFinalPrice","_uiFinalPrice","handleChange","e","value","files","target","p","handleSubmit","preventDefault","fd","FormData","Object","keys","forEach","k","val","undefined","append","post","put","handleEdit","_item$category2","_item$category2$_id","_item$subcategory2","_item$subcategory2$_i","_item$basePrice","_item$todayDiff","toString","todayDiff","split","_item$category3","handleCopyToEdit","_item$category4","_item$category4$_id","_item$subcategory3","_item$subcategory3$_i","_item$basePrice2","_item$todayDiff2","_item$category5","handleDelete","id","confirm","delete","filter","x","handleStatusToggle","newStatus","status","handleDiffUpdate","diff","Number","handleBulkDelete","Promise","all","updateLocalItemField","key","handleBulkSave","updates","includes","products","handleCsvSelect","_e$target$files","handleImportCsv","inserted","current","handleExportCsv","header","rows","_p$category","_p$subcategory","_p$basePrice","_ref2","_p$todayDiff","_ref3","_ref4","_ref5","_p$_uiFinalPrice","Date","toISOString","image","csvArray","csvContent","r","String","replace","join","encodedUri","encodeURI","link","document","createElement","href","download","now","click","handleExportSelectedCsv","selected","_p$category2","_p$subcategory2","_p$basePrice2","_ref6","_p$todayDiff2","_ref7","_ref8","_ref9","_p$_uiFinalPrice2","filteredItems","_item$category6","_item$subcategory4","_item$category7","_item$subcategory5","t","trim","toLowerCase","textMatch","catMatch","subMatch","indexOfLast","currentItems","slice","totalPages","Math","max","ceil","className","style","padding","children","display","justifyContent","alignItems","marginBottom","margin","fileName","_jsxFileName","lineNumber","columnNumber","color","fontSize","gap","placeholder","onChange","borderRadius","border","onClick","disabled","marginLeft","type","accept","ref","onSubmit","gridTemplateColumns","gridColumn","marginTop","overflowX","width","borderCollapse","checked","i","_item$category8","_item$subcategory6","_ref0","_item$todayDiff3","_form$_quickDiffFor$i","_form$_quickDiffFor","src","alt","height","objectFit","toLocaleDateString","position","right","top","background","borderTop","_quickDiffFor","Array","from","_","fontWeight","min","stopPropagation","_c","$RefreshReg$"],"sources":["E:/infyle/Grocerry_final/frontend/src/pages/PriceList.jsx"],"sourcesContent":["\r\n// import React, { useEffect, useState, useRef } from \"react\";\r\n// import axios from \"axios\";\r\n// import \"./PriceList.css\"\r\n// const API_URL = \"https://grocerrybackend.vercel.app/api/prices\";\r\n// const CATEGORY_URL = \"https://grocerrybackend.vercel.app/api/categories\";\r\n\r\n// export default function PriceList() {\r\n//   const [items, setItems] = useState([]);\r\n//   const [categories, setCategories] = useState([]);\r\n//   const [subcategories, setSubcategories] = useState([]);\r\n//   const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\r\n//   const [search, setSearch] = useState(\"\");\r\n//   const [loading, setLoading] = useState(false);\r\n\r\n//   // FORM state\r\n//   const [form, setForm] = useState({\r\n//     name: \"\",\r\n//     category: \"\",\r\n//     subcategory: \"\",\r\n//     description: \"\",\r\n//     basePrice: \"\",\r\n//     difference: \"\",\r\n//     validTill: \"\",\r\n//     file: null,\r\n//   });\r\n\r\n//   const [editId, setEditId] = useState(null);\r\n//   const [isCopyMode, setIsCopyMode] = useState(false);\r\n//   const [showForm, setShowForm] = useState(false);\r\n//   const [showModal, setShowModal] = useState(false);\r\n//   const [activeMenu, setActiveMenu] = useState(null);\r\n\r\n//   const [addingCategory, setAddingCategory] = useState(false);\r\n//   const [newCategoryName, setNewCategoryName] = useState(\"\");\r\n//   const [newCategoryImage, setNewCategoryImage] = useState(null);\r\n//   const [newCategoryPreview, setNewCategoryPreview] = useState(null);\r\n\r\n//   const [addingSub, setAddingSub] = useState(false);\r\n//   const [newSubName, setNewSubName] = useState(\"\");\r\n//   const [newSubImage, setNewSubImage] = useState(null);\r\n//   const [newSubPreview, setNewSubPreview] = useState(null);\r\n\r\n//   const [selectedItems, setSelectedItems] = useState([]);\r\n//   const [bulkMode, setBulkMode] = useState(false);\r\n\r\n//   const [csvFile, setCsvFile] = useState(null);\r\n//   const csvInputRef = useRef();\r\n\r\n//   const [currentPage, setCurrentPage] = useState(1);\r\n//   const itemsPerPage = 30;\r\n\r\n//   const [filterCategory, setFilterCategory] = useState(\"\");\r\n// const [filterSubcategory, setFilterSubcategory] = useState(\"\");\r\n// const [filterSubs, setFilterSubs] = useState([]);\r\n\r\n// useEffect(() => {\r\n//   if (!filterCategory) {\r\n//     setFilterSubs([]);\r\n//     setFilterSubcategory(\"\");\r\n//     return;\r\n//   }\r\n\r\n//   const cat = categories.find(c => c._id === filterCategory);\r\n//   setFilterSubs(cat?.subcategories || []);\r\n//   setFilterSubcategory(\"\");\r\n// }, [filterCategory, categories]);\r\n\r\n\r\n//   // useEffect(() => {\r\n//   //   fetchItems();\r\n//   //   fetchCategories();\r\n\r\n//   //   const handleResize = () => setIsMobile(window.innerWidth < 768);\r\n//   //   window.addEventListener(\"resize\", handleResize);\r\n//   //   return () => window.removeEventListener(\"resize\", handleResize);\r\n//   // }, []);\r\n//   // 1. Pehle categories load karo\r\n// useEffect(() => {\r\n//   fetchCategories();\r\n// }, []);\r\n\r\n// // 2. Categories load hone ke baad items load karo\r\n// useEffect(() => {\r\n//   if (categories.length > 0) {\r\n//     fetchItems();\r\n//   }\r\n// }, [categories]);\r\n\r\n// // 3. Resize listener\r\n// useEffect(() => {\r\n//   const handleResize = () => setIsMobile(window.innerWidth < 768);\r\n//   window.addEventListener(\"resize\", handleResize);\r\n//   return () => window.removeEventListener(\"resize\", handleResize);\r\n// }, []);\r\n\r\n\r\n//   const fetchItems = async () => {\r\n//     try {\r\n//       setLoading(true);\r\n//       const res = await axios.get(API_URL);\r\n//       // if (res.data && res.data.success) setItems(res.data.data || []);\r\n//       if (res.data && res.data.success) {\r\n//   const raw = res.data.data;\r\n\r\n//   // Agar categories abhi load nahi hui = raw items set\r\n//   if (!categories.length) {\r\n//     setItems(raw);\r\n//     return;\r\n//   }\r\n\r\n//   // Mapping to category + subcategory object\r\n//   const enriched = raw.map((item) => {\r\n//     const cat = categories.find(\r\n//       (c) =>\r\n//         c._id === item.category ||\r\n//         c._id === item.category?._id\r\n//     );\r\n\r\n//     const sub = cat?.subcategories?.find(\r\n//       (s) =>\r\n//         s._id === item.subcategory ||\r\n//         s._id === item.subcategory?._id\r\n//     );\r\n\r\n//     return {\r\n//       ...item,\r\n//       category: cat\r\n//         ? { _id: cat._id, name: cat.name }\r\n//         : item.category,\r\n\r\n//       subcategory: sub\r\n//         ? { _id: sub._id, name: sub.name }\r\n//         : item.subcategory,\r\n//     };\r\n//   });\r\n\r\n//   setItems(enriched);\r\n// }\r\n\r\n//     } catch (err) {\r\n//       console.error(\"Fetch items error\", err);\r\n//       alert(\"Could not fetch items\");\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   const fetchCategories = async () => {\r\n//     try {\r\n//       const res = await axios.get(CATEGORY_URL);\r\n//       if (res.data && res.data.success) setCategories(res.data.categories || []);\r\n//     } catch (err) {\r\n//       console.error(\"Fetch categories error\", err);\r\n//       alert(\"Could not fetch categories\");\r\n//     }\r\n//   };\r\n\r\n//   useEffect(() => {\r\n//     if (!form.category) {\r\n//       setSubcategories([]);\r\n//       setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n//       return;\r\n//     }\r\n\r\n//     const cat = categories.find((c) => c._id === form.category);\r\n//     const subs = (cat && cat.subcategories) || [];\r\n//     setSubcategories(subs);\r\n\r\n//     const exists = subs.some((s) => s._id === form.subcategory);\r\n//     if (!exists) setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n//   }, [form.category, categories]);\r\n\r\n//   const handleCreateCategory = async () => {\r\n//     if (!newCategoryName.trim()) return alert(\"Enter category name\");\r\n//     try {\r\n//       const fd = new FormData();\r\n//       fd.append(\"name\", newCategoryName.trim());\r\n//       if (newCategoryImage) fd.append(\"image\", newCategoryImage);\r\n\r\n//       const res = await axios.post(CATEGORY_URL, fd);\r\n//       if (res.data && res.data.success) {\r\n//         alert(\"Category created\");\r\n//         setNewCategoryName(\"\");\r\n//         setNewCategoryImage(null);\r\n//         setNewCategoryPreview(null);\r\n//         setAddingCategory(false);\r\n//         fetchCategories();\r\n//       } else {\r\n//         alert(\"Category creation failed\");\r\n//       }\r\n//     } catch (err) {\r\n//       console.error(\"Create category error\", err);\r\n//       alert(\"Category creation failed\");\r\n//     }\r\n//   };\r\n\r\n//   const handleCreateSub = async () => {\r\n//     if (!newSubName.trim()) return alert(\"Enter subcategory name\");\r\n//     if (!form.category) return alert(\"Select category first\");\r\n\r\n//     try {\r\n//       const fd = new FormData();\r\n//       fd.append(\"name\", newSubName.trim());\r\n//       if (newSubImage) fd.append(\"image\", newSubImage);\r\n\r\n//       const res = await axios.post(`${CATEGORY_URL}/${form.category}/sub`, fd);\r\n//       if (res.data && res.data.success) {\r\n//         alert(\"Subcategory created\");\r\n//         setNewSubName(\"\");\r\n//         setNewSubImage(null);\r\n//         setNewSubPreview(null);\r\n//         setAddingSub(false);\r\n//         fetchCategories();\r\n//       } else {\r\n//         alert(\"Subcategory creation failed\");\r\n//       }\r\n//     } catch (err) {\r\n//       console.error(\"Create sub error\", err);\r\n//       alert(\"Subcategory creation failed\");\r\n//     }\r\n//   };\r\n\r\n//   const handleChange = (e) => {\r\n//     const { name, value, files } = e.target;\r\n//     if (files && files.length) {\r\n//       setForm((p) => ({ ...p, file: files[0] }));\r\n//     } else {\r\n//       setForm((p) => ({ ...p, [name]: value }));\r\n//     }\r\n//   };\r\n\r\n//   const handleSubmit = async (e) => {\r\n//     e.preventDefault();\r\n//     setLoading(true);\r\n\r\n//     try {\r\n//       if (!form.name || !form.category || !form.basePrice) {\r\n//         alert(\"Name, category & base price are required\");\r\n//         setLoading(false);\r\n//         return;\r\n//       }\r\n\r\n//       const fd = new FormData();\r\n//       Object.keys(form).forEach((k) => {\r\n//         const val = form[k];\r\n//         if (val !== undefined && val !== null) {\r\n//           fd.append(k, val);\r\n//         }\r\n//       });\r\n\r\n//       let res;\r\n//       if (isCopyMode) {\r\n//         res = await axios.post(API_URL, fd);\r\n//         alert(\"Copied as new item\");\r\n//       } else if (editId) {\r\n//         res = await axios.put(`${API_URL}/${editId}`, fd);\r\n//         alert(\"Updated\");\r\n//       } else {\r\n//         res = await axios.post(API_URL, fd);\r\n//         alert(\"Added\");\r\n//       }\r\n\r\n//       await fetchItems();\r\n//       await fetchCategories();\r\n\r\n//       setForm({\r\n//         name: \"\",\r\n//         category: \"\",\r\n//         subcategory: \"\",\r\n//         description: \"\",\r\n//         basePrice: \"\",\r\n//         difference: \"\",\r\n//         validTill: \"\",\r\n//         file: null,\r\n//       });\r\n//       setEditId(null);\r\n//       setIsCopyMode(false);\r\n//       setShowModal(false);\r\n//       setShowForm(false);\r\n//     } catch (err) {\r\n//       console.error(\"Save error\", err);\r\n//       alert(\"Save failed\");\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   const handleEdit = (item) => {\r\n//     setForm({\r\n//       name: item.name || \"\",\r\n//       category: item.category?._id?.toString() || \"\",\r\n//       subcategory: item.subcategory?._id?.toString() || \"\",\r\n//       description: item.description || \"\",\r\n//       basePrice: item.basePrice ?? \"\",\r\n//       difference: item.difference ?? \"\",\r\n//       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n//       file: null,\r\n//     });\r\n\r\n//     const cat = categories.find((c) => c._id === item.category?._id);\r\n//     setSubcategories(cat?.subcategories || []);\r\n\r\n//     setEditId(item._id);\r\n//     setIsCopyMode(false);\r\n//     setShowModal(true);\r\n//     setActiveMenu(null);\r\n//   };\r\n\r\n//   const handleCopyToEdit = (item) => {\r\n//     setForm({\r\n//       name: item.name || \"\",\r\n//       category: item.category?._id?.toString() || \"\",\r\n//       subcategory: item.subcategory?._id?.toString() || \"\",\r\n//       description: item.description || \"\",\r\n//       basePrice: item.basePrice ?? \"\",\r\n//       difference: item.difference ?? \"\",\r\n//       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n//       file: null,\r\n//     });\r\n\r\n//     const cat = categories.find((c) => c._id === item.category?._id);\r\n//     setSubcategories(cat?.subcategories || []);\r\n\r\n//     setEditId(null);\r\n//     setIsCopyMode(true);\r\n//     setShowModal(true);\r\n//     setActiveMenu(null);\r\n//   };\r\n\r\n//   const handleDelete = async (id) => {\r\n//     if (!window.confirm(\"Delete item?\")) return;\r\n//     try {\r\n//       await axios.delete(`${API_URL}/${id}`);\r\n//       setItems((prev) => prev.filter((x) => x._id !== id));\r\n//       setSelectedItems((prev) => prev.filter((x) => x !== id));\r\n//       setActiveMenu(null);\r\n//     } catch (err) {\r\n//       console.error(\"Delete error\", err);\r\n//       alert(\"Delete failed\");\r\n//     }\r\n//   };\r\n\r\n//   const handleStatusToggle = async (item) => {\r\n//     try {\r\n//       const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\r\n//       await axios.put(`${API_URL}/status/${item._id}`, { status: newStatus });\r\n//       setItems((prev) => prev.map((x) => (x._id === item._id ? { ...x, status: newStatus } : x)));\r\n//     } catch (err) {\r\n//       console.error(\"Status toggle error\", err);\r\n//       alert(\"Status update failed\");\r\n//     }\r\n//   };\r\n\r\n//   const handleBulkDelete = async () => {\r\n//     if (!selectedItems.length) return alert(\"No items selected\");\r\n//     if (!window.confirm(\"Delete selected items?\")) return;\r\n\r\n//     try {\r\n//       await Promise.all(selectedItems.map((id) => axios.delete(`${API_URL}/${id}`)));\r\n//       setSelectedItems([]);\r\n//       fetchItems();\r\n//       setBulkMode(false);\r\n//     } catch (err) {\r\n//       console.error(\"Bulk delete error\", err);\r\n//       alert(\"Bulk delete failed\");\r\n//     }\r\n//   };\r\n\r\n//   const updateLocalItemField = (id, key, value) => {\r\n//     setItems((prev) => prev.map((x) => (x._id === id ? { ...x, [key]: value } : x)));\r\n//   };\r\n\r\n//   const handleBulkSave = async () => {\r\n//     if (!selectedItems.length) return alert(\"No items selected for bulk save\");\r\n\r\n//     const updates = items\r\n//       .filter((x) => selectedItems.includes(x._id))\r\n//       .map((x) => ({\r\n//         id: x._id,\r\n//         name: x.name,\r\n//         basePrice: x.basePrice,\r\n//         difference: x.difference,\r\n//         validTill: x.validTill,\r\n//       }));\r\n\r\n//     try {\r\n//       await axios.post(`${API_URL}/bulk-update`, { products: updates });\r\n//       setBulkMode(false);\r\n//       setSelectedItems([]);\r\n//       fetchItems();\r\n//     } catch (err) {\r\n//       console.error(\"Bulk save error\", err);\r\n//       alert(\"Bulk save failed\");\r\n//     }\r\n//   };\r\n\r\n//   const handleCsvSelect = (e) => {\r\n//     setCsvFile(e.target.files[0]);\r\n//   };\r\n\r\n//   const handleImportCsv = async () => {\r\n//     if (!csvFile) return alert(\"Select CSV file\");\r\n//     try {\r\n//       const fd = new FormData();\r\n//       fd.append(\"file\", csvFile);\r\n//       const res = await axios.post(`${API_URL}/import`, fd);\r\n//       if (res.data && res.data.success) {\r\n//         alert(`Imported ${res.data.inserted || 0} items`);\r\n//         setCsvFile(null);\r\n//         if (csvInputRef.current) csvInputRef.current.value = null;\r\n//         fetchItems();\r\n//       } else {\r\n//         alert(\"CSV import failed\");\r\n//       }\r\n//     } catch (err) {\r\n//       console.error(\"CSV import error\", err);\r\n//       alert(\"CSV import failed\");\r\n//     }\r\n//   };\r\n\r\n//   // const handleExportCsv = async () => {\r\n//   //   try {\r\n//   //     const res = await axios.get(`${API_URL}/export`, { responseType: \"blob\" });\r\n//   //     const url = window.URL.createObjectURL(new Blob([res.data]));\r\n//   //     const a = document.createElement(\"a\");\r\n//   //     a.href = url;\r\n//   //     a.download = \"prices.csv\";\r\n//   //     a.click();\r\n//   //     URL.revokeObjectURL(url);\r\n//   //   } catch (err) {\r\n//   //     console.error(\"CSV export error\", err);\r\n//   //     alert(\"CSV export failed\");\r\n//   //   }\r\n//   // };\r\n// const handleExportCsv = () => {\r\n//   if (!items.length) return alert(\"No items to export\");\r\n\r\n//   const header = [\r\n//     \"id\",\r\n//     \"name\",\r\n//     \"categoryName\",\r\n//     \"subcategoryName\",\r\n//     \"basePrice\",\r\n//     \"difference\",\r\n//     \"finalPrice\",\r\n//     \"status\",\r\n//     \"validTill\",\r\n//     \"description\",\r\n//     \"imageUrl\",\r\n//   ];\r\n\r\n//   const rows = items.map((p) => [\r\n//     p._id,\r\n//     p.name || \"\",\r\n//     p.category?.name || \"\",\r\n//     p.subcategory?.name || \"\",\r\n//     p.basePrice ?? \"\",\r\n//     p.difference ?? \"\",\r\n//     (Number(p.basePrice) + Number(p.difference || 0)) || \"\",\r\n//     p.status || \"\",\r\n//     p.validTill ? new Date(p.validTill).toISOString().split(\"T\")[0] : \"\",\r\n//     p.description || \"\",\r\n//     p.image || \"\",\r\n//   ]);\r\n\r\n//   const csvArray = [header, ...rows];\r\n//   const csvContent =\r\n//     \"data:text/csv;charset=utf-8,\" +\r\n//     csvArray\r\n//       .map((r) => r.map((c) => `\"${String(c).replace(/\"/g, '\"\"')}\"`).join(\",\"))\r\n//       .join(\"\\n\");\r\n\r\n//   const encodedUri = encodeURI(csvContent);\r\n//   const link = document.createElement(\"a\");\r\n//   link.href = encodedUri;\r\n//   link.download = `all_prices_${Date.now()}.csv`;\r\n//   link.click();\r\n// };\r\n\r\n//   const handleExportSelectedCsv = () => {\r\n//     if (!selectedItems.length) return alert(\"Select items to export\");\r\n\r\n//     const selectedData = items.filter((x) => selectedItems.includes(x._id));\r\n//     const header = [\r\n//       \"id\",\r\n//       \"name\",\r\n//       \"categoryName\",\r\n//       \"subcategoryName\",\r\n//       \"basePrice\",\r\n//       \"difference\",\r\n//       \"finalPrice\",\r\n//       \"status\",\r\n//       \"validTill\",\r\n//       \"description\",\r\n//       \"imageUrl\",\r\n//     ];\r\n\r\n//     const rows = selectedData.map((p) => [\r\n//       p._id,\r\n//       p.name || \"\",\r\n//       p.category?.name || \"\",\r\n//       p.subcategory?.name || \"\",\r\n//       p.basePrice ?? \"\",\r\n//       p.difference ?? \"\",\r\n//       (Number(p.basePrice) + Number(p.difference || 0)) || \"\",\r\n//       p.status || \"\",\r\n//       p.validTill ? new Date(p.validTill).toISOString().split(\"T\")[0] : \"\",\r\n//       p.description || \"\",\r\n//       p.image || \"\",\r\n//     ]);\r\n\r\n//     const csvArray = [header, ...rows];\r\n//     const csvContent =\r\n//       \"data:text/csv;charset=utf-8,\" +\r\n//       csvArray.map((r) => r.map((c) => `\"${String(c).replace(/\"/g, '\"\"')}\"`).join(\",\")).join(\"\\n\");\r\n\r\n//     const encodedUri = encodeURI(csvContent);\r\n//     const link = document.createElement(\"a\");\r\n//     link.href = encodedUri;\r\n//     link.download = `selected_prices_${Date.now()}.csv`;\r\n//     link.click();\r\n//   };\r\n\r\n//   // const filteredItems = items.filter((item) => {\r\n//   //   const t = search.toLowerCase();\r\n//   //   return (\r\n//   //     (item.name || \"\").toString().toLowerCase().includes(t) ||\r\n//   //     (item.category?.name || \"\").toLowerCase().includes(t) ||\r\n//   //     (item.subcategory?.name || \"\").toLowerCase().includes(t)\r\n//   //   );\r\n//   // });\r\n//   const filteredItems = items.filter((item) => {\r\n//   const t = search.toLowerCase();\r\n\r\n//   const matchText =\r\n//     (item.name || \"\").toLowerCase().includes(t) ||\r\n//     (item.category?.name || \"\").toLowerCase().includes(t) ||\r\n//     (item.subcategory?.name || \"\").toLowerCase().includes(t);\r\n\r\n//   const matchCategory =\r\n//     !filterCategory || item.category?._id === filterCategory;\r\n\r\n//   const matchSub =\r\n//     !filterSubcategory || item.subcategory?._id === filterSubcategory;\r\n\r\n//   return matchText && matchCategory && matchSub;\r\n// });\r\n\r\n\r\n//   const indexOfLast = currentPage * itemsPerPage;\r\n//   const currentItems = filteredItems.slice(indexOfLast - itemsPerPage, indexOfLast);\r\n//   const totalPages = Math.max(1, Math.ceil(filteredItems.length / itemsPerPage));\r\n\r\n//   return (\r\n//     <div style={styles.container}>\r\n//       {/* HEADER */}\r\n//       <div style={styles.header}>\r\n//         <h1 style={styles.title}>Product Management</h1>\r\n//         {/* <p style={styles.subtitle}>Manage prices, categories, images, CSV & bulk actions.</p> */}\r\n//       </div>\r\n\r\n//       {/* SEARCH */}\r\n      \r\n//      <div className=\"mobile-topbar\">\r\n//   <input\r\n//     type=\"text\"\r\n//     placeholder=\"Search product, category or subcategory...\"\r\n//     value={search}\r\n//     onChange={(e) => {\r\n//       setSearch(e.target.value);\r\n//       setCurrentPage(1);\r\n//     }}\r\n//     style={styles.searchInput}\r\n//   />\r\n\r\n//   <button\r\n//     style={styles.addButton}\r\n//     onClick={() => {\r\n//       setShowForm(!showForm);\r\n//       setEditId(null);\r\n//       setIsCopyMode(false);\r\n//     }}\r\n//   >\r\n//     {showForm ? \"‚úñ\" : \"Add Product\"}\r\n//   </button>\r\n// </div>\r\n// <div className=\"filter-bar\">\r\n//   <select\r\n//     value={filterCategory}\r\n//     onChange={(e) => setFilterCategory(e.target.value)}\r\n//     className=\"filter-select\"\r\n//   >\r\n//     <option value=\"\">Filter by Category</option>\r\n//     {categories.map((c) => (\r\n//       <option key={c._id} value={c._id}>{c.name}</option>\r\n//     ))}\r\n//   </select>\r\n\r\n//   <select\r\n//     value={filterSubcategory}\r\n//     onChange={(e) => setFilterSubcategory(e.target.value)}\r\n//     className=\"filter-select\"\r\n//     disabled={!filterSubs.length}\r\n//   >\r\n//     <option value=\"\">Filter by Subcategory</option>\r\n//     {filterSubs.map((s) => (\r\n//       <option key={s._id} value={s._id}>{s.name}</option>\r\n//     ))}\r\n//   </select>\r\n\r\n  \r\n// </div>\r\n\r\n\r\n//       {/* BULK BAR */}\r\n//       {selectedItems.length > 0 && (\r\n//         // <div style={styles.bulkBar}>\r\n//         <div className=\"bulk-bar\">\r\n\r\n//           {/* <span style={styles.bulkText}>{selectedItems.length} selected</span> */}\r\n\r\n//           {!bulkMode ? (\r\n//             // <div style={{ display: \"flex\", gap: 10, flexWrap: \"wrap\" }}>\r\n//             <div className=\"bulk-actions\">\r\n\r\n//               <button style={styles.btnDelete} onClick={handleBulkDelete}>\r\n//                 üóë Bulk Delete\r\n//               </button>\r\n\r\n//               <button style={styles.btnPrimary} onClick={() => setBulkMode(true)}>\r\n//                 ‚úè Bulk Edit\r\n//               </button>\r\n\r\n//               {/* <button style={styles.btnSmall} onClick={handleExportSelectedCsv}>\r\n//                 ‚§ì Export Selected\r\n//               </button> */}\r\n//             </div>\r\n//           ) : (\r\n//             <div style={styles.bulkPanel}>\r\n//               <h3 style={styles.bulkPanelTitle}>‚úè Bulk Edit Selected Items</h3>\r\n\r\n//               {items\r\n//                 .filter((item) => selectedItems.includes(item._id))\r\n//                 .map((item) => (\r\n//                   <div key={item._id} style={styles.bulkItemBox}>\r\n//                     <h4 style={styles.bulkItemTitle}>{item.name}</h4>\r\n\r\n//                     <div style={styles.formGrid}>\r\n//                       <div style={styles.formGroup}>\r\n//                         <label style={styles.label}>Name</label>\r\n//                         <input\r\n//                           type=\"text\"\r\n//                           value={item.name}\r\n//                           onChange={(e) => updateLocalItemField(item._id, \"name\", e.target.value)}\r\n//                           style={styles.input}\r\n//                         />\r\n//                       </div>\r\n\r\n//                       <div style={styles.formGroup}>\r\n//                         <label style={styles.label}>Base Price</label>\r\n//                         <input\r\n//                           type=\"number\"\r\n//                           value={item.basePrice}\r\n//                           onChange={(e) =>\r\n//                             updateLocalItemField(item._id, \"basePrice\", Number(e.target.value))\r\n//                           }\r\n//                           style={styles.input}\r\n//                         />\r\n//                       </div>\r\n\r\n//                       <div style={styles.formGroup}>\r\n//                         <label style={styles.label}>Category</label>\r\n//                         <select\r\n//                           value={item.category?._id || \"\"}\r\n//                           onChange={(e) => {\r\n//                             const newCat = e.target.value;\r\n//                             updateLocalItemField(item._id, \"category\", { _id: newCat });\r\n//                             const catObj = categories.find((c) => c._id === newCat);\r\n//                             const firstSub = catObj?.subcategories?.[0]?._id || \"\";\r\n//                             updateLocalItemField(item._id, \"subcategory\", { _id: firstSub });\r\n//                           }}\r\n//                           style={styles.select}\r\n//                         >\r\n//                           <option value=\"\">Select Category</option>\r\n//                           {categories.map((c) => (\r\n//                             <option key={c._id} value={c._id}>\r\n//                               {c.name}\r\n//                             </option>\r\n//                           ))}\r\n//                         </select>\r\n//                       </div>\r\n\r\n//                       <div style={styles.formGroup}>\r\n//                         <label style={styles.label}>Subcategory</label>\r\n//                         <select\r\n//                           value={item.subcategory?._id || \"\"}\r\n//                           onChange={(e) =>\r\n//                             updateLocalItemField(item._id, \"subcategory\", { _id: e.target.value })\r\n//                           }\r\n//                           style={styles.select}\r\n//                         >\r\n//                           <option value=\"\">Select Subcategory</option>\r\n//                           {categories\r\n//                             .find((c) => c._id === item.category?._id)\r\n//                             ?.subcategories?.map((s) => (\r\n//                               <option key={s._id} value={s._id}>\r\n//                                 {s.name}\r\n//                               </option>\r\n//                             ))}\r\n//                         </select>\r\n//                       </div>\r\n\r\n//                       <div style={styles.formGroup}>\r\n//                         <label style={styles.label}>Difference</label>\r\n//                         <input\r\n//                           type=\"number\"\r\n//                           value={item.difference || 0}\r\n//                           onChange={(e) =>\r\n//                             updateLocalItemField(item._id, \"difference\", Number(e.target.value))\r\n//                           }\r\n//                           style={styles.input}\r\n//                         />\r\n//                       </div>\r\n//                     </div>\r\n//                   </div>\r\n//                 ))}\r\n\r\n//               <div style={{ display: \"flex\", gap: 0, marginTop: 12 }}>\r\n//                 <button style={styles.btnPrimary} onClick={handleBulkSave}>\r\n//                   ‚úî Save All\r\n//                 </button>\r\n//                 <button style={styles.btnCancel} onClick={() => setBulkMode(false)}>\r\n//                   ‚úñ Cancel\r\n//                 </button>\r\n//               </div>\r\n//             </div>\r\n//           )}\r\n//         </div>\r\n//       )}\r\n\r\n//       {/* FORM */}\r\n//       {showForm && (\r\n//         <div style={styles.formCard}>\r\n//           <h2 style={styles.formTitle}>‚ûï Add \r\n            \r\n//           </h2>\r\n\r\n//           <form onSubmit={handleSubmit}>\r\n//             <div style={styles.formGrid}>\r\n//               <div style={styles.formGroup}>\r\n//                 <label style={styles.label}>Product Name *</label>\r\n//                 <input required name=\"name\" value={form.name} onChange={handleChange} style={styles.input} />\r\n//               </div>\r\n\r\n//               <div style={styles.formGroup}>\r\n//                 <label style={styles.label}>Category *</label>\r\n//                 <div style={styles.categoryRow}>\r\n//                   <select\r\n//                     required\r\n//                     name=\"category\"\r\n//                     value={form.category}\r\n//                     onChange={(e) => {\r\n//                       handleChange(e);\r\n//                       setForm((p) => ({ ...p, subcategory: \"\" }));\r\n//                     }}\r\n//                     style={styles.select}\r\n//                   >\r\n//                     <option value=\"\">Select Category</option>\r\n//                     {categories.map((c) => (\r\n//                       <option value={c._id} key={c._id}>\r\n//                         {c.name}\r\n//                       </option>\r\n//                     ))}\r\n//                   </select>\r\n\r\n//                   <button type=\"button\" style={styles.btnSmall} onClick={() => setAddingCategory((v) => !v)}>\r\n//                     {addingCategory ? \"Close\" : \"Add\"}\r\n//                   </button>\r\n//                 </div>\r\n//               </div>\r\n\r\n//               {addingCategory && (\r\n//                 <div style={styles.addCategoryBox}>\r\n//                   <label style={styles.label}>Add New Category</label>\r\n//                   <div style={styles.categoryRow}>\r\n//                     <input\r\n//                       value={newCategoryName}\r\n//                       onChange={(e) => setNewCategoryName(e.target.value)}\r\n//                       placeholder=\"Category name\"\r\n//                       style={styles.input}\r\n//                     />\r\n//                     <input\r\n//                       type=\"file\"\r\n//                       accept=\"image/*\"\r\n//                       onChange={(e) => {\r\n//                         setNewCategoryImage(e.target.files[0]);\r\n//                         setNewCategoryPreview(e.target.files[0] ? URL.createObjectURL(e.target.files[0]) : null);\r\n//                       }}\r\n//                       style={styles.fileInput}\r\n//                     />\r\n//                     <button style={styles.btnPrimary} type=\"button\" onClick={handleCreateCategory}>\r\n//                       Create\r\n//                     </button>\r\n//                   </div>\r\n//                   {newCategoryPreview && <img src={newCategoryPreview} style={styles.preview} alt=\"preview\" />}\r\n//                 </div>\r\n//               )}\r\n\r\n//               <div style={styles.formGroup}>\r\n//                 <label style={styles.label}>Subcategory</label>\r\n//                 <div style={styles.categoryRow}>\r\n//                   <select name=\"subcategory\" value={form.subcategory} onChange={handleChange} disabled={!subcategories.length} style={styles.select}>\r\n//                     <option value=\"\">Select Subcategory</option>\r\n//                     {subcategories.map((s) => (\r\n//                       <option value={s._id} key={s._id}>\r\n//                         {s.name}\r\n//                       </option>\r\n//                     ))}\r\n//                   </select>\r\n\r\n//                   {form.category && (\r\n//                     <button type=\"button\" style={styles.btnSmall} onClick={() => setAddingSub((v) => !v)}>\r\n//                       {addingSub ? \"Close\" : \"Add\"}\r\n//                     </button>\r\n//                   )}\r\n//                 </div>\r\n//               </div>\r\n\r\n//               {addingSub && (\r\n//                 <div style={styles.addCategoryBox}>\r\n//                   <label style={styles.label}>Add New Subcategory</label>\r\n//                   <div style={styles.categoryRow}>\r\n//                     <input value={newSubName} onChange={(e) => setNewSubName(e.target.value)} placeholder=\"Subcategory name\" style={styles.input} />\r\n//                     <input\r\n//                       type=\"file\"\r\n//                       accept=\"image/*\"\r\n//                       onChange={(e) => {\r\n//                         setNewSubImage(e.target.files[0]);\r\n//                         setNewSubPreview(e.target.files[0] ? URL.createObjectURL(e.target.files[0]) : null);\r\n//                       }}\r\n//                       style={styles.fileInput}\r\n//                     />\r\n//                     <button style={styles.btnPrimary} type=\"button\" onClick={handleCreateSub}>\r\n//                       Create\r\n//                     </button>\r\n//                   </div>\r\n//                   {newSubPreview && <img src={newSubPreview} style={styles.preview} alt=\"preview\" />}\r\n//                 </div>\r\n//               )}\r\n\r\n//               <div style={styles.formGroup}>\r\n//                 <label style={styles.label}>Base Price *</label>\r\n//                 <input type=\"number\" required name=\"basePrice\" value={form.basePrice} onChange={handleChange} style={styles.input} />\r\n//               </div>\r\n\r\n//               <div style={styles.formGroup}>\r\n//                 <label style={styles.label}>Difference</label>\r\n//                 <input type=\"number\" name=\"difference\" value={form.difference} onChange={handleChange} style={styles.input} />\r\n//               </div>\r\n\r\n//               <div style={styles.formGroup}>\r\n//                 <label style={styles.label}>Valid Till</label>\r\n//                 <input type=\"date\" name=\"validTill\" value={form.validTill} onChange={handleChange} style={styles.input} />\r\n//               </div>\r\n\r\n//               <div style={styles.formGroup}>\r\n//                 <label style={styles.label}>Image</label>\r\n//                 <input type=\"file\" accept=\"image/*\" onChange={handleChange} style={styles.fileInput} />\r\n//               </div>\r\n//             </div>\r\n\r\n//             <div style={styles.formGroup}>\r\n//               <label style={styles.label}>Description</label>\r\n//               <textarea name=\"description\" value={form.description} onChange={handleChange} style={styles.textarea}></textarea>\r\n//             </div>\r\n\r\n//             <div style={styles.formActions}>\r\n//               <button style={styles.btnPrimary} disabled={loading}>\r\n//                 {loading ? \"Saving...\" : \"Add Product\"}\r\n//               </button>\r\n//             </div>\r\n//           </form>\r\n//         </div>\r\n//       )}\r\n\r\n//       {/* CSV CONTROLS */}\r\n//       {/* <div style={styles.csvControls}>\r\n//         <div>\r\n//           <input type=\"file\" accept=\".csv\" ref={csvInputRef} onChange={handleCsvSelect} style={styles.fileInput} />\r\n//           <button style={styles.btnSmall} onClick={handleImportCsv}>\r\n//             Import CSV\r\n//           </button>\r\n//         </div>\r\n\r\n//         <div style={{ display: \"flex\", gap: 8 }}>\r\n//           <button style={styles.btnPrimary} onClick={handleExportCsv}>\r\n//             Export All CSV\r\n//           </button>\r\n\r\n//           <button style={styles.btnSmall} onClick={handleExportSelectedCsv}>\r\n//             Export Selected CSV\r\n//           </button>\r\n//         </div>\r\n//       </div> */}\r\n// <div className=\"csv-topbar\">\r\n//   <div className=\"csv-row\">\r\n//     <input\r\n//       type=\"file\"\r\n//       accept=\".csv\"\r\n//       ref={csvInputRef}\r\n//       onChange={handleCsvSelect}\r\n//       style={styles.fileInput}\r\n//     />\r\n\r\n//     <button style={styles.btnSmall} onClick={handleImportCsv}>\r\n//       Import\r\n//     </button>\r\n\r\n//     <button style={styles.btnPrimary} onClick={handleExportCsv}>\r\n//       Export All\r\n//     </button>\r\n\r\n//     <button style={styles.btnSmall} onClick={handleExportSelectedCsv}>\r\n//        Selected \r\n//     </button>\r\n//   </div>\r\n// </div>\r\n\r\n//       {/* TABLE */}\r\n//       <div style={styles.tableCard}>\r\n//         <div style={styles.tableHeader}>\r\n//           <h2 style={styles.tableTitle}> Items</h2>\r\n//           <span style={styles.totalCount}>Total: {filteredItems.length}</span>\r\n//         </div>\r\n\r\n//         <div style={styles.tableWrapper}>\r\n//           <table style={styles.table}>\r\n//             <thead>\r\n//               <tr>\r\n//                 <th style={styles.th}>\r\n//                   <input\r\n//                     type=\"checkbox\"\r\n//                     checked={selectedItems.length === filteredItems.length && filteredItems.length > 0}\r\n//                     onChange={() => {\r\n//                       if (selectedItems.length === filteredItems.length) setSelectedItems([]);\r\n//                       else setSelectedItems(filteredItems.map((x) => x._id));\r\n//                     }}\r\n//                   />\r\n//                 </th>\r\n//                 <th style={styles.th}>Sr</th>\r\n//                 <th style={styles.th}>Image</th>\r\n//                 <th style={styles.th}>Name</th>\r\n//                 <th style={styles.th}>Category</th>\r\n//                 <th style={styles.th}>Subcategory</th>\r\n//                 <th style={styles.th}>Base</th>\r\n//                 <th style={styles.th}>Diff</th>\r\n//                 <th style={styles.th}>Final</th>\r\n//                 <th style={styles.th}>Status</th>\r\n//                 <th style={styles.th}>Valid Till</th>\r\n//                 <th style={styles.th}>Actions</th>\r\n//               </tr>\r\n//             </thead>\r\n\r\n//             <tbody>\r\n//               {currentItems.map((item, i) => (\r\n//                 <tr key={item._id} style={styles.tr}>\r\n//                   <td style={styles.td}>\r\n//                     <input\r\n//                       type=\"checkbox\"\r\n//                       checked={selectedItems.includes(item._id)}\r\n//                       onChange={() =>\r\n//                         setSelectedItems((prev) => (prev.includes(item._id) ? prev.filter((x) => x !== item._id) : [...prev, item._id]))\r\n//                       }\r\n//                     />\r\n//                   </td>\r\n\r\n//                   <td style={styles.td}>{(currentPage - 1) * itemsPerPage + (i + 1)}</td>\r\n\r\n//                   <td style={styles.td}>{item.image ? <img src={item.image} style={styles.tableImg} alt=\"\" /> : \"No Img\"}</td>\r\n\r\n//                   <td style={styles.td}>{item.name}</td>\r\n//                   <td style={styles.td}>{item.category?.name || \"-\"}</td>\r\n//                   <td style={styles.td}>{item.subcategory?.name || \"-\"}</td>\r\n\r\n//                   <td style={styles.td}>‚Çπ{item.basePrice}</td>\r\n//                   <td style={styles.td}>{item.difference || 0}</td>\r\n//                   <td style={styles.td}>‚Çπ{Number(item.basePrice) + Number(item.difference || 0)}</td>\r\n\r\n                  \r\n\r\n//                   <td style={styles.td}>\r\n//                     <button\r\n//                       style={item.status === \"active\" ? styles.statusActive : styles.statusInactive}\r\n//                       onClick={() => handleStatusToggle(item)}\r\n//                     >\r\n//                       {item.status === \"active\" ? \"Active\" : \"Inactive\"}\r\n//                     </button>\r\n//                   </td>\r\n\r\n//                   <td style={styles.td}>{item.validTill ? new Date(item.validTill).toLocaleDateString() : \"-\"}</td>\r\n\r\n//                   <td style={styles.td}>\r\n//                     <div style={{ position: \"relative\" }}>\r\n//                       <button\r\n//                         style={styles.menuButton}\r\n//                         onClick={() => setActiveMenu(activeMenu === item._id ? null : item._id)}\r\n//                       >\r\n//                         ‚ãÆ\r\n//                       </button>\r\n\r\n//                       {activeMenu === item._id && (\r\n//                         <div style={styles.dropdown}>\r\n//                           <button style={styles.dropdownItem} onClick={() => handleEdit(item)}>\r\n//                             ‚úè Edit\r\n//                           </button>\r\n//                           <button style={styles.dropdownItem} onClick={() => handleCopyToEdit(item)}>\r\n//                             üìÑ Copy\r\n//                           </button>\r\n//                           <button style={styles.dropdownItemDelete} onClick={() => handleDelete(item._id)}>\r\n//                             üóë Delete\r\n//                           </button>\r\n//                         </div>\r\n//                       )}\r\n//                     </div>\r\n//                   </td>\r\n//                 </tr>\r\n//               ))}\r\n//             </tbody>\r\n//           </table>\r\n//         </div>\r\n\r\n//         {/* PAGINATION */}\r\n//         <div style={styles.pagination}>\r\n//           <button style={styles.paginationBtn} disabled={currentPage === 1} onClick={() => setCurrentPage((p) => p - 1)}>\r\n//             Previous\r\n//           </button>\r\n\r\n//           {Array.from({ length: totalPages }, (_, i) => (\r\n//             <button\r\n//               key={i}\r\n//               style={i + 1 === currentPage ? styles.paginationBtnActive : styles.paginationBtn}\r\n//               onClick={() => setCurrentPage(i + 1)}\r\n//             >\r\n//               {i + 1}\r\n//             </button>\r\n//           ))}\r\n\r\n//           <button style={styles.paginationBtn} disabled={currentPage === totalPages} onClick={() => setCurrentPage((p) => p + 1)}>\r\n//             Next\r\n//           </button>\r\n//         </div>\r\n//       </div>\r\n\r\n//       {/* MODAL FOR EDIT/COPY */}\r\n//       {showModal && (\r\n//         <div style={styles.modalOverlay} onClick={() => setShowModal(false)}>\r\n//           <div style={styles.modal} onClick={(e) => e.stopPropagation()}>\r\n//             <h2 style={styles.modalTitle}>{isCopyMode ? \" Copy Product\" : \" Edit Product\"}</h2>\r\n\r\n//             <form onSubmit={handleSubmit}>\r\n//               <div style={styles.formGrid}>\r\n//                 <div style={styles.formGroup}>\r\n//                   <label style={styles.label}>Product Name *</label>\r\n//                   <input required name=\"name\" value={form.name} onChange={handleChange} style={styles.input} />\r\n//                 </div>\r\n\r\n//                 <div style={styles.formGroup}>\r\n//                   <label style={styles.label}>Category *</label>\r\n//                   <select\r\n//                     required\r\n//                     name=\"category\"\r\n//                     value={form.category}\r\n//                     onChange={(e) => {\r\n//                       handleChange(e);\r\n//                       setForm((p) => ({ ...p, subcategory: \"\" }));\r\n//                     }}\r\n//                     style={styles.select}\r\n//                   >\r\n//                     <option value=\"\">Select Category</option>\r\n//                     {categories.map((c) => (\r\n//                       <option value={c._id} key={c._id}>\r\n//                         {c.name}\r\n//                       </option>\r\n//                     ))}\r\n//                   </select>\r\n//                 </div>\r\n\r\n//                 <div style={styles.formGroup}>\r\n//                   <label style={styles.label}>Subcategory</label>\r\n//                   <select name=\"subcategory\" value={form.subcategory} onChange={handleChange} disabled={!subcategories.length} style={styles.select}>\r\n//                     <option value=\"\">Select Subcategory</option>\r\n//                     {subcategories.map((s) => (\r\n//                       <option value={s._id} key={s._id}>\r\n//                         {s.name}\r\n//                       </option>\r\n//                     ))}\r\n//                   </select>\r\n//                 </div>\r\n\r\n//                 <div style={styles.formGroup}>\r\n//                   <label style={styles.label}>Base Price *</label>\r\n//                   <input type=\"number\" required name=\"basePrice\" value={form.basePrice} onChange={handleChange} style={styles.input} />\r\n//                 </div>\r\n\r\n//                 <div style={styles.formGroup}>\r\n//                   <label style={styles.label}>Difference</label>\r\n//                   <input type=\"number\" name=\"difference\" value={form.difference} onChange={handleChange} style={styles.input} />\r\n//                 </div>\r\n\r\n//                 <div style={styles.formGroup}>\r\n//                   <label style={styles.label}>Valid Till</label>\r\n//                   <input type=\"date\" name=\"validTill\" value={form.validTill} onChange={handleChange} style={styles.input} />\r\n//                 </div>\r\n\r\n//                 <div style={styles.formGroup}>\r\n//                   <label style={styles.label}>Image</label>\r\n//                   <input type=\"file\" accept=\"image/*\" onChange={handleChange} style={styles.fileInput} />\r\n//                 </div>\r\n//               </div>\r\n\r\n//               <div style={styles.formGroup}>\r\n//                 <label style={styles.label}>Description</label>\r\n//                 <textarea name=\"description\" value={form.description} onChange={handleChange} style={styles.textarea}></textarea>\r\n//               </div>\r\n\r\n//               <div style={styles.formActions}>\r\n//                 <button style={styles.btnPrimary} disabled={loading}>\r\n//                   {loading ? \"Saving...\" : isCopyMode ? \"Save Copy\" : \"Update\"}\r\n//                 </button>\r\n\r\n//                 <button\r\n//                   type=\"button\"\r\n//                   style={styles.btnCancel}\r\n//                   onClick={() => {\r\n//                     setShowModal(false);\r\n//                     setEditId(null);\r\n//                     setIsCopyMode(false);\r\n//                     setForm({\r\n//                       name: \"\",\r\n//                       category: \"\",\r\n//                       subcategory: \"\",\r\n//                       description: \"\",\r\n//                       basePrice: \"\",\r\n//                       difference: \"\",\r\n//                       validTill: \"\",\r\n//                       file: null,\r\n//                     });\r\n//                   }}\r\n//                 >\r\n//                   Cancel\r\n//                 </button>\r\n//               </div>\r\n//             </form>\r\n//           </div>\r\n//         </div>\r\n//       )}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// const styles = {\r\n//   container: {\r\n\r\n//   },\r\n//   header: {\r\n  \r\n//   },\r\n//   title: {\r\n//     fontSize: \"21px\",\r\n//     fontWeight: \"700\",\r\n//     color: \"#0d3b66\",\r\n//     marginBottom: \"6px\",\r\n//   },\r\n//   subtitle: {\r\n//    fontSize: \"16px\",\r\n//   },\r\n//   searchBar: {\r\n//     maxWidth: \"320px\",\r\n//     margin: \"0 auto 25px auto\",\r\n//   },\r\n//   searchInput: {\r\n//     width: \"100%\",\r\n//     padding: \"12px 15px\",\r\n//     borderRadius: \"12px\",\r\n//     border: \"1px solid #ced4da\",\r\n//     background: \"#f9fbfc\",\r\n//     fontSize: \"15px\",\r\n//     outline: \"none\",\r\n//     boxShadow: \"0 2px 6px rgba(0, 0, 0, 0.06)\",\r\n//   },\r\n//   addButtonWrapper: {\r\n//     textAlign: \"left\",\r\n//     marginBottom: \"25px\",\r\n//   },\r\n//   addButton: {\r\n//     background: \"#007bff\",\r\n//     color: \"#fff\",\r\n//     border: \"none\",\r\n//     borderRadius: \"12px\",\r\n//     padding: \"12px 24px\",\r\n//     fontSize: \"16px\",\r\n//     fontWeight: \"600\",\r\n//     cursor: \"pointer\",\r\n//     transition: \"0.25s ease\",\r\n//   },\r\n//   bulkBar: {\r\n//     background: \"#e9f2ff\",\r\n//     border: \"1px solid #c4d9ff\",\r\n//     borderRadius: \"14px\",\r\n//     padding: \"15px 18px\",\r\n//     marginBottom: \"25px\",\r\n//     display: \"flex\",\r\n//     justifyContent: \"space-between\",\r\n//     alignItems: \"center\",\r\n//     flexWrap: \"wrap\",\r\n//     gap: \"14px\",\r\n//     boxShadow: \"0 3px 10px rgba(0, 80, 160, 0.1)\",\r\n//   },\r\n//   bulkText: {\r\n//     fontSize: \"15px\",\r\n//     fontWeight: \"600\",\r\n//     color: \"#0d3b66\",\r\n//   },\r\n//   bulkPanel: {\r\n//     width: \"100%\",\r\n//     background: \"#f7faff\",\r\n//     border: \"1px solid #cfe2ff\",\r\n//     padding: \"20px\",\r\n//     borderRadius: \"14px\",\r\n//     marginTop: \"10px\",\r\n//     boxShadow: \"0 4px 14px rgba(0, 60, 120, 0.08)\",\r\n//   },\r\n//   bulkPanelTitle: {\r\n//     textAlign: \"center\",\r\n//     fontSize: \"18px\",\r\n//     fontWeight: \"700\",\r\n//     marginBottom: \"15px\",\r\n//   },\r\n//   bulkItemBox: {\r\n//     background: \"#ffffff\",\r\n//     border: \"1px solid #dbe5f5\",\r\n//     padding: \"18px\",\r\n//     borderRadius: \"12px\",\r\n//     marginBottom: \"16px\",\r\n//     boxShadow: \"0 2px 10px rgba(0, 0, 50, 0.05)\",\r\n//   },\r\n//   bulkItemTitle: {\r\n//     fontSize: \"16px\",\r\n//     fontWeight: \"600\",\r\n//     marginBottom: \"12px\",\r\n//     color: \"#0d3b66\",\r\n//     borderLeft: \"4px solid #007bff\",\r\n//     paddingLeft: \"10px\",\r\n//   },\r\n//   formCard: {\r\n//     borderRadius: \"16px\",\r\n//     padding: \"25px\",\r\n//     marginBottom: \"28px\",\r\n//     background: \"#ffffff\",\r\n//     boxShadow: \"0 4px 16px rgba(0, 0, 0, 0.08)\",\r\n//     border: \"1px solid #eef2f7\",\r\n//   },\r\n//   formTitle: {\r\n//     fontSize: \"21px\",\r\n//     fontWeight: \"700\",\r\n//     color: \"#0d3b66\",\r\n//     marginBottom: \"15px\",\r\n//   },\r\n//   formGrid: {\r\n//     display: \"grid\",\r\n//     gridTemplateColumns: \"repeat(auto-fit, minmax(230px, 1fr))\",\r\n//     gap: \"18px\",\r\n//   },\r\n//   formGroup: {\r\n//     display: \"flex\",\r\n//     flexDirection: \"column\",\r\n//     gap: \"6px\",\r\n//   },\r\n//   label: {\r\n//     fontWeight: \"600\",\r\n//     fontSize: \"14px\",\r\n//     color: \"#233142\",\r\n//   },\r\n//   input: {\r\n//     padding: \"10px\",\r\n//     borderRadius: \"10px\",\r\n//     border: \"1px solid #cfd6e0\",\r\n//     background: \"#f8fafc\",\r\n//     transition: \"0.2s ease\",\r\n//     fontSize: \"14px\",\r\n//   },\r\n//   select: {\r\n//     padding: \"10px\",\r\n//     borderRadius: \"10px\",\r\n//     border: \"1px solid #cfd6e0\",\r\n//     background: \"#f8fafc\",\r\n//     transition: \"0.2s ease\",\r\n//     fontSize: \"14px\",\r\n//   },\r\n//   textarea: {\r\n//     padding: \"10px\",\r\n//     borderRadius: \"10px\",\r\n//     border: \"1px solid #cfd6e0\",\r\n//     background: \"#f8fafc\",\r\n//     transition: \"0.2s ease\",\r\n//     resize: \"none\",\r\n//     minHeight: \"80px\",\r\n//     fontSize: \"14px\",\r\n//   },\r\n//   fileInput: {\r\n//     padding: \"8px\",\r\n//     fontSize: \"13px\",\r\n//   },\r\n//   categoryRow: {\r\n//     display: \"flex\",\r\n//     gap: \"10px\",\r\n//     alignItems: \"center\",\r\n//   },\r\n//   addCategoryBox: {\r\n//     gridColumn: \"1 / -1\",\r\n//     background: \"#f1f7ff\",\r\n//     border: \"1px solid #cfe1ff\",\r\n//     padding: \"16px\",\r\n//     borderRadius: \"12px\",\r\n//   },\r\n//   preview: {\r\n//     width: \"110px\",\r\n//     height: \"110px\",\r\n//     borderRadius: \"12px\",\r\n//     marginTop: \"10px\",\r\n//     objectFit: \"cover\",\r\n//     border: \"1px solid #b7c9e2\",\r\n//   },\r\n//   formActions: {\r\n//     marginTop: \"15px\",\r\n//     display: \"flex\",\r\n//     gap: \"12px\",\r\n//     flexWrap: \"wrap\",\r\n//   },\r\n//   btnPrimary: {\r\n//     background: \"#007bff\",\r\n//     color: \"#fff\",\r\n//     border: \"none\",\r\n//     borderRadius: \"10px\",\r\n//     padding: \"9px 16px\",\r\n\r\n//     cursor: \"pointer\",\r\n//     transition: \"0.25s ease\",\r\n//   },\r\n//   btnSmall: {\r\n//     background: \"#43a047\",\r\n//     color: \"#fff\",\r\n//     border: \"none\",\r\n//     borderRadius: \"10px\",\r\n//     padding: \"9px 16px\",\r\n//     fontWeight: \"600\",\r\n//     cursor: \"pointer\",\r\n//     transition: \"0.25s ease\",\r\n//   },\r\n//   btnDelete: {\r\n//     background: \"#e63946\",\r\n//     color: \"#fff\",\r\n//     border: \"none\",\r\n//     borderRadius: \"10px\",\r\n//     padding: \"9px 16px\",\r\n//     fontWeight: \"600\",\r\n//     cursor: \"pointer\",\r\n//     transition: \"0.25s ease\",\r\n//   },\r\n//   btnCancel: {\r\n//     background: \"#adb5bd\",\r\n//     color: \"#fff\",\r\n//     border: \"none\",\r\n//     borderRadius: \"10px\",\r\n//     padding: \"9px 16px\",\r\n//     fontWeight: \"600\",\r\n//     cursor: \"pointer\",\r\n//     transition: \"0.25s ease\",\r\n//   },\r\n//   csvControls: {\r\n//     borderRadius: \"12px\",\r\n//     padding: \"16px\",\r\n//     background: \"#f7faff\",\r\n//     border: \"1px solid #d8e6ff\",\r\n//     display: \"flex\",\r\n//     alignItems: \"center\",\r\n//     justifyContent: \"space-between\",\r\n//     marginBottom: \"28px\",\r\n//     flexWrap: \"wrap\",\r\n//     gap: \"12px\",\r\n//   },\r\n//   tableCard: {\r\n\r\n\r\n\r\n\r\n//   },\r\n//   tableHeader: {\r\n//     display: \"flex\",\r\n//     justifyContent: \"space-between\",\r\n//     marginBottom: \"15px\",\r\n//   },\r\n//   tableTitle: {\r\n//     fontSize: \"21px\",\r\n//     fontWeight: \"700\",\r\n//     color: \"#0d3b66\",\r\n//   },\r\n//   totalCount: {\r\n//     fontSize: \"15px\",\r\n//     color: \"#6c757d\",\r\n//     fontWeight: \"600\",\r\n//   },\r\n//   tableWrapper: {\r\n//     overflowX: \"auto\",\r\n//   },\r\n//   table: {\r\n//     width: \"100%\",\r\n//     borderCollapse: \"collapse\",\r\n//     fontSize: \"14px\",\r\n//   },\r\n//   th: {\r\n//     background: \"#e9f2ff\",\r\n//     padding: \"12px\",\r\n//     fontWeight: \"700\",\r\n//     color: \"#0d3b66\",\r\n//     textAlign: \"left\",\r\n//     whiteSpace: \"nowrap\",\r\n//   },\r\n//   tr: {\r\n//     borderBottom: \"1px solid #edf2f7\",\r\n//   },\r\n//   td: {\r\n//     padding: \"12px 10px\",\r\n//     whiteSpace: \"nowrap\",\r\n//   },\r\n//   tableImg: {\r\n//     width: \"55px\",\r\n//     height: \"55px\",\r\n//     borderRadius: \"8px\",\r\n//     objectFit: \"cover\",\r\n//     border: \"1px solid #cfd9e5\",\r\n//   },\r\n//   statusActive: {\r\n//     background: \"#93d8ba\",\r\n//     padding: \"7px 12px\",\r\n//     borderRadius: \"8px\",\r\n//     color: \"black\",\r\n//     fontWeight: \"600\",\r\n//     border: \"none\",\r\n//     cursor: \"pointer\",\r\n//   },\r\n//   statusInactive: {\r\n//     background: \"#d9b1b1\",\r\n//     padding: \"7px 12px\",\r\n//     borderRadius: \"8px\",\r\n//     color: \"black\",\r\n//     fontWeight: \"600\",\r\n//     border: \"none\",\r\n//     cursor: \"pointer\",\r\n//   },\r\n//   menuButton: {\r\n//     background: \"#f0f0f0\",\r\n//     border: \"none\",\r\n//     borderRadius: \"6px\",\r\n//     padding: \"6px 12px\",\r\n//     fontSize: \"20px\",\r\n//     fontWeight: \"bold\",\r\n//     cursor: \"pointer\",\r\n//     transition: \"0.2s ease\",\r\n//   },\r\n//   dropdown: {\r\n//     position: \"absolute\",\r\n//     right: \"0\",\r\n//     top: \"35px\",\r\n//     background: \"#fff\",\r\n//     border: \"1px solid #ddd\",\r\n//     borderRadius: \"8px\",\r\n//     boxShadow: \"0 4px 12px rgba(0,0,0,0.15)\",\r\n//     zIndex: \"100\",\r\n//     minWidth: \"140px\",\r\n//   },\r\n//   dropdownItem: {\r\n//     display: \"block\",\r\n//     width: \"100%\",\r\n//     padding: \"10px 15px\",\r\n//     background: \"transparent\",\r\n//     border: \"none\",\r\n//     textAlign: \"left\",\r\n//     cursor: \"pointer\",\r\n//     fontSize: \"14px\",\r\n//     fontWeight: \"500\",\r\n//     transition: \"0.2s ease\",\r\n//     borderBottom: \"1px solid #f0f0f0\",\r\n//   },\r\n//   dropdownItemDelete: {\r\n//     display: \"block\",\r\n//     width: \"100%\",\r\n//     padding: \"10px 15px\",\r\n//     background: \"transparent\",\r\n//     border: \"none\",\r\n//     textAlign: \"left\",\r\n//     cursor: \"pointer\",\r\n//     fontSize: \"14px\",\r\n//     fontWeight: \"500\",\r\n//     color: \"#e63946\",\r\n//     transition: \"0.2s ease\",\r\n//   },\r\n//   pagination: {\r\n//     marginTop: \"18px\",\r\n//     display: \"flex\",\r\n//     justifyContent: \"center\",\r\n//     gap: \"10px\",\r\n//     flexWrap: \"wrap\",\r\n//   },\r\n//   paginationBtn: {\r\n//     padding: \"9px 13px\",\r\n//     borderRadius: \"8px\",\r\n//     background: \"#fff\",\r\n//     border: \"1px solid #ddd\",\r\n//     cursor: \"pointer\",\r\n//     fontSize: \"14px\",\r\n//   },\r\n//   paginationBtnActive: {\r\n//     padding: \"9px 13px\",\r\n//     borderRadius: \"8px\",\r\n//     background: \"#007bff\",\r\n//     color: \"white\",\r\n//     border: \"1px solid #0062cc\",\r\n//     cursor: \"pointer\",\r\n//     fontSize: \"14px\",\r\n//   },\r\n//   modalOverlay: {\r\n//     position: \"fixed\",\r\n//     top: 0,\r\n//     left: 0,\r\n//     right: 0,\r\n//     bottom: 0,\r\n//     background: \"rgba(0, 0, 0, 0.5)\",\r\n//     display: \"flex\",\r\n//     justifyContent: \"center\",\r\n//     alignItems: \"center\",\r\n//     zIndex: \"1000\",\r\n//     padding: \"20px\",\r\n//   },\r\n//   modal: {\r\n//     background: \"#fff\",\r\n//     borderRadius: \"16px\",\r\n//     padding: \"30px\",\r\n//     maxWidth: \"700px\",\r\n//     width: \"100%\",\r\n//     maxHeight: \"90vh\",\r\n//     overflowY: \"auto\",\r\n//     boxShadow: \"0 10px 40px rgba(0, 0, 0, 0.3)\",\r\n//   },\r\n//   modalTitle: {\r\n//     fontSize: \"22px\",\r\n//     fontWeight: \"700\",\r\n//     color: \"#0d3b66\",\r\n//     marginBottom: \"20px\",\r\n//     textAlign: \"center\",\r\n//   },\r\n  \r\n  \r\n// }\r\nimport React, { useEffect, useState, useRef } from \"react\";\r\nimport axios from \"axios\";\r\nimport \"./PriceList.css\";\r\n\r\n// API endpoints ‚Äî keep as-is or replace with your env vars\r\nconst API_URL = process.env.REACT_APP_API_URL_PRICES || \"https://grocerrybackend.vercel.app/api/prices\";\r\nconst CATEGORY_URL = process.env.REACT_APP_API_URL_CATEGORIES || \"https://grocerrybackend.vercel.app/api/categories\";\r\n\r\nexport default function PriceList() {\r\n  // data\r\n  const [items, setItems] = useState([]);\r\n  const [categories, setCategories] = useState([]);\r\n  const [subcategories, setSubcategories] = useState([]);\r\n\r\n  // ui\r\n  const [loading, setLoading] = useState(false);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\r\n\r\n  // form / modal\r\n  const [form, setForm] = useState({\r\n    name: \"\",\r\n    category: \"\",\r\n    subcategory: \"\",\r\n    description: \"\",\r\n    basePrice: \"\",\r\n    difference: \"\", // used only on create ‚Äî diff updates should use diff endpoint\r\n    validTill: \"\",\r\n    file: null,\r\n  });\r\n\r\n  const [editId, setEditId] = useState(null); // if set => edit mode\r\n  const [isCopyMode, setIsCopyMode] = useState(false);\r\n  const [showForm, setShowForm] = useState(false); // inline add form\r\n  const [showModal, setShowModal] = useState(false); // edit/copy modal\r\n  const [activeMenu, setActiveMenu] = useState(null);\r\n\r\n  // bulk/select\r\n  const [selectedItems, setSelectedItems] = useState([]);\r\n  const [bulkMode, setBulkMode] = useState(false);\r\n\r\n  // CSV\r\n  const [csvFile, setCsvFile] = useState(null);\r\n  const csvInputRef = useRef();\r\n\r\n  // pagination\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const itemsPerPage = 30;\r\n\r\n  // filters\r\n  const [filterCategory, setFilterCategory] = useState(\"\");\r\n  const [filterSubcategory, setFilterSubcategory] = useState(\"\");\r\n  const [filterSubs, setFilterSubs] = useState([]);\r\n\r\n  useEffect(() => {\r\n    // load categories first\r\n    fetchCategories();\r\n\r\n    // resize listener\r\n    const onResize = () => setIsMobile(window.innerWidth < 768);\r\n    window.addEventListener(\"resize\", onResize);\r\n    return () => window.removeEventListener(\"resize\", onResize);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // once categories loaded, fetch items\r\n    if (categories.length > 0) fetchItems();\r\n  }, [categories]);\r\n\r\n  useEffect(() => {\r\n    if (!filterCategory) {\r\n      setFilterSubs([]);\r\n      setFilterSubcategory(\"\");\r\n      return;\r\n    }\r\n    const cat = categories.find((c) => c._id === filterCategory);\r\n    setFilterSubs(cat?.subcategories || []);\r\n    setFilterSubcategory(\"\");\r\n  }, [filterCategory, categories]);\r\n\r\n  // keep form.subcategories updated when form.category changes\r\n  useEffect(() => {\r\n    if (!form.category) {\r\n      setSubcategories([]);\r\n      setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n      return;\r\n    }\r\n    const cat = categories.find((c) => c._id === form.category);\r\n    const subs = cat?.subcategories || [];\r\n    setSubcategories(subs);\r\n\r\n    const exists = subs.some((s) => s._id === form.subcategory);\r\n    if (!exists) setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n  }, [form.category, categories]);\r\n\r\n  /* ----------------------- API Fetchers ----------------------- */\r\n  const fetchCategories = async () => {\r\n    try {\r\n      const res = await axios.get(CATEGORY_URL);\r\n      if (res.data && res.data.success) setCategories(res.data.categories || []);\r\n    } catch (err) {\r\n      console.error(\"fetchCategories error\", err);\r\n      alert(\"Failed to load categories\");\r\n    }\r\n  };\r\n\r\n  const fetchItems = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await axios.get(API_URL);\r\n      if (!(res.data && res.data.success)) return setItems([]);\r\n\r\n      const raw = res.data.data || [];\r\n\r\n      // enrich items with category/subcategory objects when possible\r\n      const enriched = raw.map((item) => {\r\n        const cat = categories.find((c) => c._id === (item.category?._id || item.category));\r\n        const sub = cat?.subcategories?.find((s) => s._id === (item.subcategory?._id || item.subcategory));\r\n\r\n        // compute a friendly final price for UI\r\n        const finalVal = typeof item.currentFinalPrice === \"number\" && !isNaN(item.currentFinalPrice)\r\n          ? item.currentFinalPrice\r\n          : (item.lastFinalPrice ?? item.basePrice ?? 0);\r\n\r\n        return {\r\n          ...item,\r\n          category: cat ? { _id: cat._id, name: cat.name } : item.category,\r\n          subcategory: sub ? { _id: sub._id, name: sub.name } : item.subcategory,\r\n          _uiFinalPrice: finalVal,\r\n        };\r\n      });\r\n\r\n      setItems(enriched);\r\n    } catch (err) {\r\n      console.error(\"fetchItems error\", err);\r\n      alert(\"Failed to load items\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  /* ----------------------- FORM / CRUD ----------------------- */\r\n  const handleChange = (e) => {\r\n    const { name, value, files } = e.target;\r\n    if (files && files.length) return setForm((p) => ({ ...p, file: files[0] }));\r\n    setForm((p) => ({ ...p, [name]: value }));\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    try {\r\n      if (!form.name || !form.category || !form.basePrice) {\r\n        alert(\"Name, category and base price are required\");\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      const fd = new FormData();\r\n      Object.keys(form).forEach((k) => {\r\n        const val = form[k];\r\n        if (val !== undefined && val !== null && val !== \"\") fd.append(k, val);\r\n      });\r\n\r\n      let res;\r\n      if (isCopyMode) {\r\n        res = await axios.post(API_URL, fd);\r\n        alert(\"Copied as new item\");\r\n      } else if (editId) {\r\n        res = await axios.put(`${API_URL}/${editId}`, fd);\r\n        alert(\"Updated\");\r\n      } else {\r\n        // create\r\n        res = await axios.post(API_URL, fd);\r\n        alert(\"Added\");\r\n      }\r\n\r\n      // refresh\r\n      await fetchItems();\r\n      await fetchCategories();\r\n\r\n      // reset form\r\n      setForm({ name: \"\", category: \"\", subcategory: \"\", description: \"\", basePrice: \"\", difference: \"\", validTill: \"\", file: null });\r\n      setEditId(null);\r\n      setIsCopyMode(false);\r\n      setShowModal(false);\r\n      setShowForm(false);\r\n\r\n    } catch (err) {\r\n      console.error(\"save error\", err);\r\n      alert(\"Save failed\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleEdit = (item) => {\r\n    setForm({\r\n      name: item.name || \"\",\r\n      category: item.category?._id?.toString() || item.category || \"\",\r\n      subcategory: item.subcategory?._id?.toString() || item.subcategory || \"\",\r\n      description: item.description || \"\",\r\n      basePrice: item.basePrice ?? \"\",\r\n      difference: item.todayDiff ?? \"\",\r\n      validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n      file: null,\r\n    });\r\n\r\n    const cat = categories.find((c) => c._id === (item.category?._id || item.category));\r\n    setSubcategories(cat?.subcategories || []);\r\n\r\n    setEditId(item._id);\r\n    setIsCopyMode(false);\r\n    setShowModal(true);\r\n    setActiveMenu(null);\r\n  };\r\n\r\n  const handleCopyToEdit = (item) => {\r\n    setForm({\r\n      name: item.name || \"\",\r\n      category: item.category?._id?.toString() || item.category || \"\",\r\n      subcategory: item.subcategory?._id?.toString() || item.subcategory || \"\",\r\n      description: item.description || \"\",\r\n      basePrice: item.basePrice ?? \"\",\r\n      difference: item.todayDiff ?? \"\",\r\n      validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n      file: null,\r\n    });\r\n\r\n    const cat = categories.find((c) => c._id === (item.category?._id || item.category));\r\n    setSubcategories(cat?.subcategories || []);\r\n\r\n    setEditId(null);\r\n    setIsCopyMode(true);\r\n    setShowModal(true);\r\n    setActiveMenu(null);\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    if (!window.confirm(\"Delete item?\")) return;\r\n    try {\r\n      await axios.delete(`${API_URL}/${id}`);\r\n      setItems((prev) => prev.filter((x) => x._id !== id));\r\n      setSelectedItems((prev) => prev.filter((x) => x !== id));\r\n      setActiveMenu(null);\r\n    } catch (err) {\r\n      console.error(\"delete error\", err);\r\n      alert(\"Delete failed\");\r\n    }\r\n  };\r\n\r\n  const handleStatusToggle = async (item) => {\r\n    try {\r\n      const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\r\n      await axios.put(`${API_URL}/status/${item._id}`, { status: newStatus });\r\n      setItems((prev) => prev.map((x) => (x._id === item._id ? { ...x, status: newStatus } : x)));\r\n    } catch (err) {\r\n      console.error(\"status toggle error\", err);\r\n      alert(\"Status update failed\");\r\n    }\r\n  };\r\n\r\n  /* ----------------------- DIFF update (MAIN) ----------------------- */\r\n  // This calls the backend endpoint: PUT /diff/:id with { diff }\r\n  const handleDiffUpdate = async (id, diff) => {\r\n    try {\r\n      await axios.put(`${API_URL}/diff/${id}`, { diff: Number(diff || 0) });\r\n      // update local UI by refetching the item(s)\r\n      await fetchItems();\r\n      alert(\"Difference applied\");\r\n    } catch (err) {\r\n      console.error(\"Diff update error\", err);\r\n      alert(\"Failed to update difference\");\r\n    }\r\n  };\r\n\r\n  /* ----------------------- BULK ----------------------- */\r\n  const handleBulkDelete = async () => {\r\n    if (!selectedItems.length) return alert(\"No items selected\");\r\n    if (!window.confirm(\"Delete selected items?\")) return;\r\n    try {\r\n      await Promise.all(selectedItems.map((id) => axios.delete(`${API_URL}/${id}`)));\r\n      setSelectedItems([]);\r\n      fetchItems();\r\n      setBulkMode(false);\r\n    } catch (err) {\r\n      console.error(\"bulk delete error\", err);\r\n      alert(\"Bulk delete failed\");\r\n    }\r\n  };\r\n\r\n  const updateLocalItemField = (id, key, value) => {\r\n    setItems((prev) => prev.map((x) => (x._id === id ? { ...x, [key]: value } : x)));\r\n  };\r\n\r\n  const handleBulkSave = async () => {\r\n    if (!selectedItems.length) return alert(\"No items selected for bulk save\");\r\n    const updates = items\r\n      .filter((x) => selectedItems.includes(x._id))\r\n      .map((x) => ({ id: x._id, name: x.name, basePrice: x.basePrice, difference: x.difference, validTill: x.validTill }));\r\n    try {\r\n      await axios.post(`${API_URL}/bulk-update`, { products: updates });\r\n      setBulkMode(false);\r\n      setSelectedItems([]);\r\n      fetchItems();\r\n    } catch (err) {\r\n      console.error(\"bulk save error\", err);\r\n      alert(\"Bulk save failed\");\r\n    }\r\n  };\r\n\r\n  /* ----------------------- CSV ----------------------- */\r\n  const handleCsvSelect = (e) => setCsvFile(e.target.files?.[0] || null);\r\n\r\n  const handleImportCsv = async () => {\r\n    if (!csvFile) return alert(\"Select CSV file\");\r\n    try {\r\n      const fd = new FormData();\r\n      fd.append(\"file\", csvFile);\r\n      const res = await axios.post(`${API_URL}/import`, fd);\r\n      if (res.data && res.data.success) {\r\n        alert(`Imported ${res.data.inserted || 0} items`);\r\n        setCsvFile(null);\r\n        if (csvInputRef.current) csvInputRef.current.value = null;\r\n        fetchItems();\r\n      } else alert(\"CSV import failed\");\r\n    } catch (err) {\r\n      console.error(\"csv import error\", err);\r\n      alert(\"CSV import failed\");\r\n    }\r\n  };\r\n\r\n  const handleExportCsv = () => {\r\n    if (!items.length) return alert(\"No items to export\");\r\n    const header = [\"id\",\"name\",\"categoryName\",\"subcategoryName\",\"basePrice\",\"difference\",\"finalPrice\",\"status\",\"validTill\",\"description\",\"imageUrl\"];\r\n    const rows = items.map((p) => [p._id, p.name||\"\", p.category?.name||\"\", p.subcategory?.name||\"\", p.basePrice ?? \"\", p.todayDiff ?? p.difference ?? 0, p._uiFinalPrice ?? p.currentFinalPrice ?? p.lastFinalPrice ?? p.basePrice ?? \"\", p.status||\"\", p.validTill ? new Date(p.validTill).toISOString().split('T')[0] : \"\", p.description||\"\", p.image||\"\"]);\r\n    const csvArray = [header, ...rows];\r\n    const csvContent = \"data:text/csv;charset=utf-8,\" + csvArray.map((r) => r.map((c) => `\"${String(c).replace(/\"/g,'\"\"')}\"`).join(',')).join('\\n');\r\n    const encodedUri = encodeURI(csvContent);\r\n    const link = document.createElement('a');\r\n    link.href = encodedUri;\r\n    link.download = `all_prices_${Date.now()}.csv`;\r\n    link.click();\r\n  };\r\n\r\n  const handleExportSelectedCsv = () => {\r\n    if (!selectedItems.length) return alert(\"Select items to export\");\r\n    const selected = items.filter((x) => selectedItems.includes(x._id));\r\n    const header = [\"id\",\"name\",\"categoryName\",\"subcategoryName\",\"basePrice\",\"difference\",\"finalPrice\",\"status\",\"validTill\",\"description\",\"imageUrl\"];\r\n    const rows = selected.map((p) => [p._id, p.name||\"\", p.category?.name||\"\", p.subcategory?.name||\"\", p.basePrice ?? \"\", p.todayDiff ?? p.difference ?? 0, p._uiFinalPrice ?? p.currentFinalPrice ?? p.lastFinalPrice ?? p.basePrice ?? \"\", p.status||\"\", p.validTill ? new Date(p.validTill).toISOString().split('T')[0] : \"\", p.description||\"\", p.image||\"\"]);\r\n    const csvArray = [header, ...rows];\r\n    const csvContent = \"data:text/csv;charset=utf-8,\" + csvArray.map((r) => r.map((c) => `\"${String(c).replace(/\"/g,'\"\"')}\"`).join(',')).join('\\n');\r\n    const encodedUri = encodeURI(csvContent);\r\n    const link = document.createElement('a');\r\n    link.href = encodedUri;\r\n    link.download = `selected_prices_${Date.now()}.csv`;\r\n    link.click();\r\n  };\r\n\r\n  /* ----------------------- Filtering / Pagination ----------------------- */\r\n  const filteredItems = items.filter((item) => {\r\n    const t = search.trim().toLowerCase();\r\n    const textMatch = !t || (item.name||\"\").toLowerCase().includes(t) || (item.category?.name||\"\").toLowerCase().includes(t) || (item.subcategory?.name||\"\").toLowerCase().includes(t);\r\n    const catMatch = !filterCategory || item.category?._id === filterCategory;\r\n    const subMatch = !filterSubcategory || item.subcategory?._id === filterSubcategory;\r\n    return textMatch && catMatch && subMatch;\r\n  });\r\n\r\n  const indexOfLast = currentPage * itemsPerPage;\r\n  const currentItems = filteredItems.slice(indexOfLast - itemsPerPage, indexOfLast);\r\n  const totalPages = Math.max(1, Math.ceil(filteredItems.length / itemsPerPage));\r\n\r\n  /* ----------------------- Render ----------------------- */\r\n  return (\r\n    <div className=\"price-list-root\" style={{ padding: 14 }}>\r\n      <div className=\"header-row\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 12 }}>\r\n        <div>\r\n          <h2 style={{ margin: 0 }}>Product Management</h2>\r\n          <div style={{ color: '#666', fontSize: 13 }}>{filteredItems.length} items</div>\r\n        </div>\r\n\r\n        <div style={{ display: 'flex', gap: 8, alignItems: 'center' }}>\r\n          <input placeholder=\"Search...\" value={search} onChange={(e) => { setSearch(e.target.value); setCurrentPage(1); }} style={{ padding: 8, borderRadius: 8, border: '1px solid #ddd' }} />\r\n\r\n          <button className=\"btn\" onClick={() => { setShowForm((s) => !s); setEditId(null); setIsCopyMode(false); }}>\r\n            {showForm ? 'Close' : 'Add Product'}\r\n          </button>\r\n\r\n          <button className=\"btn\" onClick={() => fetchItems()} disabled={loading}>{loading ? 'Loading...' : 'Refresh'}</button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* FILTERS */}\r\n      <div style={{ display: 'flex', gap: 8, marginBottom: 12 }}>\r\n        <select value={filterCategory} onChange={(e) => setFilterCategory(e.target.value)}>\r\n          <option value=\"\">All Categories</option>\r\n          {categories.map((c) => <option key={c._id} value={c._id}>{c.name}</option>)}\r\n        </select>\r\n\r\n        <select value={filterSubcategory} onChange={(e) => setFilterSubcategory(e.target.value)} disabled={!filterSubs.length}>\r\n          <option value=\"\">All Subcategories</option>\r\n          {filterSubs.map((s) => <option key={s._id} value={s._id}>{s.name}</option>)}\r\n        </select>\r\n\r\n        <div style={{ marginLeft: 'auto', display: 'flex', gap: 8 }}>\r\n          <input type=\"file\" accept=\".csv\" ref={csvInputRef} onChange={handleCsvSelect} />\r\n          <button className=\"btn\" onClick={handleImportCsv}>Import</button>\r\n          <button className=\"btn\" onClick={handleExportCsv}>Export All</button>\r\n          <button className=\"btn\" onClick={handleExportSelectedCsv}>Export Selected</button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* BULK BAR */}\r\n      {selectedItems.length > 0 && (\r\n        <div className=\"bulk-bar\" style={{ padding: 10, border: '1px solid #eee', marginBottom: 12, borderRadius: 8 }}>\r\n          <div>{selectedItems.length} selected</div>\r\n          <div style={{ marginLeft: 'auto', display: 'flex', gap: 8 }}>\r\n            {!bulkMode ? (\r\n              <>\r\n                <button className=\"btn\" onClick={() => setBulkMode(true)}>Bulk Edit</button>\r\n                <button className=\"btn danger\" onClick={handleBulkDelete}>Bulk Delete</button>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <button className=\"btn\" onClick={handleBulkSave}>Save All</button>\r\n                <button className=\"btn\" onClick={() => setBulkMode(false)}>Cancel</button>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* ADD FORM (inline) */}\r\n      {showForm && (\r\n        <div style={{ padding: 12, border: '1px solid #eee', borderRadius: 8, marginBottom: 16 }}>\r\n          <form onSubmit={handleSubmit}>\r\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(220px,1fr))', gap: 10 }}>\r\n              <div>\r\n                <label>Name *</label>\r\n                <input name=\"name\" value={form.name} onChange={handleChange} />\r\n              </div>\r\n\r\n              <div>\r\n                <label>Category *</label>\r\n                <div style={{ display: 'flex', gap: 8 }}>\r\n                  <select name=\"category\" value={form.category} onChange={(e) => { handleChange(e); setForm((p) => ({ ...p, subcategory: '' })); }}>\r\n                    <option value=\"\">Select</option>\r\n                    {categories.map((c) => <option key={c._id} value={c._id}>{c.name}</option>)}\r\n                  </select>\r\n                  <button type=\"button\" onClick={() => { /* could toggle create category */ }}>Add</button>\r\n                </div>\r\n              </div>\r\n\r\n              <div>\r\n                <label>Subcategory</label>\r\n                <select name=\"subcategory\" value={form.subcategory} onChange={handleChange} disabled={!subcategories.length}>\r\n                  <option value=\"\">Select</option>\r\n                  {subcategories.map((s) => <option key={s._id} value={s._id}>{s.name}</option>)}\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label>Base Price *</label>\r\n                <input name=\"basePrice\" type=\"number\" value={form.basePrice} onChange={handleChange} />\r\n              </div>\r\n\r\n              <div>\r\n                <label>Difference</label>\r\n                <input name=\"difference\" type=\"number\" value={form.difference} onChange={handleChange} />\r\n              </div>\r\n\r\n              <div>\r\n                <label>Valid Till</label>\r\n                <input name=\"validTill\" type=\"date\" value={form.validTill} onChange={handleChange} />\r\n              </div>\r\n\r\n              <div>\r\n                <label>Image</label>\r\n                <input name=\"file\" type=\"file\" accept=\"image/*\" onChange={handleChange} />\r\n              </div>\r\n\r\n              <div style={{ gridColumn: '1/-1' }}>\r\n                <label>Description</label>\r\n                <textarea name=\"description\" value={form.description} onChange={handleChange} />\r\n              </div>\r\n\r\n            </div>\r\n\r\n            <div style={{ marginTop: 10 }}>\r\n              <button className=\"btn\" type=\"submit\" disabled={loading}>{loading ? 'Saving...' : (isCopyMode ? 'Save Copy' : (editId ? 'Update' : 'Add Product'))}</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      )}\r\n\r\n      {/* TABLE */}\r\n      <div style={{ overflowX: 'auto' }}>\r\n        <table style={{ width: '100%', borderCollapse: 'collapse' }}>\r\n          <thead>\r\n            <tr>\r\n              <th><input type=\"checkbox\" checked={selectedItems.length === filteredItems.length && filteredItems.length > 0} onChange={() => { if (selectedItems.length === filteredItems.length) setSelectedItems([]); else setSelectedItems(filteredItems.map(x => x._id)); }} /></th>\r\n              <th>Sr</th>\r\n              <th>Image</th>\r\n              <th>Name</th>\r\n              <th>Category</th>\r\n              <th>Subcategory</th>\r\n              <th>Base</th>\r\n              <th>Diff</th>\r\n              <th>Final</th>\r\n              <th>Status</th>\r\n              <th>Valid Till</th>\r\n              <th>Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {currentItems.map((item, i) => (\r\n              <tr key={item._id}>\r\n                <td><input type=\"checkbox\" checked={selectedItems.includes(item._id)} onChange={() => setSelectedItems((prev) => prev.includes(item._id) ? prev.filter(x => x !== item._id) : [...prev, item._id])} /></td>\r\n                <td>{(currentPage - 1) * itemsPerPage + (i + 1)}</td>\r\n                <td>{item.image ? <img src={item.image} alt=\"\" style={{ width: 50, height: 50, objectFit: 'cover' }} /> : 'No Img'}</td>\r\n                <td>{item.name}</td>\r\n                <td>{item.category?.name || '-'}</td>\r\n                <td>{item.subcategory?.name || '-'}</td>\r\n                <td>‚Çπ{item.basePrice}</td>\r\n                <td>{item.todayDiff ?? item.difference ?? 0}</td>\r\n                <td>‚Çπ{item._uiFinalPrice}</td>\r\n                <td>\r\n                  <button onClick={() => handleStatusToggle(item)} className={item.status === 'active' ? 'status-active' : 'status-inactive'}>{item.status}</button>\r\n                </td>\r\n                <td>{item.validTill ? new Date(item.validTill).toLocaleDateString() : '-'}</td>\r\n                <td>\r\n                  <div style={{ position: 'relative' }}>\r\n                    <button onClick={() => setActiveMenu(activeMenu === item._id ? null : item._id)}>‚ãÆ</button>\r\n                    {activeMenu === item._id && (\r\n                      <div style={{ position: 'absolute', right: 0, top: 24, background: '#fff', border: '1px solid #ddd', borderRadius: 6 }}>\r\n                        <button onClick={() => handleEdit(item)}>Edit</button>\r\n                        <button onClick={() => handleCopyToEdit(item)}>Copy</button>\r\n                        <button onClick={() => handleDelete(item._id)} style={{ color: 'red' }}>Delete</button>\r\n                        <div style={{ padding: 8, borderTop: '1px solid #eee' }}>\r\n                          {/* Quick diff update UI inside dropdown */}\r\n                          <small>Quick diff (applies on yesterday final)</small>\r\n                          <div style={{ display: 'flex', gap: 6, marginTop: 6 }}>\r\n                            <input type=\"number\" placeholder=\"Diff\" value={form._quickDiffFor?.[item._id] ?? ''} onChange={(e) => {\r\n                              // store quick diff in local temporary state within form\r\n                              setForm((prev) => ({ ...prev, _quickDiffFor: { ...(prev._quickDiffFor || {}), [item._id]: e.target.value } }));\r\n                            }} style={{ width: 90 }} />\r\n                            <button onClick={() => handleDiffUpdate(item._id, Number((form._quickDiffFor || {})[item._id] || 0))}>Apply</button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* PAGINATION */}\r\n      <div style={{ display: 'flex', gap: 6, justifyContent: 'center', marginTop: 12 }}>\r\n        <button onClick={() => setCurrentPage((p) => Math.max(1, p - 1))} disabled={currentPage === 1}>Previous</button>\r\n        {Array.from({ length: totalPages }, (_, i) => (\r\n          <button key={i} onClick={() => setCurrentPage(i + 1)} style={i + 1 === currentPage ? { fontWeight: 'bold' } : {}}>{i + 1}</button>\r\n        ))}\r\n        <button onClick={() => setCurrentPage((p) => Math.min(totalPages, p + 1))} disabled={currentPage === totalPages}>Next</button>\r\n      </div>\r\n\r\n      {/* EDIT/COPY MODAL */}\r\n      {showModal && (\r\n        <div className=\"modal-overlay\" onClick={() => setShowModal(false)}>\r\n          <div className=\"modal\" onClick={(e) => e.stopPropagation()}>\r\n            <h3>{isCopyMode ? 'Copy Product' : 'Edit Product'}</h3>\r\n            <form onSubmit={handleSubmit}>\r\n              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit,minmax(220px,1fr))', gap: 8 }}>\r\n                <div>\r\n                  <label>Name</label>\r\n                  <input name=\"name\" value={form.name} onChange={handleChange} />\r\n                </div>\r\n\r\n                <div>\r\n                  <label>Category</label>\r\n                  <select name=\"category\" value={form.category} onChange={(e) => { handleChange(e); setForm((p) => ({ ...p, subcategory: '' })); }}>\r\n                    <option value=\"\">Select</option>\r\n                    {categories.map((c) => <option key={c._id} value={c._id}>{c.name}</option>)}\r\n                  </select>\r\n                </div>\r\n\r\n                <div>\r\n                  <label>Subcategory</label>\r\n                  <select name=\"subcategory\" value={form.subcategory} onChange={handleChange}>\r\n                    <option value=\"\">Select</option>\r\n                    {subcategories.map((s) => <option key={s._id} value={s._id}>{s.name}</option>)}\r\n                  </select>\r\n                </div>\r\n\r\n                <div>\r\n                  <label>Base Price</label>\r\n                  <input name=\"basePrice\" type=\"number\" value={form.basePrice} onChange={handleChange} />\r\n                </div>\r\n\r\n                <div>\r\n                  <label>Difference (for create only)</label>\r\n                  <input name=\"difference\" type=\"number\" value={form.difference} onChange={handleChange} />\r\n                </div>\r\n\r\n                <div>\r\n                  <label>Valid Till</label>\r\n                  <input name=\"validTill\" type=\"date\" value={form.validTill} onChange={handleChange} />\r\n                </div>\r\n\r\n                <div>\r\n                  <label>Image</label>\r\n                  <input name=\"file\" type=\"file\" accept=\"image/*\" onChange={handleChange} />\r\n                </div>\r\n\r\n                <div style={{ gridColumn: '1/-1' }}>\r\n                  <label>Description</label>\r\n                  <textarea name=\"description\" value={form.description} onChange={handleChange} />\r\n                </div>\r\n              </div>\r\n\r\n              <div style={{ marginTop: 10, display: 'flex', gap: 8 }}>\r\n                <button className=\"btn\" type=\"submit\">{isCopyMode ? 'Save Copy' : 'Update'}</button>\r\n                {editId && <button className=\"btn\" type=\"button\" onClick={() => { if (!window.confirm('Apply diff update from form?')) return; handleDiffUpdate(editId, Number(form.difference || 0)); }}>Apply Diff</button>}\r\n                <button className=\"btn\" type=\"button\" onClick={() => { setShowModal(false); setEditId(null); setIsCopyMode(false); setForm({ name: '', category: '', subcategory: '', description: '', basePrice: '', difference: '', validTill: '', file: null }); }}>Cancel</button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":";;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;A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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}