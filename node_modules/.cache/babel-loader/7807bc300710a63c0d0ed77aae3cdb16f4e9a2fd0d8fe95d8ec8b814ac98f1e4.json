{"ast":null,"code":"// // import React, { useEffect, useState } from \"react\";\n// // import axios from \"axios\";\n// // import {\n// //   Chart as ChartJS,\n// //   CategoryScale,\n// //   LinearScale,\n// //   PointElement,\n// //   LineElement,\n// //   Title,\n// //   Tooltip,\n// //   Legend,\n// // } from \"chart.js\";\n// // import { Line } from \"react-chartjs-2\";\n// // import \"./PriceAnalytics.css\";\n// // ChartJS.register(\n// //   CategoryScale,\n// //   LinearScale,\n// //   PointElement,\n// //   LineElement,\n// //   Title,\n// //   Tooltip,\n// //   Legend\n// // );\n// // const API_BASE = \"https://grocerrybackend.vercel.app/api\";\n// // const PriceAnalytics = () => {\n// //   const [loading, setLoading] = useState(true);\n// //   const [productList, setProductList] = useState([]);\n// //   const [categoryList, setCategoryList] = useState([]);\n// //   const [selectedProduct, setSelectedProduct] = useState(\"\");\n// //   const [selectedCategory, setSelectedCategory] = useState(\"\");\n// //   const [startDate, setStartDate] = useState(\"\");\n// //   const [endDate, setEndDate] = useState(\"\");\n// //   const [chartData, setChartData] = useState(null);\n// //   // üîπ Fetch dropdowns\n// //   useEffect(() => {\n// //     const fetchDropdowns = async () => {\n// //       try {\n// //         const [products, categories] = await Promise.all([\n// //           axios.get(`${API_BASE}/prices`),\n// //           axios.get(`${API_BASE}/categories`),\n// //         ]);\n// //         setProductList(products.data.data || []);\n// //         setCategoryList(categories.data.categories || []);\n// //       } catch (err) {\n// //         console.error(\"Dropdown fetch error:\", err);\n// //       }\n// //     };\n// //     fetchDropdowns();\n// //   }, []);\n// //   // üîπ Fetch chart data with date filter\n// //   const fetchChart = async () => {\n// //     setLoading(true);\n// //     try {\n// //       const res = await axios.get(`${API_BASE}/prices`);\n// //       const allPrices = res.data.data || [];\n// //       // ‚úÖ Filter by Product / Category\n// //       let filtered = allPrices;\n// //       if (selectedProduct)\n// //         filtered = filtered.filter((p) => p.name === selectedProduct);\n// //       if (selectedCategory)\n// //         filtered = filtered.filter(\n// //           (p) => p.category?.name === selectedCategory\n// //         );\n// //       // ‚úÖ Filter by Date Range\n// //       if (startDate && endDate) {\n// //         const start = new Date(startDate);\n// //         const end = new Date(endDate);\n// //         filtered = filtered.filter((item) => {\n// //           const date = new Date(item.validTill || item.createdAt);\n// //           return date >= start && date <= end;\n// //         });\n// //       }\n// //       // ‚úÖ Group by Date\n// //       const groupedByDate = {};\n// //       filtered.forEach((item) => {\n// //         const dateKey = new Date(\n// //           item.validTill || item.createdAt\n// //         ).toLocaleDateString(\"en-IN\");\n// //         if (!groupedByDate[dateKey]) groupedByDate[dateKey] = [];\n// //         groupedByDate[dateKey].push(item);\n// //       });\n// //       const labels = Object.keys(groupedByDate);\n// //       const avgBasePrice = labels.map((d) => {\n// //         const dayData = groupedByDate[d];\n// //         return (\n// //           dayData.reduce((sum, i) => sum + Number(i.basePrice || 0), 0) /\n// //           dayData.length\n// //         );\n// //       });\n// //       const avgDiff = labels.map((d) => {\n// //         const dayData = groupedByDate[d];\n// //         return (\n// //           dayData.reduce((sum, i) => sum + Number(i.difference || 0), 0) /\n// //           dayData.length\n// //         );\n// //       });\n// //       const totalCount = labels.map((d) => groupedByDate[d].length);\n// //       // üîπ Multiple Line Datasets\n// //       setChartData({\n// //         labels,\n// //         datasets: [\n// //           {\n// //             label: \"Average Base Price (‚Çπ)\",\n// //             data: avgBasePrice,\n// //             borderColor: \"#007bff\",\n// //             backgroundColor: \"rgba(0,123,255,0.3)\",\n// //             tension: 0.3,\n// //             fill: false,\n// //           },\n// //           {\n// //             label: \"Average Difference (‚Çπ)\",\n// //             data: avgDiff,\n// //             borderColor: \"#ffc107\",\n// //             backgroundColor: \"rgba(255,193,7,0.3)\",\n// //             tension: 0.3,\n// //             fill: false,\n// //           },\n// //           {\n// //             label: \"Total Products Count\",\n// //             data: totalCount,\n// //             borderColor: \"#28a745\",\n// //             backgroundColor: \"rgba(40,167,69,0.3)\",\n// //             tension: 0.3,\n// //             fill: false,\n// //           },\n// //         ],\n// //       });\n// //     } catch (err) {\n// //       console.error(\"Chart fetch error:\", err);\n// //     } finally {\n// //       setLoading(false);\n// //     }\n// //   };\n// //   useEffect(() => {\n// //     fetchChart();\n// //   }, [selectedProduct, selectedCategory, startDate, endDate]);\n// //   return (\n// //     <div className=\"analytics-container\">\n// //       <h2 className=\"analytics-title\">üìÖ Price History & Analytics</h2>\n// //       <p className=\"analytics-subtitle\">\n// //         Track your product & category price trends over time\n// //       </p>\n// //       {/* Filters */}\n// //       <div className=\"filter-section\">\n// //         <div className=\"filter-group\">\n// //           <label>üßÉ Product:</label>\n// //           <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\n// //             <option value=\"\">All Products</option>\n// //             {productList.map((p) => (\n// //               <option key={p._id} value={p.name}>{p.name}</option>\n// //             ))}\n// //           </select>\n// //         </div>\n// //         <div className=\"filter-group\">\n// //           <label>üóÇÔ∏è Category:</label>\n// //           <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\n// //             <option value=\"\">All Categories</option>\n// //             {categoryList.map((c) => (\n// //               <option key={c._id} value={c.name}>{c.name}</option>\n// //             ))}\n// //           </select>\n// //         </div>\n// //         <div className=\"filter-group\">\n// //           <label>üìÜ From:</label>\n// //           <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\n// //         </div>\n// //         <div className=\"filter-group\">\n// //           <label>‚û° To:</label>\n// //           <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\n// //         </div>\n// //         <button className=\"btn refresh\" onClick={fetchChart}>üîÑ Apply</button>\n// //       </div>\n// //       {/* Chart */}\n// //       <div className=\"chart-wrapper\">\n// //         {loading ? (\n// //           <div className=\"loading\">Loading chart...</div>\n// //         ) : chartData ? (\n// //           <Line\n// //             data={chartData}\n// //             options={{\n// //               responsive: true,\n// //               maintainAspectRatio: false,\n// //               plugins: {\n// //                 legend: { position: \"bottom\" },\n// //               },\n// //               scales: {\n// //                 y: { beginAtZero: true },\n// //               },\n// //             }}\n// //           />\n// //         ) : (\n// //           <div className=\"no-data\">No data found.</div>\n// //         )}\n// //       </div>\n// //     </div>\n// //   );\n// // };\n// // export default PriceAnalytics;\n// import React, { useEffect, useState } from \"react\";\n// import axios from \"axios\";\n// import {\n//   Chart as ChartJS,\n//   CategoryScale,\n//   LinearScale,\n//   PointElement,\n//   LineElement,\n//   Title,\n//   Tooltip,\n//   Legend,\n// } from \"chart.js\";\n// import ChartDataLabels from \"chartjs-plugin-datalabels\";\n// import { Line } from \"react-chartjs-2\";\n// import \"./PriceAnalytics.css\";\n// ChartJS.register(\n//   CategoryScale,\n//   LinearScale,\n//   PointElement,\n//   LineElement,\n//   Title,\n//   Tooltip,\n//   Legend,\n//   ChartDataLabels\n// );\n// const API_BASE = \"https://grocerrybackend.vercel.app/api\";\n// const PriceAnalytics = () => {\n//   const [loading, setLoading] = useState(true);\n//   const [productList, setProductList] = useState([]);\n//   const [categoryList, setCategoryList] = useState([]);\n//   const [selectedProduct, setSelectedProduct] = useState(\"\");\n//   const [selectedCategory, setSelectedCategory] = useState(\"\");\n//   const [chartData, setChartData] = useState(null);\n//   useEffect(() => {\n//     const fetchDropdowns = async () => {\n//       try {\n//         const [p, c] = await Promise.all([\n//           axios.get(`${API_BASE}/prices`),\n//           axios.get(`${API_BASE}/categories`),\n//         ]);\n//         setProductList(p.data.data || []);\n//         setCategoryList(c.data.categories || []);\n//       } catch (err) {\n//         console.error(\"Dropdown fetch error:\", err);\n//       }\n//     };\n//     fetchDropdowns();\n//   }, []);\n//   const fetchChart = async () => {\n//     setLoading(true);\n//     try {\n//       const res = await axios.get(`${API_BASE}/prices`);\n//       let all = res.data.data || [];\n//       // Filters\n//       if (selectedProduct)\n//         all = all.filter((p) => p.name === selectedProduct);\n//       if (selectedCategory)\n//         all = all.filter((p) => p.category?.name === selectedCategory);\n//       // Group by Date\n//       const grouped = {};\n//       all.forEach((item) => {\n//         const k = new Date(item.validTill || item.createdAt).toLocaleDateString(\"en-IN\");\n//         if (!grouped[k]) grouped[k] = [];\n//         grouped[k].push(item);\n//       });\n//       const labels = Object.keys(grouped);\n//       // Final Price\n//       const finalPrice = labels.map((d) => {\n//         const arr = grouped[d];\n//         return arr.reduce(\n//           (sum, x) => sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\n//           0\n//         ) / arr.length;\n//       });\n//       setChartData({\n//         labels,\n//         datasets: [\n//           {\n//             label: \"Final Price (‚Çπ)\",\n//             data: finalPrice,\n//             borderColor: \"#007bff\",\n//             backgroundColor: \"rgba(0,123,255,0.3)\",\n//             tension: 0.3,\n//           },\n//         ],\n//       });\n//     } catch (err) {\n//       console.error(\"Chart error:\", err);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n//   useEffect(() => {\n//     fetchChart();\n//   }, [selectedProduct, selectedCategory]);\n//   return (\n//     <div className=\"analytics-container\">\n//       <h2 className=\"analytics-title\">üìä Final Price Analytics</h2>\n//       {/* Filters */}\n//       <div className=\"filter-section\">\n//         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\n//           <option value=\"\">All Products</option>\n//           {productList.map((p) => (\n//             <option key={p._id} value={p.name}>{p.name}</option>\n//           ))}\n//         </select>\n//         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\n//           <option value=\"\">All Categories</option>\n//           {categoryList.map((c) => (\n//             <option key={c._id} value={c.name}>{c.name}</option>\n//           ))}\n//         </select>\n//         <button className=\"btn refresh\" onClick={fetchChart}>Apply</button>\n//       </div>\n//       {/* Chart */}\n//       <div className=\"chart-wrapper\">\n//         {loading ? (\n//           <div className=\"loading\">Loading...</div>\n//         ) : (\n//           <Line\n//             data={chartData}\n//             options={{\n//               responsive: true,\n//               maintainAspectRatio: false,\n//               plugins: {\n//                 legend: { position: \"bottom\" },\n//                 // ‚≠ê ALWAYS SHOW LABEL ‚≠ê\n//                 datalabels: {\n//                   color: \"#000\",\n//                   anchor: \"end\",\n//                   align: \"top\",\n//                   formatter: (value) => `‚Çπ${value}`,\n//                   font: {\n//                     weight: \"bold\",\n//                     size: 12,\n//                   },\n//                 },\n//               },\n//               scales: {\n//                 y: { beginAtZero: true },\n//               },\n//             }}\n//           />\n//         )}\n//       </div>\n//     </div>\n//   );\n// };\n// export default PriceAnalytics;\nimport React,{useEffect,useState}from\"react\";import axios from\"axios\";import{Chart as ChartJS,CategoryScale,LinearScale,PointElement,LineElement,Title,Tooltip,Legend}from\"chart.js\";import ChartDataLabels from\"chartjs-plugin-datalabels\";import{Line}from\"react-chartjs-2\";import\"./PriceAnalytics.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,PointElement,LineElement,Title,Tooltip,Legend,ChartDataLabels);const API_BASE=\"https://grocerrybackend.vercel.app/api\";const PriceAnalytics=()=>{const[loading,setLoading]=useState(true);const[productList,setProductList]=useState([]);const[categoryList,setCategoryList]=useState([]);const[selectedProduct,setSelectedProduct]=useState(\"\");const[selectedCategory,setSelectedCategory]=useState(\"\");// NEW FILTER STATE\nconst[chartType,setChartType]=useState(\"daily\");// daily, weekly, monthly, yearly, custom\nconst[startDate,setStartDate]=useState(\"\");const[endDate,setEndDate]=useState(\"\");const[chartData,setChartData]=useState(null);useEffect(()=>{const fetchDropdowns=async()=>{try{const[p,c]=await Promise.all([axios.get(\"\".concat(API_BASE,\"/prices\")),axios.get(\"\".concat(API_BASE,\"/categories\"))]);setProductList(p.data.data||[]);setCategoryList(c.data.categories||[]);}catch(err){console.error(\"Dropdown fetch error:\",err);}};fetchDropdowns();},[]);// üî• GROUPING HELPERS\nconst groupByWeek=date=>{const d=new Date(date);const onejan=new Date(d.getFullYear(),0,1);const week=Math.ceil(((d-onejan)/86400000+onejan.getDay()+1)/7);return\"Week \".concat(week,\" - \").concat(d.getFullYear());};const groupByMonth=date=>{const d=new Date(date);return\"\".concat(d.toLocaleString(\"en-US\",{month:\"short\"}),\" \").concat(d.getFullYear());};const groupByYear=date=>{return new Date(date).getFullYear().toString();};const fetchChart=async()=>{setLoading(true);try{const res=await axios.get(\"\".concat(API_BASE,\"/prices\"));let all=res.data.data||[];// PRODUCT FILTER\nif(selectedProduct)all=all.filter(p=>p.name===selectedProduct);// CATEGORY FILTER\nif(selectedCategory)all=all.filter(p=>{var _p$category;return((_p$category=p.category)===null||_p$category===void 0?void 0:_p$category.name)===selectedCategory;});// RANGE FILTER\nif(chartType===\"custom\"&&startDate&&endDate){const start=new Date(startDate);const end=new Date(endDate);all=all.filter(p=>{const d=new Date(p.validTill||p.createdAt);return d>=start&&d<=end;});}// GROUP DATA\nconst groups={};all.forEach(item=>{const date=item.validTill||item.createdAt;let groupKey=\"\";switch(chartType){case\"weekly\":groupKey=groupByWeek(date);break;case\"monthly\":groupKey=groupByMonth(date);break;case\"yearly\":groupKey=groupByYear(date);break;default:groupKey=new Date(date).toLocaleDateString(\"en-IN\");}if(!groups[groupKey])groups[groupKey]=[];groups[groupKey].push(item);});const labels=Object.keys(groups);const finalPriceAvg=labels.map(d=>{const arr=groups[d];return arr.reduce((sum,x)=>sum+(Number(x.basePrice||0)+Number(x.difference||0)),0)/arr.length;});setChartData({labels,datasets:[{label:\"Final Price (‚Çπ)\",data:finalPriceAvg,borderColor:\"#007bff\",backgroundColor:\"rgba(0,123,255,0.3)\",tension:0.3}]});}catch(err){console.error(\"Chart Error:\",err);}finally{setLoading(false);}};useEffect(()=>{fetchChart();},[selectedProduct,selectedCategory,chartType,startDate,endDate]);return/*#__PURE__*/_jsxs(\"div\",{className:\"analytics-container\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"analytics-title\",children:\"Price Analytics\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsxs(\"select\",{value:selectedProduct,onChange:e=>setSelectedProduct(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Products\"}),productList.map(p=>/*#__PURE__*/_jsx(\"option\",{value:p.name,children:p.name},p._id))]}),/*#__PURE__*/_jsxs(\"select\",{value:selectedCategory,onChange:e=>setSelectedCategory(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Categories\"}),categoryList.map(c=>/*#__PURE__*/_jsx(\"option\",{value:c.name,children:c.name},c._id))]}),/*#__PURE__*/_jsxs(\"select\",{value:chartType,onChange:e=>setChartType(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"daily\",children:\"Daily\"}),/*#__PURE__*/_jsx(\"option\",{value:\"weekly\",children:\"Weekly\"}),/*#__PURE__*/_jsx(\"option\",{value:\"monthly\",children:\"Monthly\"}),/*#__PURE__*/_jsx(\"option\",{value:\"yearly\",children:\"Yearly\"}),/*#__PURE__*/_jsx(\"option\",{value:\"custom\",children:\"Custom Range\"})]}),chartType===\"custom\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:startDate,onChange:e=>setStartDate(e.target.value)}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:endDate,onChange:e=>setEndDate(e.target.value)})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chart-wrapper\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading chart...\"}):/*#__PURE__*/_jsx(Line,{data:chartData,options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:\"bottom\"},datalabels:{color:\"black\",anchor:\"end\",align:\"top\",formatter:v=>\"\\u20B9\".concat(v),font:{size:12,weight:\"bold\"}}}}})})]});};export default PriceAnalytics;","map":{"version":3,"names":["React","useEffect","useState","axios","Chart","ChartJS","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Legend","ChartDataLabels","Line","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","register","API_BASE","PriceAnalytics","loading","setLoading","productList","setProductList","categoryList","setCategoryList","selectedProduct","setSelectedProduct","selectedCategory","setSelectedCategory","chartType","setChartType","startDate","setStartDate","endDate","setEndDate","chartData","setChartData","fetchDropdowns","p","c","Promise","all","get","concat","data","categories","err","console","error","groupByWeek","date","d","Date","onejan","getFullYear","week","Math","ceil","getDay","groupByMonth","toLocaleString","month","groupByYear","toString","fetchChart","res","filter","name","_p$category","category","start","end","validTill","createdAt","groups","forEach","item","groupKey","toLocaleDateString","push","labels","Object","keys","finalPriceAvg","map","arr","reduce","sum","x","Number","basePrice","difference","length","datasets","label","borderColor","backgroundColor","tension","className","children","value","onChange","e","target","_id","type","options","responsive","maintainAspectRatio","plugins","legend","position","datalabels","color","anchor","align","formatter","v","font","size","weight"],"sources":["E:/infyle/Grocerry_final/frontend/src/pages/admin/PriceAnalytics.jsx"],"sourcesContent":["\r\n\r\n// // import React, { useEffect, useState } from \"react\";\r\n// // import axios from \"axios\";\r\n// // import {\r\n// //   Chart as ChartJS,\r\n// //   CategoryScale,\r\n// //   LinearScale,\r\n// //   PointElement,\r\n// //   LineElement,\r\n// //   Title,\r\n// //   Tooltip,\r\n// //   Legend,\r\n// // } from \"chart.js\";\r\n// // import { Line } from \"react-chartjs-2\";\r\n// // import \"./PriceAnalytics.css\";\r\n\r\n// // ChartJS.register(\r\n// //   CategoryScale,\r\n// //   LinearScale,\r\n// //   PointElement,\r\n// //   LineElement,\r\n// //   Title,\r\n// //   Tooltip,\r\n// //   Legend\r\n// // );\r\n\r\n// // const API_BASE = \"https://grocerrybackend.vercel.app/api\";\r\n\r\n// // const PriceAnalytics = () => {\r\n// //   const [loading, setLoading] = useState(true);\r\n// //   const [productList, setProductList] = useState([]);\r\n// //   const [categoryList, setCategoryList] = useState([]);\r\n// //   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n// //   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n// //   const [startDate, setStartDate] = useState(\"\");\r\n// //   const [endDate, setEndDate] = useState(\"\");\r\n// //   const [chartData, setChartData] = useState(null);\r\n\r\n// //   // üîπ Fetch dropdowns\r\n// //   useEffect(() => {\r\n// //     const fetchDropdowns = async () => {\r\n// //       try {\r\n// //         const [products, categories] = await Promise.all([\r\n// //           axios.get(`${API_BASE}/prices`),\r\n// //           axios.get(`${API_BASE}/categories`),\r\n// //         ]);\r\n// //         setProductList(products.data.data || []);\r\n// //         setCategoryList(categories.data.categories || []);\r\n// //       } catch (err) {\r\n// //         console.error(\"Dropdown fetch error:\", err);\r\n// //       }\r\n// //     };\r\n// //     fetchDropdowns();\r\n// //   }, []);\r\n\r\n// //   // üîπ Fetch chart data with date filter\r\n// //   const fetchChart = async () => {\r\n// //     setLoading(true);\r\n// //     try {\r\n// //       const res = await axios.get(`${API_BASE}/prices`);\r\n// //       const allPrices = res.data.data || [];\r\n\r\n// //       // ‚úÖ Filter by Product / Category\r\n// //       let filtered = allPrices;\r\n// //       if (selectedProduct)\r\n// //         filtered = filtered.filter((p) => p.name === selectedProduct);\r\n// //       if (selectedCategory)\r\n// //         filtered = filtered.filter(\r\n// //           (p) => p.category?.name === selectedCategory\r\n// //         );\r\n\r\n// //       // ‚úÖ Filter by Date Range\r\n// //       if (startDate && endDate) {\r\n// //         const start = new Date(startDate);\r\n// //         const end = new Date(endDate);\r\n\r\n// //         filtered = filtered.filter((item) => {\r\n// //           const date = new Date(item.validTill || item.createdAt);\r\n// //           return date >= start && date <= end;\r\n// //         });\r\n// //       }\r\n\r\n// //       // ‚úÖ Group by Date\r\n// //       const groupedByDate = {};\r\n// //       filtered.forEach((item) => {\r\n// //         const dateKey = new Date(\r\n// //           item.validTill || item.createdAt\r\n// //         ).toLocaleDateString(\"en-IN\");\r\n\r\n// //         if (!groupedByDate[dateKey]) groupedByDate[dateKey] = [];\r\n// //         groupedByDate[dateKey].push(item);\r\n// //       });\r\n\r\n// //       const labels = Object.keys(groupedByDate);\r\n\r\n// //       const avgBasePrice = labels.map((d) => {\r\n// //         const dayData = groupedByDate[d];\r\n// //         return (\r\n// //           dayData.reduce((sum, i) => sum + Number(i.basePrice || 0), 0) /\r\n// //           dayData.length\r\n// //         );\r\n// //       });\r\n\r\n// //       const avgDiff = labels.map((d) => {\r\n// //         const dayData = groupedByDate[d];\r\n// //         return (\r\n// //           dayData.reduce((sum, i) => sum + Number(i.difference || 0), 0) /\r\n// //           dayData.length\r\n// //         );\r\n// //       });\r\n\r\n// //       const totalCount = labels.map((d) => groupedByDate[d].length);\r\n\r\n// //       // üîπ Multiple Line Datasets\r\n// //       setChartData({\r\n// //         labels,\r\n// //         datasets: [\r\n// //           {\r\n// //             label: \"Average Base Price (‚Çπ)\",\r\n// //             data: avgBasePrice,\r\n// //             borderColor: \"#007bff\",\r\n// //             backgroundColor: \"rgba(0,123,255,0.3)\",\r\n// //             tension: 0.3,\r\n// //             fill: false,\r\n// //           },\r\n// //           {\r\n// //             label: \"Average Difference (‚Çπ)\",\r\n// //             data: avgDiff,\r\n// //             borderColor: \"#ffc107\",\r\n// //             backgroundColor: \"rgba(255,193,7,0.3)\",\r\n// //             tension: 0.3,\r\n// //             fill: false,\r\n// //           },\r\n// //           {\r\n// //             label: \"Total Products Count\",\r\n// //             data: totalCount,\r\n// //             borderColor: \"#28a745\",\r\n// //             backgroundColor: \"rgba(40,167,69,0.3)\",\r\n// //             tension: 0.3,\r\n// //             fill: false,\r\n// //           },\r\n// //         ],\r\n// //       });\r\n// //     } catch (err) {\r\n// //       console.error(\"Chart fetch error:\", err);\r\n// //     } finally {\r\n// //       setLoading(false);\r\n// //     }\r\n// //   };\r\n\r\n// //   useEffect(() => {\r\n// //     fetchChart();\r\n// //   }, [selectedProduct, selectedCategory, startDate, endDate]);\r\n\r\n// //   return (\r\n// //     <div className=\"analytics-container\">\r\n// //       <h2 className=\"analytics-title\">üìÖ Price History & Analytics</h2>\r\n// //       <p className=\"analytics-subtitle\">\r\n// //         Track your product & category price trends over time\r\n// //       </p>\r\n\r\n// //       {/* Filters */}\r\n// //       <div className=\"filter-section\">\r\n// //         <div className=\"filter-group\">\r\n// //           <label>üßÉ Product:</label>\r\n// //           <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n// //             <option value=\"\">All Products</option>\r\n// //             {productList.map((p) => (\r\n// //               <option key={p._id} value={p.name}>{p.name}</option>\r\n// //             ))}\r\n// //           </select>\r\n// //         </div>\r\n\r\n// //         <div className=\"filter-group\">\r\n// //           <label>üóÇÔ∏è Category:</label>\r\n// //           <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n// //             <option value=\"\">All Categories</option>\r\n// //             {categoryList.map((c) => (\r\n// //               <option key={c._id} value={c.name}>{c.name}</option>\r\n// //             ))}\r\n// //           </select>\r\n// //         </div>\r\n\r\n// //         <div className=\"filter-group\">\r\n// //           <label>üìÜ From:</label>\r\n// //           <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\r\n// //         </div>\r\n\r\n// //         <div className=\"filter-group\">\r\n// //           <label>‚û° To:</label>\r\n// //           <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\r\n// //         </div>\r\n\r\n// //         <button className=\"btn refresh\" onClick={fetchChart}>üîÑ Apply</button>\r\n// //       </div>\r\n\r\n// //       {/* Chart */}\r\n// //       <div className=\"chart-wrapper\">\r\n// //         {loading ? (\r\n// //           <div className=\"loading\">Loading chart...</div>\r\n// //         ) : chartData ? (\r\n// //           <Line\r\n// //             data={chartData}\r\n// //             options={{\r\n// //               responsive: true,\r\n// //               maintainAspectRatio: false,\r\n// //               plugins: {\r\n// //                 legend: { position: \"bottom\" },\r\n// //               },\r\n// //               scales: {\r\n// //                 y: { beginAtZero: true },\r\n// //               },\r\n// //             }}\r\n// //           />\r\n// //         ) : (\r\n// //           <div className=\"no-data\">No data found.</div>\r\n// //         )}\r\n// //       </div>\r\n// //     </div>\r\n// //   );\r\n// // };\r\n\r\n// // export default PriceAnalytics;\r\n// import React, { useEffect, useState } from \"react\";\r\n// import axios from \"axios\";\r\n// import {\r\n//   Chart as ChartJS,\r\n//   CategoryScale,\r\n//   LinearScale,\r\n//   PointElement,\r\n//   LineElement,\r\n//   Title,\r\n//   Tooltip,\r\n//   Legend,\r\n// } from \"chart.js\";\r\n// import ChartDataLabels from \"chartjs-plugin-datalabels\";\r\n// import { Line } from \"react-chartjs-2\";\r\n// import \"./PriceAnalytics.css\";\r\n\r\n// ChartJS.register(\r\n//   CategoryScale,\r\n//   LinearScale,\r\n//   PointElement,\r\n//   LineElement,\r\n//   Title,\r\n//   Tooltip,\r\n//   Legend,\r\n//   ChartDataLabels\r\n// );\r\n\r\n// const API_BASE = \"https://grocerrybackend.vercel.app/api\";\r\n\r\n// const PriceAnalytics = () => {\r\n//   const [loading, setLoading] = useState(true);\r\n//   const [productList, setProductList] = useState([]);\r\n//   const [categoryList, setCategoryList] = useState([]);\r\n//   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n//   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n//   const [chartData, setChartData] = useState(null);\r\n\r\n//   useEffect(() => {\r\n//     const fetchDropdowns = async () => {\r\n//       try {\r\n//         const [p, c] = await Promise.all([\r\n//           axios.get(`${API_BASE}/prices`),\r\n//           axios.get(`${API_BASE}/categories`),\r\n//         ]);\r\n\r\n//         setProductList(p.data.data || []);\r\n//         setCategoryList(c.data.categories || []);\r\n//       } catch (err) {\r\n//         console.error(\"Dropdown fetch error:\", err);\r\n//       }\r\n//     };\r\n\r\n//     fetchDropdowns();\r\n//   }, []);\r\n\r\n//   const fetchChart = async () => {\r\n//     setLoading(true);\r\n//     try {\r\n//       const res = await axios.get(`${API_BASE}/prices`);\r\n//       let all = res.data.data || [];\r\n\r\n//       // Filters\r\n//       if (selectedProduct)\r\n//         all = all.filter((p) => p.name === selectedProduct);\r\n\r\n//       if (selectedCategory)\r\n//         all = all.filter((p) => p.category?.name === selectedCategory);\r\n\r\n//       // Group by Date\r\n//       const grouped = {};\r\n//       all.forEach((item) => {\r\n//         const k = new Date(item.validTill || item.createdAt).toLocaleDateString(\"en-IN\");\r\n//         if (!grouped[k]) grouped[k] = [];\r\n//         grouped[k].push(item);\r\n//       });\r\n\r\n//       const labels = Object.keys(grouped);\r\n\r\n//       // Final Price\r\n//       const finalPrice = labels.map((d) => {\r\n//         const arr = grouped[d];\r\n//         return arr.reduce(\r\n//           (sum, x) => sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\r\n//           0\r\n//         ) / arr.length;\r\n//       });\r\n\r\n//       setChartData({\r\n//         labels,\r\n//         datasets: [\r\n//           {\r\n//             label: \"Final Price (‚Çπ)\",\r\n//             data: finalPrice,\r\n//             borderColor: \"#007bff\",\r\n//             backgroundColor: \"rgba(0,123,255,0.3)\",\r\n//             tension: 0.3,\r\n//           },\r\n//         ],\r\n//       });\r\n//     } catch (err) {\r\n//       console.error(\"Chart error:\", err);\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   useEffect(() => {\r\n//     fetchChart();\r\n//   }, [selectedProduct, selectedCategory]);\r\n\r\n//   return (\r\n//     <div className=\"analytics-container\">\r\n//       <h2 className=\"analytics-title\">üìä Final Price Analytics</h2>\r\n\r\n//       {/* Filters */}\r\n//       <div className=\"filter-section\">\r\n//         <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n//           <option value=\"\">All Products</option>\r\n//           {productList.map((p) => (\r\n//             <option key={p._id} value={p.name}>{p.name}</option>\r\n//           ))}\r\n//         </select>\r\n\r\n//         <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n//           <option value=\"\">All Categories</option>\r\n//           {categoryList.map((c) => (\r\n//             <option key={c._id} value={c.name}>{c.name}</option>\r\n//           ))}\r\n//         </select>\r\n\r\n//         <button className=\"btn refresh\" onClick={fetchChart}>Apply</button>\r\n//       </div>\r\n\r\n//       {/* Chart */}\r\n//       <div className=\"chart-wrapper\">\r\n//         {loading ? (\r\n//           <div className=\"loading\">Loading...</div>\r\n//         ) : (\r\n//           <Line\r\n//             data={chartData}\r\n//             options={{\r\n//               responsive: true,\r\n//               maintainAspectRatio: false,\r\n//               plugins: {\r\n//                 legend: { position: \"bottom\" },\r\n\r\n//                 // ‚≠ê ALWAYS SHOW LABEL ‚≠ê\r\n//                 datalabels: {\r\n//                   color: \"#000\",\r\n//                   anchor: \"end\",\r\n//                   align: \"top\",\r\n//                   formatter: (value) => `‚Çπ${value}`,\r\n//                   font: {\r\n//                     weight: \"bold\",\r\n//                     size: 12,\r\n//                   },\r\n//                 },\r\n//               },\r\n//               scales: {\r\n//                 y: { beginAtZero: true },\r\n//               },\r\n//             }}\r\n//           />\r\n//         )}\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default PriceAnalytics;\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n} from \"chart.js\";\r\nimport ChartDataLabels from \"chartjs-plugin-datalabels\";\r\nimport { Line } from \"react-chartjs-2\";\r\nimport \"./PriceAnalytics.css\";\r\n\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  ChartDataLabels\r\n);\r\n\r\nconst API_BASE = \"https://grocerrybackend.vercel.app/api\";\r\n\r\nconst PriceAnalytics = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [productList, setProductList] = useState([]);\r\n  const [categoryList, setCategoryList] = useState([]);\r\n  const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n  const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n\r\n  // NEW FILTER STATE\r\n  const [chartType, setChartType] = useState(\"daily\"); // daily, weekly, monthly, yearly, custom\r\n  const [startDate, setStartDate] = useState(\"\");\r\n  const [endDate, setEndDate] = useState(\"\");\r\n\r\n  const [chartData, setChartData] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchDropdowns = async () => {\r\n      try {\r\n        const [p, c] = await Promise.all([\r\n          axios.get(`${API_BASE}/prices`),\r\n          axios.get(`${API_BASE}/categories`),\r\n        ]);\r\n\r\n        setProductList(p.data.data || []);\r\n        setCategoryList(c.data.categories || []);\r\n      } catch (err) {\r\n        console.error(\"Dropdown fetch error:\", err);\r\n      }\r\n    };\r\n\r\n    fetchDropdowns();\r\n  }, []);\r\n\r\n  // üî• GROUPING HELPERS\r\n  const groupByWeek = (date) => {\r\n    const d = new Date(date);\r\n    const onejan = new Date(d.getFullYear(), 0, 1);\r\n    const week = Math.ceil(((d - onejan) / 86400000 + onejan.getDay() + 1) / 7);\r\n    return `Week ${week} - ${d.getFullYear()}`;\r\n  };\r\n\r\n  const groupByMonth = (date) => {\r\n    const d = new Date(date);\r\n    return `${d.toLocaleString(\"en-US\", { month: \"short\" })} ${d.getFullYear()}`;\r\n  };\r\n\r\n  const groupByYear = (date) => {\r\n    return new Date(date).getFullYear().toString();\r\n  };\r\n\r\n  const fetchChart = async () => {\r\n    setLoading(true);\r\n\r\n    try {\r\n      const res = await axios.get(`${API_BASE}/prices`);\r\n      let all = res.data.data || [];\r\n\r\n      // PRODUCT FILTER\r\n      if (selectedProduct)\r\n        all = all.filter((p) => p.name === selectedProduct);\r\n\r\n      // CATEGORY FILTER\r\n      if (selectedCategory)\r\n        all = all.filter((p) => p.category?.name === selectedCategory);\r\n\r\n      // RANGE FILTER\r\n      if (chartType === \"custom\" && startDate && endDate) {\r\n        const start = new Date(startDate);\r\n        const end = new Date(endDate);\r\n        all = all.filter((p) => {\r\n          const d = new Date(p.validTill || p.createdAt);\r\n          return d >= start && d <= end;\r\n        });\r\n      }\r\n\r\n      // GROUP DATA\r\n      const groups = {};\r\n\r\n      all.forEach((item) => {\r\n        const date = item.validTill || item.createdAt;\r\n\r\n        let groupKey = \"\";\r\n\r\n        switch (chartType) {\r\n          case \"weekly\":\r\n            groupKey = groupByWeek(date);\r\n            break;\r\n          case \"monthly\":\r\n            groupKey = groupByMonth(date);\r\n            break;\r\n          case \"yearly\":\r\n            groupKey = groupByYear(date);\r\n            break;\r\n          default:\r\n            groupKey = new Date(date).toLocaleDateString(\"en-IN\");\r\n        }\r\n\r\n        if (!groups[groupKey]) groups[groupKey] = [];\r\n        groups[groupKey].push(item);\r\n      });\r\n\r\n      const labels = Object.keys(groups);\r\n\r\n      const finalPriceAvg = labels.map((d) => {\r\n        const arr = groups[d];\r\n        return (\r\n          arr.reduce(\r\n            (sum, x) =>\r\n              sum + (Number(x.basePrice || 0) + Number(x.difference || 0)),\r\n            0\r\n          ) / arr.length\r\n        );\r\n      });\r\n\r\n      setChartData({\r\n        labels,\r\n        datasets: [\r\n          {\r\n            label: \"Final Price (‚Çπ)\",\r\n            data: finalPriceAvg,\r\n            borderColor: \"#007bff\",\r\n            backgroundColor: \"rgba(0,123,255,0.3)\",\r\n            tension: 0.3,\r\n          },\r\n        ],\r\n      });\r\n    } catch (err) {\r\n      console.error(\"Chart Error:\", err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchChart();\r\n  }, [selectedProduct, selectedCategory, chartType, startDate, endDate]);\r\n\r\n  return (\r\n    <div className=\"analytics-container\">\r\n      <h2 className=\"analytics-title\">Price Analytics</h2>\r\n\r\n      <div className=\"filter-section\">\r\n        \r\n        {/* PRODUCT */}\r\n        <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n          <option value=\"\">All Products</option>\r\n          {productList.map((p) => (\r\n            <option key={p._id} value={p.name}>{p.name}</option>\r\n          ))}\r\n        </select>\r\n\r\n        {/* CATEGORY */}\r\n        <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n          <option value=\"\">All Categories</option>\r\n          {categoryList.map((c) => (\r\n            <option key={c._id} value={c.name}>{c.name}</option>\r\n          ))}\r\n        </select>\r\n\r\n        {/* TYPE FILTER */}\r\n        <select value={chartType} onChange={(e) => setChartType(e.target.value)}>\r\n          <option value=\"daily\">Daily</option>\r\n          <option value=\"weekly\">Weekly</option>\r\n          <option value=\"monthly\">Monthly</option>\r\n          <option value=\"yearly\">Yearly</option>\r\n          <option value=\"custom\">Custom Range</option>\r\n        </select>\r\n\r\n        {/* DATE RANGE ONLY IF CUSTOM */}\r\n        {chartType === \"custom\" && (\r\n          <>\r\n            <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\r\n            <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\r\n          </>\r\n        )}\r\n\r\n        {/* <button className=\"btn refresh\" onClick={fetchChart}>Apply</button> */}\r\n      </div>\r\n\r\n      <div className=\"chart-wrapper\">\r\n        {loading ? (\r\n          <div className=\"loading\">Loading chart...</div>\r\n        ) : (\r\n          <Line\r\n            data={chartData}\r\n            options={{\r\n              responsive: true,\r\n              maintainAspectRatio: false,\r\n              plugins: {\r\n                legend: { position: \"bottom\" },\r\n                datalabels: {\r\n                  color: \"black\",\r\n                  anchor: \"end\",\r\n                  align: \"top\",\r\n                  formatter: (v) => `‚Çπ${v}`,\r\n                  font: { size: 12, weight: \"bold\" },\r\n                },\r\n              },\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PriceAnalytics;\r\n"],"mappings":"AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OACEC,KAAK,GAAI,CAAAC,OAAO,CAChBC,aAAa,CACbC,WAAW,CACXC,YAAY,CACZC,WAAW,CACXC,KAAK,CACLC,OAAO,CACPC,MAAM,KACD,UAAU,CACjB,MAAO,CAAAC,eAAe,KAAM,2BAA2B,CACvD,OAASC,IAAI,KAAQ,iBAAiB,CACtC,MAAO,sBAAsB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE9Bf,OAAO,CAACgB,QAAQ,CACdf,aAAa,CACbC,WAAW,CACXC,YAAY,CACZC,WAAW,CACXC,KAAK,CACLC,OAAO,CACPC,MAAM,CACNC,eACF,CAAC,CAED,KAAM,CAAAS,QAAQ,CAAG,wCAAwC,CAEzD,KAAM,CAAAC,cAAc,CAAGA,CAAA,GAAM,CAC3B,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGvB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACwB,WAAW,CAAEC,cAAc,CAAC,CAAGzB,QAAQ,CA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}