{"ast":null,"code":"\n\n// import React, { useEffect, useState } from \"react\";\n// import axios from \"axios\";\n// import {\n//   Chart as ChartJS,\n//   CategoryScale,\n//   LinearScale,\n//   PointElement,\n//   LineElement,\n//   Title,\n//   Tooltip,\n//   Legend,\n// } from \"chart.js\";\n// import { Line } from \"react-chartjs-2\";\n// import \"./PriceAnalytics.css\";\n\n// ChartJS.register(\n//   CategoryScale,\n//   LinearScale,\n//   PointElement,\n//   LineElement,\n//   Title,\n//   Tooltip,\n//   Legend\n// );\n\n// const API_BASE = \"https://grocerrybackend.vercel.app/api\";\n\n// const PriceAnalytics = () => {\n//   const [loading, setLoading] = useState(true);\n//   const [productList, setProductList] = useState([]);\n//   const [categoryList, setCategoryList] = useState([]);\n//   const [selectedProduct, setSelectedProduct] = useState(\"\");\n//   const [selectedCategory, setSelectedCategory] = useState(\"\");\n//   const [startDate, setStartDate] = useState(\"\");\n//   const [endDate, setEndDate] = useState(\"\");\n//   const [chartData, setChartData] = useState(null);\n\n//   // üîπ Fetch dropdowns\n//   useEffect(() => {\n//     const fetchDropdowns = async () => {\n//       try {\n//         const [products, categories] = await Promise.all([\n//           axios.get(`${API_BASE}/prices`),\n//           axios.get(`${API_BASE}/categories`),\n//         ]);\n//         setProductList(products.data.data || []);\n//         setCategoryList(categories.data.categories || []);\n//       } catch (err) {\n//         console.error(\"Dropdown fetch error:\", err);\n//       }\n//     };\n//     fetchDropdowns();\n//   }, []);\n\n//   // üîπ Fetch chart data with date filter\n//   const fetchChart = async () => {\n//     setLoading(true);\n//     try {\n//       const res = await axios.get(`${API_BASE}/prices`);\n//       const allPrices = res.data.data || [];\n\n//       // ‚úÖ Filter by Product / Category\n//       let filtered = allPrices;\n//       if (selectedProduct)\n//         filtered = filtered.filter((p) => p.name === selectedProduct);\n//       if (selectedCategory)\n//         filtered = filtered.filter(\n//           (p) => p.category?.name === selectedCategory\n//         );\n\n//       // ‚úÖ Filter by Date Range\n//       if (startDate && endDate) {\n//         const start = new Date(startDate);\n//         const end = new Date(endDate);\n\n//         filtered = filtered.filter((item) => {\n//           const date = new Date(item.validTill || item.createdAt);\n//           return date >= start && date <= end;\n//         });\n//       }\n\n//       // ‚úÖ Group by Date\n//       const groupedByDate = {};\n//       filtered.forEach((item) => {\n//         const dateKey = new Date(\n//           item.validTill || item.createdAt\n//         ).toLocaleDateString(\"en-IN\");\n\n//         if (!groupedByDate[dateKey]) groupedByDate[dateKey] = [];\n//         groupedByDate[dateKey].push(item);\n//       });\n\n//       const labels = Object.keys(groupedByDate);\n\n//       const avgBasePrice = labels.map((d) => {\n//         const dayData = groupedByDate[d];\n//         return (\n//           dayData.reduce((sum, i) => sum + Number(i.basePrice || 0), 0) /\n//           dayData.length\n//         );\n//       });\n\n//       const avgDiff = labels.map((d) => {\n//         const dayData = groupedByDate[d];\n//         return (\n//           dayData.reduce((sum, i) => sum + Number(i.difference || 0), 0) /\n//           dayData.length\n//         );\n//       });\n\n//       const totalCount = labels.map((d) => groupedByDate[d].length);\n\n//       // üîπ Multiple Line Datasets\n//       setChartData({\n//         labels,\n//         datasets: [\n//           {\n//             label: \"Average Base Price (‚Çπ)\",\n//             data: avgBasePrice,\n//             borderColor: \"#007bff\",\n//             backgroundColor: \"rgba(0,123,255,0.3)\",\n//             tension: 0.3,\n//             fill: false,\n//           },\n//           {\n//             label: \"Average Difference (‚Çπ)\",\n//             data: avgDiff,\n//             borderColor: \"#ffc107\",\n//             backgroundColor: \"rgba(255,193,7,0.3)\",\n//             tension: 0.3,\n//             fill: false,\n//           },\n//           {\n//             label: \"Total Products Count\",\n//             data: totalCount,\n//             borderColor: \"#28a745\",\n//             backgroundColor: \"rgba(40,167,69,0.3)\",\n//             tension: 0.3,\n//             fill: false,\n//           },\n//         ],\n//       });\n//     } catch (err) {\n//       console.error(\"Chart fetch error:\", err);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   useEffect(() => {\n//     fetchChart();\n//   }, [selectedProduct, selectedCategory, startDate, endDate]);\n\n//   return (\n//     <div className=\"analytics-container\">\n//       <h2 className=\"analytics-title\">üìÖ Price History & Analytics</h2>\n//       <p className=\"analytics-subtitle\">\n//         Track your product & category price trends over time\n//       </p>\n\n//       {/* Filters */}\n//       <div className=\"filter-section\">\n//         <div className=\"filter-group\">\n//           <label>üßÉ Product:</label>\n//           <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\n//             <option value=\"\">All Products</option>\n//             {productList.map((p) => (\n//               <option key={p._id} value={p.name}>{p.name}</option>\n//             ))}\n//           </select>\n//         </div>\n\n//         <div className=\"filter-group\">\n//           <label>üóÇÔ∏è Category:</label>\n//           <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\n//             <option value=\"\">All Categories</option>\n//             {categoryList.map((c) => (\n//               <option key={c._id} value={c.name}>{c.name}</option>\n//             ))}\n//           </select>\n//         </div>\n\n//         <div className=\"filter-group\">\n//           <label>üìÜ From:</label>\n//           <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\n//         </div>\n\n//         <div className=\"filter-group\">\n//           <label>‚û° To:</label>\n//           <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\n//         </div>\n\n//         <button className=\"btn refresh\" onClick={fetchChart}>üîÑ Apply</button>\n//       </div>\n\n//       {/* Chart */}\n//       <div className=\"chart-wrapper\">\n//         {loading ? (\n//           <div className=\"loading\">Loading chart...</div>\n//         ) : chartData ? (\n//           <Line\n//             data={chartData}\n//             options={{\n//               responsive: true,\n//               maintainAspectRatio: false,\n//               plugins: {\n//                 legend: { position: \"bottom\" },\n//               },\n//               scales: {\n//                 y: { beginAtZero: true },\n//               },\n//             }}\n//           />\n//         ) : (\n//           <div className=\"no-data\">No data found.</div>\n//         )}\n//       </div>\n//     </div>\n//   );\n// };\n\n// export default PriceAnalytics;","map":{"version":3,"names":[],"sources":["E:/infyle/Grocerry_final/frontend/src/pages/admin/PriceAnalytics.jsx"],"sourcesContent":["\r\n\r\n// import React, { useEffect, useState } from \"react\";\r\n// import axios from \"axios\";\r\n// import {\r\n//   Chart as ChartJS,\r\n//   CategoryScale,\r\n//   LinearScale,\r\n//   PointElement,\r\n//   LineElement,\r\n//   Title,\r\n//   Tooltip,\r\n//   Legend,\r\n// } from \"chart.js\";\r\n// import { Line } from \"react-chartjs-2\";\r\n// import \"./PriceAnalytics.css\";\r\n\r\n// ChartJS.register(\r\n//   CategoryScale,\r\n//   LinearScale,\r\n//   PointElement,\r\n//   LineElement,\r\n//   Title,\r\n//   Tooltip,\r\n//   Legend\r\n// );\r\n\r\n// const API_BASE = \"https://grocerrybackend.vercel.app/api\";\r\n\r\n// const PriceAnalytics = () => {\r\n//   const [loading, setLoading] = useState(true);\r\n//   const [productList, setProductList] = useState([]);\r\n//   const [categoryList, setCategoryList] = useState([]);\r\n//   const [selectedProduct, setSelectedProduct] = useState(\"\");\r\n//   const [selectedCategory, setSelectedCategory] = useState(\"\");\r\n//   const [startDate, setStartDate] = useState(\"\");\r\n//   const [endDate, setEndDate] = useState(\"\");\r\n//   const [chartData, setChartData] = useState(null);\r\n\r\n//   // üîπ Fetch dropdowns\r\n//   useEffect(() => {\r\n//     const fetchDropdowns = async () => {\r\n//       try {\r\n//         const [products, categories] = await Promise.all([\r\n//           axios.get(`${API_BASE}/prices`),\r\n//           axios.get(`${API_BASE}/categories`),\r\n//         ]);\r\n//         setProductList(products.data.data || []);\r\n//         setCategoryList(categories.data.categories || []);\r\n//       } catch (err) {\r\n//         console.error(\"Dropdown fetch error:\", err);\r\n//       }\r\n//     };\r\n//     fetchDropdowns();\r\n//   }, []);\r\n\r\n//   // üîπ Fetch chart data with date filter\r\n//   const fetchChart = async () => {\r\n//     setLoading(true);\r\n//     try {\r\n//       const res = await axios.get(`${API_BASE}/prices`);\r\n//       const allPrices = res.data.data || [];\r\n\r\n//       // ‚úÖ Filter by Product / Category\r\n//       let filtered = allPrices;\r\n//       if (selectedProduct)\r\n//         filtered = filtered.filter((p) => p.name === selectedProduct);\r\n//       if (selectedCategory)\r\n//         filtered = filtered.filter(\r\n//           (p) => p.category?.name === selectedCategory\r\n//         );\r\n\r\n//       // ‚úÖ Filter by Date Range\r\n//       if (startDate && endDate) {\r\n//         const start = new Date(startDate);\r\n//         const end = new Date(endDate);\r\n\r\n//         filtered = filtered.filter((item) => {\r\n//           const date = new Date(item.validTill || item.createdAt);\r\n//           return date >= start && date <= end;\r\n//         });\r\n//       }\r\n\r\n//       // ‚úÖ Group by Date\r\n//       const groupedByDate = {};\r\n//       filtered.forEach((item) => {\r\n//         const dateKey = new Date(\r\n//           item.validTill || item.createdAt\r\n//         ).toLocaleDateString(\"en-IN\");\r\n\r\n//         if (!groupedByDate[dateKey]) groupedByDate[dateKey] = [];\r\n//         groupedByDate[dateKey].push(item);\r\n//       });\r\n\r\n//       const labels = Object.keys(groupedByDate);\r\n\r\n//       const avgBasePrice = labels.map((d) => {\r\n//         const dayData = groupedByDate[d];\r\n//         return (\r\n//           dayData.reduce((sum, i) => sum + Number(i.basePrice || 0), 0) /\r\n//           dayData.length\r\n//         );\r\n//       });\r\n\r\n//       const avgDiff = labels.map((d) => {\r\n//         const dayData = groupedByDate[d];\r\n//         return (\r\n//           dayData.reduce((sum, i) => sum + Number(i.difference || 0), 0) /\r\n//           dayData.length\r\n//         );\r\n//       });\r\n\r\n//       const totalCount = labels.map((d) => groupedByDate[d].length);\r\n\r\n//       // üîπ Multiple Line Datasets\r\n//       setChartData({\r\n//         labels,\r\n//         datasets: [\r\n//           {\r\n//             label: \"Average Base Price (‚Çπ)\",\r\n//             data: avgBasePrice,\r\n//             borderColor: \"#007bff\",\r\n//             backgroundColor: \"rgba(0,123,255,0.3)\",\r\n//             tension: 0.3,\r\n//             fill: false,\r\n//           },\r\n//           {\r\n//             label: \"Average Difference (‚Çπ)\",\r\n//             data: avgDiff,\r\n//             borderColor: \"#ffc107\",\r\n//             backgroundColor: \"rgba(255,193,7,0.3)\",\r\n//             tension: 0.3,\r\n//             fill: false,\r\n//           },\r\n//           {\r\n//             label: \"Total Products Count\",\r\n//             data: totalCount,\r\n//             borderColor: \"#28a745\",\r\n//             backgroundColor: \"rgba(40,167,69,0.3)\",\r\n//             tension: 0.3,\r\n//             fill: false,\r\n//           },\r\n//         ],\r\n//       });\r\n//     } catch (err) {\r\n//       console.error(\"Chart fetch error:\", err);\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   useEffect(() => {\r\n//     fetchChart();\r\n//   }, [selectedProduct, selectedCategory, startDate, endDate]);\r\n\r\n//   return (\r\n//     <div className=\"analytics-container\">\r\n//       <h2 className=\"analytics-title\">üìÖ Price History & Analytics</h2>\r\n//       <p className=\"analytics-subtitle\">\r\n//         Track your product & category price trends over time\r\n//       </p>\r\n\r\n//       {/* Filters */}\r\n//       <div className=\"filter-section\">\r\n//         <div className=\"filter-group\">\r\n//           <label>üßÉ Product:</label>\r\n//           <select value={selectedProduct} onChange={(e) => setSelectedProduct(e.target.value)}>\r\n//             <option value=\"\">All Products</option>\r\n//             {productList.map((p) => (\r\n//               <option key={p._id} value={p.name}>{p.name}</option>\r\n//             ))}\r\n//           </select>\r\n//         </div>\r\n\r\n//         <div className=\"filter-group\">\r\n//           <label>üóÇÔ∏è Category:</label>\r\n//           <select value={selectedCategory} onChange={(e) => setSelectedCategory(e.target.value)}>\r\n//             <option value=\"\">All Categories</option>\r\n//             {categoryList.map((c) => (\r\n//               <option key={c._id} value={c.name}>{c.name}</option>\r\n//             ))}\r\n//           </select>\r\n//         </div>\r\n\r\n//         <div className=\"filter-group\">\r\n//           <label>üìÜ From:</label>\r\n//           <input type=\"date\" value={startDate} onChange={(e) => setStartDate(e.target.value)} />\r\n//         </div>\r\n\r\n//         <div className=\"filter-group\">\r\n//           <label>‚û° To:</label>\r\n//           <input type=\"date\" value={endDate} onChange={(e) => setEndDate(e.target.value)} />\r\n//         </div>\r\n\r\n//         <button className=\"btn refresh\" onClick={fetchChart}>üîÑ Apply</button>\r\n//       </div>\r\n\r\n//       {/* Chart */}\r\n//       <div className=\"chart-wrapper\">\r\n//         {loading ? (\r\n//           <div className=\"loading\">Loading chart...</div>\r\n//         ) : chartData ? (\r\n//           <Line\r\n//             data={chartData}\r\n//             options={{\r\n//               responsive: true,\r\n//               maintainAspectRatio: false,\r\n//               plugins: {\r\n//                 legend: { position: \"bottom\" },\r\n//               },\r\n//               scales: {\r\n//                 y: { beginAtZero: true },\r\n//               },\r\n//             }}\r\n//           />\r\n//         ) : (\r\n//           <div className=\"no-data\">No data found.</div>\r\n//         )}\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// };\r\n\r\n// export default PriceAnalytics;\r\n"],"mappings":";;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}