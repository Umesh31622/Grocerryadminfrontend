{"ast":null,"code":"\n// // // import React, { useEffect, useState, useRef } from \"react\";\n// // // import axios from \"axios\";\n// // // import \"./PriceList.css\";\n\n// // // const API_URL = \"https://grocerrybackend.vercel.app/api/prices\";\n// // // const CATEGORY_URL = \"https://grocerrybackend.vercel.app/api/categories\";\n\n// // // export default function PriceList() {\n// // //   const [items, setItems] = useState([]);\n// // //   const [categories, setCategories] = useState([]);\n// // //   const [subcategories, setSubcategories] = useState([]);\n// // //   const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\n\n// // //   const [search, setSearch] = useState(\"\");\n\n// // //   const [form, setForm] = useState({\n// // //     name: \"\",\n// // //     category: \"\",\n// // //     subcategory: \"\",\n// // //     description: \"\",\n// // //     basePrice: \"\",\n// // //     difference: \"\",\n// // //     validTill: \"\",\n// // //     file: null,\n// // //   });\n\n// // //   const [editId, setEditId] = useState(null);\n// // //   const [loading, setLoading] = useState(false);\n// // //   const [csvFile, setCsvFile] = useState(null);\n\n// // //   // COPY MODE\n// // //   const [isCopyMode, setIsCopyMode] = useState(false);\n\n// // //   // CATEGORY ADD\n// // //   const [addingCategory, setAddingCategory] = useState(false);\n// // //   const [newCategoryName, setNewCategoryName] = useState(\"\");\n// // //   const [newCategoryImage, setNewCategoryImage] = useState(null);\n// // //   const [newCategoryPreview, setNewCategoryPreview] = useState(null);\n\n// // //   // SUB CATEGORY ADD\n// // //   const [addingSub, setAddingSub] = useState(false);\n// // //   const [newSubName, setNewSubName] = useState(\"\");\n// // //   const [newSubImage, setNewSubImage] = useState(null);\n// // //   const [newSubPreview, setNewSubPreview] = useState(null);\n\n// // //   // BULK\n// // //   const [selectedItems, setSelectedItems] = useState([]);\n// // //   const [bulkMode, setBulkMode] = useState(false);\n\n// // //   const csvInputRef = useRef();\n\n// // //   // PAGINATION\n// // //   const [currentPage, setCurrentPage] = useState(1);\n// // //   const itemsPerPage = 30;\n\n// // //   // ----------------- FETCH ITEMS -----------------\n// // //   useEffect(() => {\n// // //     fetchItems();\n// // //     fetchCategories();\n\n// // //     const handleResize = () => setIsMobile(window.innerWidth < 768);\n// // //     window.addEventListener(\"resize\", handleResize);\n\n// // //     return () => window.removeEventListener(\"resize\", handleResize);\n// // //   }, []);\n\n// // //   const fetchItems = async () => {\n// // //     try {\n// // //       setLoading(true);\n// // //       const res = await axios.get(API_URL);\n// // //       if (res.data.success) setItems(res.data.data || []);\n// // //     } catch (err) {\n// // //       console.log(\"Fetch error\", err);\n// // //     } finally {\n// // //       setLoading(false);\n// // //     }\n// // //   };\n\n// // //   const fetchCategories = async () => {\n// // //     try {\n// // //       const res = await axios.get(CATEGORY_URL);\n// // //       if (res.data.success) {\n// // //         setCategories(res.data.categories || []);\n// // //       }\n// // //     } catch (err) {\n// // //       console.log(\"Cat fetch err\", err);\n// // //     }\n// // //   };\n// // //   // ----------------- WHEN CATEGORY SELECT ‚Üí LOAD SUBCATEGORIES -----------------\n// // //   useEffect(() => {\n// // //     if (!form.category) {\n// // //       setSubcategories([]);\n// // //       setForm((prev) => ({ ...prev, subcategory: \"\" }));\n// // //       return;\n// // //     }\n\n// // //     const categoryObj = categories.find((c) => c._id === form.category);\n// // //     if (categoryObj && categoryObj.subcategories) {\n// // //       setSubcategories(categoryObj.subcategories);\n// // //     } else {\n// // //       setSubcategories([]);\n// // //     }\n\n// // //     setForm((prev) => ({ ...prev, subcategory: \"\" }));\n// // //   }, [form.category, categories]);\n\n// // //   // ----------------- CREATE CATEGORY -----------------\n// // //   const handleCreateCategory = async () => {\n// // //     if (!newCategoryName) return alert(\"Enter category name\");\n\n// // //     try {\n// // //       const fd = new FormData();\n// // //       fd.append(\"name\", newCategoryName);\n// // //       if (newCategoryImage) fd.append(\"image\", newCategoryImage);\n\n// // //       const res = await axios.post(CATEGORY_URL, fd);\n\n// // //       if (res.data.success) {\n// // //         alert(\"Category Created!\");\n\n// // //         setNewCategoryName(\"\");\n// // //         setNewCategoryImage(null);\n// // //         setNewCategoryPreview(null);\n// // //         setAddingCategory(false);\n\n// // //         fetchCategories();\n// // //       }\n// // //     } catch (err) {\n// // //       console.log(\"Category create error\", err);\n// // //       alert(\"Category create failed\");\n// // //     }\n// // //   };\n\n// // //   // ----------------- CREATE SUB CATEGORY -----------------\n// // //   const handleCreateSub = async () => {\n// // //     if (!newSubName) return alert(\"Enter subcategory name\");\n// // //     if (!form.category) return alert(\"Select category first\");\n\n// // //     try {\n// // //       const fd = new FormData();\n// // //       fd.append(\"name\", newSubName);\n// // //       if (newSubImage) fd.append(\"image\", newSubImage);\n\n// // //       const res = await axios.post(\n// // //         `${CATEGORY_URL}/${form.category}/sub`,\n// // //         fd\n// // //       );\n\n// // //       if (res.data.success) {\n// // //         alert(\"Subcategory Created!\");\n\n// // //         setNewSubName(\"\");\n// // //         setNewSubImage(null);\n// // //         setNewSubPreview(null);\n// // //         setAddingSub(false);\n\n// // //         fetchCategories();\n// // //       }\n// // //     } catch (err) {\n// // //       console.log(\"Subcategory create error\", err);\n// // //       alert(\"Subcategory create failed\");\n// // //     }\n// // //   };\n\n// // //   // ----------------- HANDLE INPUTS -----------------\n// // //   const handleChange = (e) => {\n// // //     const { name, value, files } = e.target;\n// // //     if (files) setForm({ ...form, file: files[0] });\n// // //     else setForm({ ...form, [name]: value });\n// // //   };\n\n// // //   // ----------------- SUBMIT FORM -----------------\n// // //   const handleSubmit = async (e) => {\n// // //     e.preventDefault();\n// // //     setLoading(true);\n\n// // //     try {\n// // //       if (!form.name || !form.category || !form.basePrice) {\n// // //         alert(\"Name, category & base price required\");\n// // //         return;\n// // //       }\n\n// // //       const fd = new FormData();\n// // //       Object.keys(form).forEach((k) => {\n// // //         if (form[k] !== \"\" && form[k] !== null) fd.append(k, form[k]);\n// // //       });\n\n// // //       if (isCopyMode) {\n// // //         await axios.post(API_URL, fd);\n// // //         alert(\"Copied as new item!\");\n// // //       } else if (editId) {\n// // //         await axios.put(`${API_URL}/${editId}`, fd);\n// // //       } else {\n// // //         await axios.post(API_URL, fd);\n// // //       }\n\n// // //       setForm({\n// // //         name: \"\",\n// // //         category: \"\",\n// // //         subcategory: \"\",\n// // //         description: \"\",\n// // //         basePrice: \"\",\n// // //         difference: \"\",\n// // //         validTill: \"\",\n// // //         file: null,\n// // //       });\n\n// // //       setEditId(null);\n// // //       setIsCopyMode(false);\n// // //       fetchItems();\n// // //     } catch (err) {\n// // //       console.log(\"Save error\", err);\n// // //       alert(\"Save failed\");\n// // //     } finally {\n// // //       setLoading(false);\n// // //     }\n// // //   };\n\n// // //   // ----------------- EDIT -----------------\n// // //   const handleEdit = (item) => {\n// // //     setForm({\n// // //       name: item.name,\n// // //       category: item.category?._id?.toString() || \"\",\n// // //       subcategory: item.subcategory?._id?.toString() || \"\",\n// // //       description: item.description || \"\",\n// // //       basePrice: item.basePrice,\n// // //       difference: item.difference,\n// // //       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n// // //       file: null,\n// // //     });\n\n// // //     setIsCopyMode(false);\n// // //     setEditId(item._id);\n// // //     window.scrollTo({ top: 0, behavior: \"smooth\" });\n// // //   };\n\n// // //   // ----------------- COPY ‚Üí NEW ENTRY -----------------\n// // //   const handleCopyToEdit = (item) => {\n// // //     setForm({\n// // //       name: item.name,\n// // //       category: item.category?._id?.toString() || \"\",\n// // //       subcategory: item.subcategory?._id?.toString() || \"\",\n// // //       description: item.description || \"\",\n// // //       basePrice: item.basePrice,\n// // //       difference: item.difference,\n// // //       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n// // //       file: null,\n// // //     });\n\n// // //     setEditId(null);\n// // //     setIsCopyMode(true);\n// // //     window.scrollTo({ top: 0, behavior: \"smooth\" });\n// // //   };\n// // //   // ----------------- DELETE -----------------\n// // //   const handleDelete = async (id) => {\n// // //     if (!window.confirm(\"Delete?\")) return;\n// // //     try {\n// // //       await axios.delete(`${API_URL}/${id}`);\n// // //       fetchItems();\n// // //     } catch (err) {\n// // //       console.error(\"Delete error\", err);\n// // //       alert(\"Delete failed\");\n// // //     }\n// // //   };\n\n// // //   // ----------------- STATUS TOGGLE -----------------\n// // //   const handleStatusToggle = async (item) => {\n// // //     const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\n\n// // //     try {\n// // //       await axios.put(`${API_URL}/status/${item._id}`, { status: newStatus });\n// // //       setItems((prev) =>\n// // //         prev.map((x) => (x._id === item._id ? { ...x, status: newStatus } : x))\n// // //       );\n// // //     } catch (err) {\n// // //       console.error(\"Status toggle error\", err);\n// // //       alert(\"Status update failed\");\n// // //     }\n// // //   };\n\n// // //   // ----------------- BULK DELETE -----------------\n// // //   const handleBulkDelete = async () => {\n// // //     if (!window.confirm(\"Delete selected items?\")) return;\n\n// // //     try {\n// // //       await Promise.all(\n// // //         selectedItems.map((id) => axios.delete(`${API_URL}/${id}`))\n// // //       );\n// // //       setSelectedItems([]);\n// // //       fetchItems();\n// // //     } catch (err) {\n// // //       console.error(\"Bulk delete error\", err);\n// // //       alert(\"Bulk delete failed\");\n// // //     }\n// // //   };\n\n// // //   // ----------------- BULK HELPERS -----------------\n// // //   const updateLocalItemField = (id, key, value) => {\n// // //     setItems((prev) =>\n// // //       prev.map((x) => (x._id === id ? { ...x, [key]: value } : x))\n// // //     );\n// // //   };\n\n// // //   const handleBulkSave = async () => {\n// // //     const updates = items\n// // //       .filter((x) => selectedItems.includes(x._id))\n// // //       .map((x) => ({\n// // //         id: x._id,\n// // //         name: x.name,\n// // //         basePrice: x.basePrice,\n// // //         difference: x.difference,\n// // //         validTill: x.validTill,\n// // //       }));\n\n// // //     try {\n// // //       await axios.post(`${API_URL}/bulk-update`, { products: updates });\n// // //       setBulkMode(false);\n// // //       setSelectedItems([]);\n// // //       fetchItems();\n// // //     } catch (err) {\n// // //       console.error(\"Bulk save error\", err);\n// // //       alert(\"Bulk save failed\");\n// // //     }\n// // //   };\n\n// // //   // ----------------- CSV IMPORT -----------------\n// // //   const handleCsvSelect = (e) => setCsvFile(e.target.files[0]);\n\n// // //   const handleImportCsv = async () => {\n// // //     if (!csvFile) return alert(\"Select CSV\");\n\n// // //     const fd = new FormData();\n// // //     fd.append(\"file\", csvFile);\n\n// // //     try {\n// // //       const res = await axios.post(`${API_URL}/import`, fd);\n// // //       if (res.data.success) {\n// // //         fetchItems();\n// // //         alert(\"CSV Imported!\");\n// // //         setCsvFile(null);\n// // //         if (csvInputRef.current) csvInputRef.current.value = null;\n// // //       } else {\n// // //         alert(\"CSV import failed\");\n// // //       }\n// // //     } catch (err) {\n// // //       console.error(\"CSV import error\", err);\n// // //       alert(\"CSV import failed\");\n// // //     }\n// // //   };\n\n// // //   // ----------------- CSV EXPORT -----------------\n// // //   const handleExportCsv = async () => {\n// // //     try {\n// // //       const res = await axios.get(`${API_URL}/export`, { responseType: \"blob\" });\n\n// // //       const url = window.URL.createObjectURL(new Blob([res.data]));\n// // //       const a = document.createElement(\"a\");\n// // //       a.href = url;\n// // //       a.download = \"prices.csv\";\n// // //       a.click();\n// // //     } catch (err) {\n// // //       console.error(\"CSV export error\", err);\n// // //       alert(\"CSV export failed\");\n// // //     }\n// // //   };\n\n// // //   // ----------------- SEARCH FILTER -----------------\n// // //   const filteredItems = items.filter((item) => {\n// // //     const t = search.toLowerCase();\n// // //     return (\n// // //       item.name.toLowerCase().includes(t) ||\n// // //       item.category?.name?.toLowerCase().includes(t) ||\n// // //       item.subcategory?.name?.toLowerCase().includes(t)\n// // //     );\n// // //   });\n\n// // //   // ----------------- PAGINATION -----------------\n// // //   const indexOfLast = currentPage * itemsPerPage;\n// // //   const currentItems = filteredItems.slice(\n// // //     indexOfLast - itemsPerPage,\n// // //     indexOfLast\n// // //   );\n// // //   const totalPages = Math.ceil(filteredItems.length / itemsPerPage);\n\n// // //   return (\n// // //     <div className=\"price-container\">\n\n// // //       {/* HEADER */}\n// // //       <div className=\"header-section\">\n// // //         <h1>üí∞ Product Management</h1>\n// // //         <p>Manage prices, categories, images, CSV & bulk actions.</p>\n// // //       </div>\n\n// // //       {/* SEARCH */}\n// // //       <div className=\"search-bar\">\n// // //         <input\n// // //           type=\"text\"\n// // //           placeholder=\"Search product, category or subcategory...\"\n// // //           value={search}\n// // //           onChange={(e) => setSearch(e.target.value)}\n// // //         />\n// // //       </div>\n\n// // //       {/* BULK BAR */}\n// // //       {selectedItems.length > 0 && (\n// // //         <div className=\"bulk-bar\">\n// // //           <span>{selectedItems.length} selected</span>\n\n// // //           {!bulkMode ? (\n// // //             <div className=\"bulk-actions\">\n// // //               <button className=\"btn delete\" onClick={handleBulkDelete}>\n// // //                 üóë Bulk Delete\n// // //               </button>\n\n// // //               <button className=\"btn primary\" onClick={() => setBulkMode(true)}>\n// // //                 ‚úè Bulk Edit\n// // //               </button>\n// // //             </div>\n// // //           ) : (\n// // //             <div className=\"bulk-panel\">\n// // //               <h3>‚úè Bulk Edit Selected Items</h3>\n\n// // //               {items\n// // //                 .filter((item) => selectedItems.includes(item._id))\n// // //                 .map((item) => (\n// // //                   <div key={item._id} className=\"bulk-edit-item-box\">\n// // //                     <h4>{item.name}</h4>\n\n// // //                     <div className=\"form-grid\">\n// // //                       <div className=\"form-group\">\n// // //                         <label>Name</label>\n// // //                         <input\n// // //                           type=\"text\"\n// // //                           value={item.name}\n// // //                           onChange={(e) =>\n// // //                             updateLocalItemField(item._id, \"name\", e.target.value)\n// // //                           }\n// // //                         />\n// // //                       </div>\n\n// // //                       <div className=\"form-group\">\n// // //                         <label>Base Price</label>\n// // //                         <input\n// // //                           type=\"number\"\n// // //                           value={item.basePrice}\n// // //                           onChange={(e) =>\n// // //                             updateLocalItemField(\n// // //                               item._id,\n// // //                               \"basePrice\",\n// // //                               Number(e.target.value)\n// // //                             )\n// // //                           }\n// // //                         />\n// // //                       </div>\n\n// // //                       <div className=\"form-group\">\n// // //                         <label>Difference</label>\n// // //                         <input\n// // //                           type=\"number\"\n// // //                           value={item.difference || 0}\n// // //                           onChange={(e) =>\n// // //                             updateLocalItemField(\n// // //                               item._id,\n// // //                               \"difference\",\n// // //                               Number(e.target.value)\n// // //                             )\n// // //                           }\n// // //                         />\n// // //                       </div>\n\n// // //                       <div className=\"form-group\">\n// // //                         <label>Valid Till</label>\n// // //                         <input\n// // //                           type=\"date\"\n// // //                           value={item.validTill ? item.validTill.split(\"T\")[0] : \"\"}\n// // //                           onChange={(e) =>\n// // //                             updateLocalItemField(\n// // //                               item._id,\n// // //                               \"validTill\",\n// // //                               e.target.value\n// // //                             )\n// // //                           }\n// // //                         />\n// // //                       </div>\n// // //                     </div>\n// // //                   </div>\n// // //                 ))}\n\n// // //               <button className=\"btn primary\" onClick={handleBulkSave}>\n// // //                 ‚úî Save All\n// // //               </button>\n\n// // //               <button className=\"btn cancel\" onClick={() => setBulkMode(false)}>\n// // //                 ‚úñ Cancel\n// // //               </button>\n// // //             </div>\n// // //           )}\n// // //         </div>\n// // //       )}\n\n// // //       {/* ADD / EDIT FORM */}\n// // //       <div className=\"price-form-card\">\n// // //         <h2>\n// // //           {isCopyMode\n// // //             ? \"üìÑ Save Duplicate Product\"\n// // //             : editId\n// // //             ? \"‚úè Update Product\"\n// // //             : \"‚ûï Add Product\"}\n// // //         </h2>\n\n// // //         <form onSubmit={handleSubmit}>\n// // //           <div className=\"form-grid\">\n\n// // //             {/* NAME */}\n// // //             <div className=\"form-group\">\n// // //               <label>Product Name *</label>\n// // //               <input\n// // //                 required\n// // //                 name=\"name\"\n// // //                 value={form.name}\n// // //                 onChange={handleChange}\n// // //               />\n// // //             </div>\n\n// // //             {/* CATEGORY SELECT */}\n// // //             <div className=\"form-group\">\n// // //               <label>Category *</label>\n// // //               <div className=\"category-row\">\n// // //                 <select\n// // //                   required\n// // //                   name=\"category\"\n// // //                   value={form.category}\n// // //                   onChange={handleChange}\n// // //                 >\n// // //                   <option value=\"\">Select Category</option>\n// // //                   {categories.map((c) => (\n// // //                     <option value={c._id} key={c._id}>\n// // //                       {c.name}\n// // //                     </option>\n// // //                   ))}\n// // //                 </select>\n\n// // //                 <button\n// // //                   type=\"button\"\n// // //                   className=\"btn small\"\n// // //                   onClick={() => setAddingCategory(!addingCategory)}\n// // //                 >\n// // //                   {addingCategory ? \"Close\" : \"Add\"}\n// // //                 </button>\n// // //               </div>\n// // //             </div>\n\n// // //             {/* ADD CATEGORY */}\n// // //             {addingCategory && (\n// // //               <div className=\"form-group full-width addCategoryBox\">\n// // //                 <label>Add New Category</label>\n\n// // //                 <div className=\"category-row\">\n// // //                   <input\n// // //                     value={newCategoryName}\n// // //                     onChange={(e) => setNewCategoryName(e.target.value)}\n// // //                     placeholder=\"Category name\"\n// // //                   />\n\n// // //                   <input\n// // //                     type=\"file\"\n// // //                     accept=\"image/*\"\n// // //                     onChange={(e) => {\n// // //                       setNewCategoryImage(e.target.files[0]);\n// // //                       setNewCategoryPreview(\n// // //                         e.target.files[0]\n// // //                           ? URL.createObjectURL(e.target.files[0])\n// // //                           : null\n// // //                       );\n// // //                     }}\n// // //                   />\n\n// // //                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateCategory}>\n// // //                     Create\n// // //                   </button>\n// // //                 </div>\n\n// // //                 {newCategoryPreview && (\n// // //                   <img src={newCategoryPreview} className=\"categoryPreview\" />\n// // //                 )}\n// // //               </div>\n// // //             )}\n\n// // //             {/* SUBCATEGORY SELECT */}\n// // //             <div className=\"form-group\">\n// // //               <label>Subcategory</label>\n// // //               <div className=\"category-row\">\n// // //                 <select\n// // //                   name=\"subcategory\"\n// // //                   value={form.subcategory}\n// // //                   onChange={handleChange}\n// // //                   disabled={!subcategories.length}\n// // //                 >\n// // //                   <option value=\"\">Select Subcategory</option>\n// // //                   {subcategories.map((s) => (\n// // //                     <option value={s._id} key={s._id}>\n// // //                       {s.name}\n// // //                     </option>\n// // //                   ))}\n// // //                 </select>\n\n// // //                 {form.category && (\n// // //                   <button\n// // //                     type=\"button\"\n// // //                     className=\"btn small\"\n// // //                     onClick={() => setAddingSub(!addingSub)}\n// // //                   >\n// // //                     {addingSub ? \"Close\" : \"Add\"}\n// // //                   </button>\n// // //                 )}\n// // //               </div>\n// // //             </div>\n\n// // //             {/* ADD SUBCATEGORY */}\n// // //             {addingSub && (\n// // //               <div className=\"form-group full-width addCategoryBox\">\n// // //                 <label>Add New Subcategory</label>\n\n// // //                 <div className=\"category-row\">\n// // //                   <input\n// // //                     value={newSubName}\n// // //                     onChange={(e) => setNewSubName(e.target.value)}\n// // //                     placeholder=\"Subcategory name\"\n// // //                   />\n\n// // //                   <input\n// // //                     type=\"file\"\n// // //                     accept=\"image/*\"\n// // //                     onChange={(e) => {\n// // //                       setNewSubImage(e.target.files[0]);\n// // //                       setNewSubPreview(\n// // //                         e.target.files[0]\n// // //                           ? URL.createObjectURL(e.target.files[0])\n// // //                           : null\n// // //                       );\n// // //                     }}\n// // //                   />\n\n// // //                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateSub}>\n// // //                     Create\n// // //                   </button>\n// // //                 </div>\n\n// // //                 {newSubPreview && (\n// // //                   <img src={newSubPreview} className=\"categoryPreview\" />\n// // //                 )}\n// // //               </div>\n// // //             )}\n\n// // //             {/* BASE PRICE */}\n// // //             <div className=\"form-group\">\n// // //               <label>Base Price *</label>\n// // //               <input\n// // //                 type=\"number\"\n// // //                 required\n// // //                 name=\"basePrice\"\n// // //                 value={form.basePrice}\n// // //                 onChange={handleChange}\n// // //               />\n// // //             </div>\n\n// // //             {/* DIFFERENCE */}\n// // //             <div className=\"form-group\">\n// // //               <label>Difference</label>\n// // //               <input\n// // //                 type=\"number\"\n// // //                 name=\"difference\"\n// // //                 value={form.difference}\n// // //                 onChange={handleChange}\n// // //               />\n// // //             </div>\n\n// // //             {/* VALID TILL */}\n// // //             <div className=\"form-group\">\n// // //               <label>Valid Till</label>\n// // //               <input\n// // //                 type=\"date\"\n// // //                 name=\"validTill\"\n// // //                 value={form.validTill}\n// // //                 onChange={handleChange}\n// // //               />\n// // //             </div>\n\n// // //             {/* IMAGE */}\n// // //             <div className=\"form-group\">\n// // //               <label>Image</label>\n// // //               <input type=\"file\" accept=\"image/*\" onChange={handleChange} />\n// // //             </div>\n// // //           </div>\n\n// // //           {/* DESCRIPTION */}\n// // //           <div className=\"form-group full-width\">\n// // //             <label>Description</label>\n// // //             <textarea\n// // //               name=\"description\"\n// // //               value={form.description}\n// // //               onChange={handleChange}\n// // //             ></textarea>\n// // //           </div>\n\n// // //           {/* SUBMIT BUTTON */}\n// // //           <div className=\"form-actions\">\n// // //             <button className=\"btn primary\" disabled={loading}>\n// // //               {loading\n// // //                 ? \"Saving...\"\n// // //                 : isCopyMode\n// // //                 ? \"Save Copy\"\n// // //                 : editId\n// // //                 ? \"Update\"\n// // //                 : \"Add\"}\n// // //             </button>\n\n// // //             {(editId || isCopyMode) && (\n// // //               <button\n// // //                 type=\"button\"\n// // //                 className=\"btn cancel\"\n// // //                 onClick={() => {\n// // //                   setEditId(null);\n// // //                   setIsCopyMode(false);\n// // //                 }}\n// // //               >\n// // //                 Cancel\n// // //               </button>\n// // //             )}\n// // //           </div>\n// // //         </form>\n// // //       </div>\n\n// // //       {/* CSV IMPORT EXPORT */}\n// // //       <div className=\"csv-controls\">\n// // //         <div>\n// // //           <input\n// // //             type=\"file\"\n// // //             accept=\".csv\"\n// // //             ref={csvInputRef}\n// // //             onChange={handleCsvSelect}\n// // //           />\n// // //           <button className=\"btn small\" onClick={handleImportCsv}>\n// // //             Import CSV\n// // //           </button>\n// // //         </div>\n\n// // //         <button className=\"btn primary\" onClick={handleExportCsv}>\n// // //           Export CSV\n// // //         </button>\n// // //       </div>\n\n// // //       {/* TABLE */}\n// // //       <div className=\"table-card\">\n// // //         <div className=\"table-header\">\n// // //           <h2>üìã Items</h2>\n// // //           <span>Total: {filteredItems.length}</span>\n// // //         </div>\n\n// // //         {!isMobile ? (\n// // //           <table>\n// // //             <thead>\n// // //               <tr>\n// // //                 <th>\n// // //                   <input\n// // //                     type=\"checkbox\"\n// // //                     checked={\n// // //                       selectedItems.length === filteredItems.length &&\n// // //                       filteredItems.length > 0\n// // //                     }\n// // //                     onChange={() => {\n// // //                       if (selectedItems.length === filteredItems.length)\n// // //                         setSelectedItems([]);\n// // //                       else\n// // //                         setSelectedItems(filteredItems.map((x) => x._id));\n// // //                     }}\n// // //                   />\n// // //                 </th>\n// // //                 <th>Sr</th>\n// // //                 <th>Image</th>\n// // //                 <th>Name</th>\n// // //                 <th>Category</th>\n// // //                 <th>Subcategory</th>\n// // //                 <th>Base</th>\n// // //                 <th>Diff</th>\n// // //                 <th>Final</th>\n// // //                 <th>Status</th>\n// // //                 <th>Valid Till</th>\n// // //                 <th>Actions</th>\n// // //               </tr>\n// // //             </thead>\n\n// // //             <tbody>\n// // //               {currentItems.map((item, i) => (\n// // //                 <tr key={item._id}>\n// // //                   <td>\n// // //                     <input\n// // //                       type=\"checkbox\"\n// // //                       checked={selectedItems.includes(item._id)}\n// // //                       onChange={() =>\n// // //                         selectedItems.includes(item._id)\n// // //                           ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\n// // //                           : setSelectedItems([...selectedItems, item._id])\n// // //                       }\n// // //                     />\n// // //                   </td>\n\n// // //                   <td>{(currentPage - 1) * itemsPerPage + (i + 1)}</td>\n\n// // //                   <td>{item.image ? <img src={item.image} alt=\"img\" /> : \"No Img\"}</td>\n\n// // //                   <td>{item.name}</td>\n\n// // //                   <td>{item.category?.name}</td>\n\n// // //                   <td>{item.subcategory?.name || \"-\"}</td>\n\n// // //                   <td>‚Çπ{item.basePrice}</td>\n\n// // //                   <td>{item.difference || 0}</td>\n\n// // //                   <td>‚Çπ{Number(item.basePrice) + Number(item.difference || 0)}</td>\n\n// // //                   <td>\n// // //                     <button\n// // //                       className={\n// // //                         item.status === \"active\" ? \"status-active\" : \"status-inactive\"\n// // //                       }\n// // //                       onClick={() => handleStatusToggle(item)}\n// // //                     >\n// // //                       {item.status === \"active\" ? \"üü¢ Active\" : \"üî¥ Inactive\"}\n// // //                     </button>\n// // //                   </td>\n\n// // //                   <td>\n// // //                     {item.validTill\n// // //                       ? new Date(item.validTill).toLocaleDateString()\n// // //                       : \"-\"}\n// // //                   </td>\n\n// // //                   <td className=\"actions\">\n// // //                     <button className=\"btn edit\" onClick={() => handleEdit(item)}>\n// // //                       Edit\n// // //                     </button>\n\n// // //                     <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\n// // //                       Delete\n// // //                     </button>\n\n// // //                     <button\n// // //                       className=\"btn small\"\n// // //                       style={{ background: \"#6f42c1\", color: \"#fff\" }}\n// // //                       onClick={() => handleCopyToEdit(item)}\n// // //                     >\n// // //                       Copy\n// // //                     </button>\n// // //                   </td>\n// // //                 </tr>\n// // //               ))}\n// // //             </tbody>\n// // //           </table>\n// // //         ) : (\n// // //           <div className=\"mobile-list\">\n// // //             {currentItems.map((item) => (\n// // //               <div key={item._id} className=\"mobile-card\">\n// // //                 <input\n// // //                   type=\"checkbox\"\n// // //                   checked={selectedItems.includes(item._id)}\n// // //                   onChange={() =>\n// // //                     selectedItems.includes(item._id)\n// // //                       ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\n// // //                       : setSelectedItems([...selectedItems, item._id])\n// // //                   }\n// // //                 />\n\n// // //                 {item.image ? (\n// // //                   <img src={item.image} alt=\"img\" />\n// // //                 ) : (\n// // //                   <div>No Image</div>\n// // //                 )}\n\n// // //                 <h3>{item.name}</h3>\n\n// // //                 <p>\n// // //                   <b>Category:</b> {item.category?.name}\n// // //                 </p>\n\n// // //                 <p>\n// // //                   <b>Subcategory:</b> {item.subcategory?.name || \"-\"}\n// // //                 </p>\n\n// // //                 <p>\n// // //                   <b>Base:</b> ‚Çπ{item.basePrice}\n// // //                 </p>\n\n// // //                 <p>\n// // //                   <b>Final:</b> ‚Çπ\n// // //                   {Number(item.basePrice) + Number(item.difference || 0)}\n// // //                 </p>\n\n// // //                 <button\n// // //                   className={\n// // //                     item.status === \"active\" ? \"status-active\" : \"status-inactive\"\n// // //                   }\n// // //                   onClick={() => handleStatusToggle(item)}\n// // //                 >\n// // //                   {item.status === \"active\" ? \"Active\" : \"Inactive\"}\n// // //                 </button>\n\n// // //                 <div className=\"actions\">\n// // //                   <button className=\"btn edit\" onClick={() => handleEdit(item)}>\n// // //                     Edit\n// // //                   </button>\n\n// // //                   <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\n// // //                     Delete\n// // //                   </button>\n\n// // //                   <button\n// // //                     className=\"btn small\"\n// // //                     style={{ background: \"#6f42c1\", color: \"#fff\" }}\n// // //                     onClick={() => handleCopyToEdit(item)}\n// // //                   >\n// // //                     Copy\n// // //                   </button>\n// // //                 </div>\n// // //               </div>\n// // //             ))}\n// // //           </div>\n// // //         )}\n\n// // //         {/* PAGINATION */}\n// // //         <div className=\"pagination\">\n// // //           <button\n// // //             disabled={currentPage === 1}\n// // //             onClick={() => setCurrentPage((p) => p - 1)}\n// // //           >\n// // //             Previous\n// // //           </button>\n\n// // //           {Array.from({ length: totalPages }).map((_, i) => (\n// // //             <button\n// // //               key={i}\n// // //               className={i + 1 === currentPage ? \"active-page\" : \"\"}\n// // //               onClick={() => setCurrentPage(i + 1)}\n// // //             >\n// // //               {i + 1}\n// // //             </button>\n// // //           ))}\n\n// // //           <button\n// // //             disabled={currentPage === totalPages}\n// // //             onClick={() => setCurrentPage((p) => p + 1)}\n// // //           >\n// // //             Next\n// // //           </button>\n// // //         </div>\n// // //       </div>\n// // //     </div>\n// // //   );\n// // // }\n// // import React, { useEffect, useState, useRef } from \"react\";\n// // import axios from \"axios\";\n// // import \"./PriceList.css\";\n\n// // const API_URL = \"https://grocerrybackend.vercel.app/api/prices\";\n// // const CATEGORY_URL = \"https://grocerrybackend.vercel.app/api/categories\";\n\n// // export default function PriceList() {\n// //   const [items, setItems] = useState([]);\n// //   const [categories, setCategories] = useState([]);\n// //   const [subcategories, setSubcategories] = useState([]);\n// //   const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\n\n// //   const [search, setSearch] = useState(\"\");\n\n// //   const [form, setForm] = useState({\n// //     name: \"\",\n// //     category: \"\",\n// //     subcategory: \"\",\n// //     description: \"\",\n// //     basePrice: \"\",\n// //     difference: \"\",\n// //     validTill: \"\",\n// //     file: null,\n// //   });\n\n// //   const [editId, setEditId] = useState(null);\n// //   const [loading, setLoading] = useState(false);\n// //   const [csvFile, setCsvFile] = useState(null);\n\n// //   // COPY MODE\n// //   const [isCopyMode, setIsCopyMode] = useState(false);\n\n// //   // CATEGORY ADD\n// //   const [addingCategory, setAddingCategory] = useState(false);\n// //   const [newCategoryName, setNewCategoryName] = useState(\"\");\n// //   const [newCategoryImage, setNewCategoryImage] = useState(null);\n// //   const [newCategoryPreview, setNewCategoryPreview] = useState(null);\n\n// //   // SUB CATEGORY ADD\n// //   const [addingSub, setAddingSub] = useState(false);\n// //   const [newSubName, setNewSubName] = useState(\"\");\n// //   const [newSubImage, setNewSubImage] = useState(null);\n// //   const [newSubPreview, setNewSubPreview] = useState(null);\n\n// //   // BULK\n// //   const [selectedItems, setSelectedItems] = useState([]);\n// //   const [bulkMode, setBulkMode] = useState(false);\n\n// //   const csvInputRef = useRef();\n\n// //   // PAGINATION\n// //   const [currentPage, setCurrentPage] = useState(1);\n// //   const itemsPerPage = 30;\n\n// //   // ----------------- FETCH ITEMS -----------------\n// //   useEffect(() => {\n// //     fetchItems();\n// //     fetchCategories();\n\n// //     const handleResize = () => setIsMobile(window.innerWidth < 768);\n// //     window.addEventListener(\"resize\", handleResize);\n\n// //     return () => window.removeEventListener(\"resize\", handleResize);\n// //   }, []);\n\n// //   const fetchItems = async () => {\n// //     try {\n// //       setLoading(true);\n// //       const res = await axios.get(API_URL);\n// //       if (res.data.success) setItems(res.data.data || []);\n// //     } catch (err) {\n// //       console.log(\"Fetch error\", err);\n// //     } finally {\n// //       setLoading(false);\n// //     }\n// //   };\n\n// //   const fetchCategories = async () => {\n// //     try {\n// //       const res = await axios.get(CATEGORY_URL);\n// //       if (res.data.success) {\n// //         setCategories(res.data.categories || []);\n// //       }\n// //     } catch (err) {\n// //       console.log(\"Cat fetch err\", err);\n// //     }\n// //   };\n\n// //   // ----------------- WHEN CATEGORY SELECT ‚Üí LOAD SUBCATEGORIES -----------------\n// //   useEffect(() => {\n// //     if (!form.category) {\n// //       setSubcategories([]);\n// //       setForm((prev) => ({ ...prev, subcategory: \"\" }));\n// //       return;\n// //     }\n\n// //     const categoryObj = categories.find((c) => c._id === form.category);\n// //     setSubcategories(categoryObj?.subcategories || []);\n\n// //     setForm((prev) => ({ ...prev, subcategory: \"\" }));\n// //   }, [form.category, categories]);\n// //   // ----------------- CREATE CATEGORY -----------------\n// //   const handleCreateCategory = async () => {\n// //     if (!newCategoryName.trim()) return alert(\"Enter category name\");\n\n// //     try {\n// //       const fd = new FormData();\n// //       fd.append(\"name\", newCategoryName.trim());\n// //       if (newCategoryImage) fd.append(\"image\", newCategoryImage);\n\n// //       const res = await axios.post(CATEGORY_URL, fd);\n// //       if (res.data && (res.data.success || res.status === 200)) {\n// //         alert(\"Category Created!\");\n// //         setNewCategoryName(\"\");\n// //         setNewCategoryImage(null);\n// //         setNewCategoryPreview(null);\n// //         setAddingCategory(false);\n// //         fetchCategories();\n// //       } else {\n// //         alert(\"Category create failed\");\n// //       }\n// //     } catch (err) {\n// //       console.error(\"Category create error\", err);\n// //       alert(\"Category create failed\");\n// //     }\n// //   };\n\n// //   // ----------------- CREATE SUB CATEGORY -----------------\n// //   const handleCreateSub = async () => {\n// //     if (!newSubName.trim()) return alert(\"Enter subcategory name\");\n// //     if (!form.category) return alert(\"Select category first\");\n\n// //     try {\n// //       const fd = new FormData();\n// //       fd.append(\"name\", newSubName.trim());\n// //       if (newSubImage) fd.append(\"image\", newSubImage);\n\n// //       const res = await axios.post(`${CATEGORY_URL}/${form.category}/sub`, fd);\n// //       if (res.data && (res.data.success || res.status === 200)) {\n// //         alert(\"Subcategory Created!\");\n// //         setNewSubName(\"\");\n// //         setNewSubImage(null);\n// //         setNewSubPreview(null);\n// //         setAddingSub(false);\n// //         fetchCategories();\n// //       } else {\n// //         alert(\"Subcategory create failed\");\n// //       }\n// //     } catch (err) {\n// //       console.error(\"Subcategory create error\", err);\n// //       alert(\"Subcategory create failed\");\n// //     }\n// //   };\n\n// //   // ----------------- HANDLE INPUTS -----------------\n// //   const handleChange = (e) => {\n// //     const { name, value, files } = e.target;\n// //     if (files && files.length) {\n// //       setForm((p) => ({ ...p, file: files[0] }));\n// //     } else {\n// //       setForm((p) => ({ ...p, [name]: value }));\n// //     }\n// //   };\n\n// //   // ----------------- SUBMIT FORM (ADD / UPDATE PRODUCT) -----------------\n// //   const handleSubmit = async (e) => {\n// //     e.preventDefault();\n// //     setLoading(true);\n// //     try {\n// //       if (!form.name || !form.category || !form.basePrice) {\n// //         alert(\"Name, category & base price required\");\n// //         setLoading(false);\n// //         return;\n// //       }\n\n// //       const fd = new FormData();\n// //       Object.keys(form).forEach((k) => {\n// //         if (form[k] !== \"\" && form[k] !== null) fd.append(k, form[k]);\n// //       });\n\n// //       let res;\n// //       if (isCopyMode) {\n// //         res = await axios.post(API_URL, fd);\n// //         alert(\"Copied as new item!\");\n// //       } else if (editId) {\n// //         res = await axios.put(`${API_URL}/${editId}`, fd);\n// //         alert(\"Updated!\");\n// //       } else {\n// //         res = await axios.post(API_URL, fd);\n// //         alert(\"Added!\");\n// //       }\n\n// //       // Reset\n// //       setForm({\n// //         name: \"\",\n// //         category: \"\",\n// //         subcategory: \"\",\n// //         description: \"\",\n// //         basePrice: \"\",\n// //         difference: \"\",\n// //         validTill: \"\",\n// //         file: null,\n// //       });\n// //       setEditId(null);\n// //       setIsCopyMode(false);\n// //       fetchItems();\n// //     } catch (err) {\n// //       console.error(\"Save error\", err);\n// //       alert(\"Save failed\");\n// //     } finally {\n// //       setLoading(false);\n// //     }\n// //   };\n\n// //   // ----------------- EDIT -----------------\n// //   const handleEdit = (item) => {\n// //     setForm({\n// //       name: item.name || \"\",\n// //       category: item.category?._id?.toString() || \"\",\n// //       subcategory: item.subcategory?._id?.toString() || \"\",\n// //       description: item.description || \"\",\n// //       basePrice: item.basePrice || \"\",\n// //       difference: item.difference || \"\",\n// //       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n// //       file: null,\n// //     });\n\n// //     setIsCopyMode(false);\n// //     setEditId(item._id);\n// //     window.scrollTo({ top: 0, behavior: \"smooth\" });\n// //   };\n\n// //   // ----------------- COPY ‚Üí NEW ENTRY -----------------\n// //   const handleCopyToEdit = (item) => {\n// //     setForm({\n// //       name: item.name || \"\",\n// //       category: item.category?._id?.toString() || \"\",\n// //       subcategory: item.subcategory?._id?.toString() || \"\",\n// //       description: item.description || \"\",\n// //       basePrice: item.basePrice || \"\",\n// //       difference: item.difference || \"\",\n// //       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n// //       file: null,\n// //     });\n\n// //     setEditId(null);\n// //     setIsCopyMode(true);\n// //     window.scrollTo({ top: 0, behavior: \"smooth\" });\n// //   };\n\n// //   // ----------------- DELETE -----------------\n// //   const handleDelete = async (id) => {\n// //     if (!window.confirm(\"Delete?\")) return;\n// //     try {\n// //       await axios.delete(`${API_URL}/${id}`);\n// //       fetchItems();\n// //     } catch (err) {\n// //       console.error(\"Delete error\", err);\n// //       alert(\"Delete failed\");\n// //     }\n// //   };\n\n// //   // ----------------- STATUS TOGGLE -----------------\n// //   const handleStatusToggle = async (item) => {\n// //     const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\n// //     try {\n// //       await axios.put(`${API_URL}/status/${item._id}`, { status: newStatus });\n// //       setItems((prev) =>\n// //         prev.map((x) => (x._id === item._id ? { ...x, status: newStatus } : x))\n// //       );\n// //     } catch (err) {\n// //       console.error(\"Status toggle error\", err);\n// //       alert(\"Status update failed\");\n// //     }\n// //   };\n\n// //   // ----------------- BULK DELETE -----------------\n// //   const handleBulkDelete = async () => {\n// //     if (!selectedItems.length) return alert(\"No items selected\");\n// //     if (!window.confirm(\"Delete selected items?\")) return;\n\n// //     try {\n// //       await Promise.all(selectedItems.map((id) => axios.delete(`${API_URL}/${id}`)));\n// //       setSelectedItems([]);\n// //       fetchItems();\n// //     } catch (err) {\n// //       console.error(\"Bulk delete error\", err);\n// //       alert(\"Bulk delete failed\");\n// //     }\n// //   };\n\n// //   // ----------------- BULK HELPERS -----------------\n// //   const updateLocalItemField = (id, key, value) => {\n// //     setItems((prev) => prev.map((x) => (x._id === id ? { ...x, [key]: value } : x)));\n// //   };\n\n// //   const handleBulkSave = async () => {\n// //     if (!selectedItems.length) return alert(\"No items selected\");\n// //     const updates = items\n// //       .filter((x) => selectedItems.includes(x._id))\n// //       .map((x) => ({\n// //         id: x._id,\n// //         name: x.name,\n// //         basePrice: x.basePrice,\n// //         difference: x.difference,\n// //         validTill: x.validTill,\n// //       }));\n\n// //     try {\n// //       await axios.post(`${API_URL}/bulk-update`, { products: updates });\n// //       setBulkMode(false);\n// //       setSelectedItems([]);\n// //       fetchItems();\n// //     } catch (err) {\n// //       console.error(\"Bulk save error\", err);\n// //       alert(\"Bulk save failed\");\n// //     }\n// //   };\n\n// //   // ----------------- CSV IMPORT -----------------\n// //   const handleCsvSelect = (e) => setCsvFile(e.target.files[0]);\n\n// //   const handleImportCsv = async () => {\n// //     if (!csvFile) return alert(\"Select CSV\");\n\n// //     const fd = new FormData();\n// //     fd.append(\"file\", csvFile);\n\n// //     try {\n// //       const res = await axios.post(`${API_URL}/import`, fd);\n// //       if (res.data && (res.data.success || res.status === 200)) {\n// //         fetchItems();\n// //         alert(\"CSV Imported!\");\n// //         setCsvFile(null);\n// //         if (csvInputRef.current) csvInputRef.current.value = null;\n// //       } else {\n// //         alert(\"CSV import failed\");\n// //       }\n// //     } catch (err) {\n// //       console.error(\"CSV import error\", err);\n// //       alert(\"CSV import failed\");\n// //     }\n// //   };\n\n// //   // ----------------- CSV EXPORT (ALL) -----------------\n// //   const handleExportCsv = async () => {\n// //     try {\n// //       const res = await axios.get(`${API_URL}/export`, { responseType: \"blob\" });\n// //       const url = window.URL.createObjectURL(new Blob([res.data]));\n// //       const a = document.createElement(\"a\");\n// //       a.href = url;\n// //       a.download = \"prices.csv\";\n// //       a.click();\n// //     } catch (err) {\n// //       console.error(\"CSV export error\", err);\n// //       alert(\"CSV export failed\");\n// //     }\n// //   };\n\n// //   // ----------------- CSV EXPORT (SELECTED) -----------------\n// //   const handleExportSelectedCsv = async () => {\n// //     if (!selectedItems.length) return alert(\"Select items to export\");\n// //     try {\n// //       // Prepare CSV from client side (so server not required)\n// //       const rows = [\n// //         [\"id\", \"name\", \"category\", \"subcategory\", \"basePrice\", \"difference\", \"validTill\", \"status\"]\n// //       ];\n\n// //       const toExport = items.filter((x) => selectedItems.includes(x._id));\n// //       toExport.forEach((it) => {\n// //         rows.push([\n// //           it._id,\n// //           it.name,\n// //           it.category?.name || \"\",\n// //           it.subcategory?.name || \"\",\n// //           it.basePrice ?? \"\",\n// //           it.difference ?? \"\",\n// //           it.validTill ? new Date(it.validTill).toISOString() : \"\",\n// //           it.status || \"\"\n// //         ]);\n// //       });\n\n// //       const csvContent = rows.map((r) => r.map((c) => `\"${String(c).replace(/\"/g, '\"\"')}\"`).join(\",\")).join(\"\\n\");\n// //       const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\n// //       const url = URL.createObjectURL(blob);\n// //       const a = document.createElement(\"a\");\n// //       a.href = url;\n// //       a.download = \"selected_prices.csv\";\n// //       a.click();\n// //       URL.revokeObjectURL(url);\n// //     } catch (err) {\n// //       console.error(\"Selected CSV export failed\", err);\n// //       alert(\"Selected export failed\");\n// //     }\n// //   };\n\n// //   // ----------------- SEARCH FILTER -----------------\n// //   const filteredItems = items.filter((item) => {\n// //     const t = search.toLowerCase();\n// //     return (\n// //       (item.name || \"\").toLowerCase().includes(t) ||\n// //       (item.category?.name || \"\").toLowerCase().includes(t) ||\n// //       (item.subcategory?.name || \"\").toLowerCase().includes(t)\n// //     );\n// //   });\n\n// //   // ----------------- PAGINATION -----------------\n// //   const indexOfLast = currentPage * itemsPerPage;\n// //   const currentItems = filteredItems.slice(indexOfLast - itemsPerPage, indexOfLast);\n// //   const totalPages = Math.ceil(filteredItems.length / itemsPerPage);\n// //   return (\n// //     <div className=\"price-container\">\n\n// //       {/* HEADER */}\n// //       <div className=\"header-section\">\n// //         <h1>üí∞ Product Management</h1>\n// //         <p>Manage prices, categories, images, CSV & bulk actions.</p>\n// //       </div>\n\n// //       {/* SEARCH */}\n// //       <div className=\"search-bar\">\n// //         <input\n// //           type=\"text\"\n// //           placeholder=\"Search product, category or subcategory...\"\n// //           value={search}\n// //           onChange={(e) => {\n// //             setSearch(e.target.value);\n// //             setCurrentPage(1);\n// //           }}\n// //         />\n// //       </div>\n\n// //       {/* BULK BAR */}\n// //       {selectedItems.length > 0 && (\n// //         <div className=\"bulk-bar\">\n// //           <span>{selectedItems.length} selected</span>\n\n// //           {!bulkMode ? (\n// //             <div className=\"bulk-actions\">\n// //               <button className=\"btn delete\" onClick={handleBulkDelete}>\n// //                 üóë Bulk Delete\n// //               </button>\n\n// //               <button className=\"btn primary\" onClick={() => setBulkMode(true)}>\n// //                 ‚úè Bulk Edit\n// //               </button>\n\n// //               <button className=\"btn small\" onClick={handleExportSelectedCsv}>\n// //                 ‚§ì Export Selected\n// //               </button>\n// //             </div>\n// //           ) : (\n// //             <div className=\"bulk-panel\">\n// //               <h3>‚úè Bulk Edit Selected Items</h3>\n\n// //               {items\n// //                 .filter((item) => selectedItems.includes(item._id))\n// //                 .map((item) => (\n// //                   <div key={item._id} className=\"bulk-edit-item-box\">\n// //                     <h4>{item.name}</h4>\n\n// //                     <div className=\"form-grid\">\n// //                       <div className=\"form-group\">\n// //                         <label>Name</label>\n// //                         <input\n// //                           type=\"text\"\n// //                           value={item.name}\n// //                           onChange={(e) =>\n// //                             updateLocalItemField(item._id, \"name\", e.target.value)\n// //                           }\n// //                         />\n// //                       </div>\n\n// //                       <div className=\"form-group\">\n// //                         <label>Base Price</label>\n// //                         <input\n// //                           type=\"number\"\n// //                           value={item.basePrice}\n// //                           onChange={(e) =>\n// //                             updateLocalItemField(\n// //                               item._id,\n// //                               \"basePrice\",\n// //                               Number(e.target.value)\n// //                             )\n// //                           }\n// //                         />\n// //                       </div>\n\n// //                       <div className=\"form-group\">\n// //                         <label>Difference</label>\n// //                         <input\n// //                           type=\"number\"\n// //                           value={item.difference || 0}\n// //                           onChange={(e) =>\n// //                             updateLocalItemField(\n// //                               item._id,\n// //                               \"difference\",\n// //                               Number(e.target.value)\n// //                             )\n// //                           }\n// //                         />\n// //                       </div>\n\n// //                       <div className=\"form-group\">\n// //                         <label>Valid Till</label>\n// //                         <input\n// //                           type=\"date\"\n// //                           value={item.validTill ? item.validTill.split(\"T\")[0] : \"\"}\n// //                           onChange={(e) =>\n// //                             updateLocalItemField(\n// //                               item._id,\n// //                               \"validTill\",\n// //                               e.target.value\n// //                             )\n// //                           }\n// //                         />\n// //                       </div>\n// //                     </div>\n// //                   </div>\n// //                 ))}\n\n// //               <button className=\"btn primary\" onClick={handleBulkSave}>\n// //                 ‚úî Save All\n// //               </button>\n\n// //               <button className=\"btn cancel\" onClick={() => setBulkMode(false)}>\n// //                 ‚úñ Cancel\n// //               </button>\n// //             </div>\n// //           )}\n// //         </div>\n// //       )}\n\n// //       {/* ADD / EDIT FORM */}\n// //       <div className=\"price-form-card\">\n// //         <h2>\n// //           {isCopyMode\n// //             ? \"üìÑ Save Duplicate Product\"\n// //             : editId\n// //             ? \"‚úè Update Product\"\n// //             : \"‚ûï Add Product\"}\n// //         </h2>\n\n// //         <form onSubmit={handleSubmit}>\n// //           <div className=\"form-grid\">\n\n// //             {/* NAME */}\n// //             <div className=\"form-group\">\n// //               <label>Product Name *</label>\n// //               <input\n// //                 required\n// //                 name=\"name\"\n// //                 value={form.name}\n// //                 onChange={handleChange}\n// //               />\n// //             </div>\n\n// //             {/* CATEGORY SELECT */}\n// //             <div className=\"form-group\">\n// //               <label>Category *</label>\n// //               <div className=\"category-row\">\n// //                 <select\n// //                   required\n// //                   name=\"category\"\n// //                   value={form.category}\n// //                   onChange={(e) => {\n// //                     handleChange(e);\n// //                     // when selecting a category, reset subcategory (subcategories state updates via useEffect)\n// //                     setForm((p) => ({ ...p, subcategory: \"\" }));\n// //                   }}\n// //                 >\n// //                   <option value=\"\">Select Category</option>\n// //                   {categories.map((c) => (\n// //                     <option value={c._id} key={c._id}>\n// //                       {c.name}\n// //                     </option>\n// //                   ))}\n// //                 </select>\n\n// //                 <button\n// //                   type=\"button\"\n// //                   className=\"btn small\"\n// //                   onClick={() => setAddingCategory(!addingCategory)}\n// //                 >\n// //                   {addingCategory ? \"Close\" : \"Add\"}\n// //                 </button>\n// //               </div>\n// //             </div>\n\n// //             {/* ADD CATEGORY */}\n// //             {addingCategory && (\n// //               <div className=\"form-group full-width addCategoryBox\">\n// //                 <label>Add New Category</label>\n\n// //                 <div className=\"category-row\">\n// //                   <input\n// //                     value={newCategoryName}\n// //                     onChange={(e) => setNewCategoryName(e.target.value)}\n// //                     placeholder=\"Category name\"\n// //                   />\n\n// //                   <input\n// //                     type=\"file\"\n// //                     accept=\"image/*\"\n// //                     onChange={(e) => {\n// //                       setNewCategoryImage(e.target.files[0]);\n// //                       setNewCategoryPreview(\n// //                         e.target.files[0] ? URL.createObjectURL(e.target.files[0]) : null\n// //                       );\n// //                     }}\n// //                   />\n\n// //                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateCategory}>\n// //                     Create\n// //                   </button>\n// //                 </div>\n\n// //                 {newCategoryPreview && (\n// //                   <img src={newCategoryPreview} className=\"categoryPreview\" alt=\"preview\" />\n// //                 )}\n// //               </div>\n// //             )}\n\n// //             {/* SUBCATEGORY SELECT */}\n// //             <div className=\"form-group\">\n// //               <label>Subcategory</label>\n// //               <div className=\"category-row\">\n// //                 <select\n// //                   name=\"subcategory\"\n// //                   value={form.subcategory}\n// //                   onChange={handleChange}\n// //                   disabled={!subcategories.length}\n// //                 >\n// //                   <option value=\"\">Select Subcategory</option>\n// //                   {subcategories.map((s) => (\n// //                     <option value={s._id} key={s._id}>\n// //                       {s.name}\n// //                     </option>\n// //                   ))}\n// //                 </select>\n\n// //                 {form.category && (\n// //                   <button\n// //                     type=\"button\"\n// //                     className=\"btn small\"\n// //                     onClick={() => setAddingSub(!addingSub)}\n// //                   >\n// //                     {addingSub ? \"Close\" : \"Add\"}\n// //                   </button>\n// //                 )}\n// //               </div>\n// //             </div>\n\n// //             {/* ADD SUBCATEGORY */}\n// //             {addingSub && (\n// //               <div className=\"form-group full-width addCategoryBox\">\n// //                 <label>Add New Subcategory</label>\n\n// //                 <div className=\"category-row\">\n// //                   <input\n// //                     value={newSubName}\n// //                     onChange={(e) => setNewSubName(e.target.value)}\n// //                     placeholder=\"Subcategory name\"\n// //                   />\n\n// //                   <input\n// //                     type=\"file\"\n// //                     accept=\"image/*\"\n// //                     onChange={(e) => {\n// //                       setNewSubImage(e.target.files[0]);\n// //                       setNewSubPreview(\n// //                         e.target.files[0] ? URL.createObjectURL(e.target.files[0]) : null\n// //                       );\n// //                     }}\n// //                   />\n\n// //                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateSub}>\n// //                     Create\n// //                   </button>\n// //                 </div>\n\n// //                 {newSubPreview && (\n// //                   <img src={newSubPreview} className=\"categoryPreview\" alt=\"preview\" />\n// //                 )}\n// //               </div>\n// //             )}\n\n// //             {/* BASE PRICE */}\n// //             <div className=\"form-group\">\n// //               <label>Base Price *</label>\n// //               <input\n// //                 type=\"number\"\n// //                 required\n// //                 name=\"basePrice\"\n// //                 value={form.basePrice}\n// //                 onChange={handleChange}\n// //               />\n// //             </div>\n\n// //             {/* DIFFERENCE */}\n// //             <div className=\"form-group\">\n// //               <label>Difference</label>\n// //               <input\n// //                 type=\"number\"\n// //                 name=\"difference\"\n// //                 value={form.difference}\n// //                 onChange={handleChange}\n// //               />\n// //             </div>\n\n// //             {/* VALID TILL */}\n// //             <div className=\"form-group\">\n// //               <label>Valid Till</label>\n// //               <input\n// //                 type=\"date\"\n// //                 name=\"validTill\"\n// //                 value={form.validTill}\n// //                 onChange={handleChange}\n// //               />\n// //             </div>\n\n// //             {/* IMAGE */}\n// //             <div className=\"form-group\">\n// //               <label>Image</label>\n// //               <input type=\"file\" accept=\"image/*\" onChange={handleChange} />\n// //             </div>\n// //           </div>\n\n// //           {/* DESCRIPTION */}\n// //           <div className=\"form-group full-width\">\n// //             <label>Description</label>\n// //             <textarea\n// //               name=\"description\"\n// //               value={form.description}\n// //               onChange={handleChange}\n// //             ></textarea>\n// //           </div>\n\n// //           {/* SUBMIT BUTTON */}\n// //           <div className=\"form-actions\">\n// //             <button className=\"btn primary\" disabled={loading}>\n// //               {loading\n// //                 ? \"Saving...\"\n// //                 : isCopyMode\n// //                 ? \"Save Copy\"\n// //                 : editId\n// //                 ? \"Update\"\n// //                 : \"Add\"}\n// //             </button>\n\n// //             {(editId || isCopyMode) && (\n// //               <button\n// //                 type=\"button\"\n// //                 className=\"btn cancel\"\n// //                 onClick={() => {\n// //                   setEditId(null);\n// //                   setIsCopyMode(false);\n// //                 }}\n// //               >\n// //                 Cancel\n// //               </button>\n// //             )}\n// //           </div>\n// //         </form>\n// //       </div>\n\n// //       {/* CSV IMPORT EXPORT */}\n// //       <div className=\"csv-controls\">\n// //         <div>\n// //           <input\n// //             type=\"file\"\n// //             accept=\".csv\"\n// //             ref={csvInputRef}\n// //             onChange={handleCsvSelect}\n// //           />\n// //           <button className=\"btn small\" onClick={handleImportCsv}>\n// //             Import CSV\n// //           </button>\n// //         </div>\n\n// //         <div style={{ display: \"flex\", gap: 8 }}>\n// //           <button className=\"btn primary\" onClick={handleExportCsv}>\n// //             Export All CSV\n// //           </button>\n\n// //           <button className=\"btn\" onClick={handleExportSelectedCsv}>\n// //             Export Selected CSV\n// //           </button>\n// //         </div>\n// //       </div>\n\n// //       {/* TABLE */}\n// //       <div className=\"table-card\">\n// //         <div className=\"table-header\">\n// //           <h2>üìã Items</h2>\n// //           <span>Total: {filteredItems.length}</span>\n// //         </div>\n\n// //         {!isMobile ? (\n// //           <table>\n// //             <thead>\n// //               <tr>\n// //                 <th>\n// //                   <input\n// //                     type=\"checkbox\"\n// //                     checked={\n// //                       selectedItems.length === filteredItems.length &&\n// //                       filteredItems.length > 0\n// //                     }\n// //                     onChange={() => {\n// //                       if (selectedItems.length === filteredItems.length)\n// //                         setSelectedItems([]);\n// //                       else\n// //                         setSelectedItems(filteredItems.map((x) => x._id));\n// //                     }}\n// //                   />\n// //                 </th>\n// //                 <th>Sr</th>\n// //                 <th>Image</th>\n// //                 <th>Name</th>\n// //                 <th>Category</th>\n// //                 <th>Subcategory</th>\n// //                 <th>Base</th>\n// //                 <th>Diff</th>\n// //                 <th>Final</th>\n// //                 <th>Status</th>\n// //                 <th>Valid Till</th>\n// //                 <th>Actions</th>\n// //               </tr>\n// //             </thead>\n\n// //             <tbody>\n// //               {currentItems.map((item, i) => (\n// //                 <tr key={item._id}>\n// //                   <td>\n// //                     <input\n// //                       type=\"checkbox\"\n// //                       checked={selectedItems.includes(item._id)}\n// //                       onChange={() =>\n// //                         selectedItems.includes(item._id)\n// //                           ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\n// //                           : setSelectedItems([...selectedItems, item._id])\n// //                       }\n// //                     />\n// //                   </td>\n\n// //                   <td>{(currentPage - 1) * itemsPerPage + (i + 1)}</td>\n\n// //                   <td>{item.image ? <img src={item.image} alt=\"img\" /> : \"No Img\"}</td>\n\n// //                   <td>{item.name}</td>\n\n// //                   <td>{item.category?.name}</td>\n\n// //                   <td>{item.subcategory?.name}</td>\n\n// //                   <td>‚Çπ{item.basePrice}</td>\n\n// //                   <td>{item.difference || 0}</td>\n\n// //                   <td>‚Çπ{Number(item.basePrice) + Number(item.difference || 0)}</td>\n\n// //                   <td>\n// //                     <button\n// //                       className={\n// //                         item.status === \"active\" ? \"status-active\" : \"status-inactive\"\n// //                       }\n// //                       onClick={() => handleStatusToggle(item)}\n// //                     >\n// //                       {item.status === \"active\" ? \"üü¢ Active\" : \"üî¥ Inactive\"}\n// //                     </button>\n// //                   </td>\n\n// //                   <td>\n// //                     {item.validTill\n// //                       ? new Date(item.validTill).toLocaleDateString()\n// //                       : \"-\"}\n// //                   </td>\n\n// //                   <td className=\"actions\">\n// //                     <button className=\"btn edit\" onClick={() => handleEdit(item)}>\n// //                       Edit\n// //                     </button>\n\n// //                     <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\n// //                       Delete\n// //                     </button>\n\n// //                     <button\n// //                       className=\"btn small\"\n// //                       style={{ background: \"#6f42c1\", color: \"#fff\" }}\n// //                       onClick={() => handleCopyToEdit(item)}\n// //                     >\n// //                       Copy\n// //                     </button>\n// //                   </td>\n// //                 </tr>\n// //               ))}\n// //             </tbody>\n// //           </table>\n// //         ) : (\n// //           <div className=\"mobile-list\">\n// //             {currentItems.map((item) => (\n// //               <div key={item._id} className=\"mobile-card\">\n// //                 <input\n// //                   type=\"checkbox\"\n// //                   checked={selectedItems.includes(item._id)}\n// //                   onChange={() =>\n// //                     selectedItems.includes(item._id)\n// //                       ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\n// //                       : setSelectedItems([...selectedItems, item._id])\n// //                   }\n// //                 />\n\n// //                 {item.image ? (\n// //                   <img src={item.image} alt=\"img\" />\n// //                 ) : (\n// //                   <div>No Image</div>\n// //                 )}\n\n// //                 <h3>{item.name}</h3>\n\n// //                 <p>\n// //                   <b>Category:</b> {item.category?.name}\n// //                 </p>\n\n// //                 <p>\n// //                   <b>Subcategory:</b> {item.subcategory?.name || \"-\"}\n// //                 </p>\n\n// //                 <p>\n// //                   <b>Base:</b> ‚Çπ{item.basePrice}\n// //                 </p>\n\n// //                 <p>\n// //                   <b>Final:</b> ‚Çπ\n// //                   {Number(item.basePrice) + Number(item.difference || 0)}\n// //                 </p>\n\n// //                 <button\n// //                   className={\n// //                     item.status === \"active\" ? \"status-active\" : \"status-inactive\"\n// //                   }\n// //                   onClick={() => handleStatusToggle(item)}\n// //                 >\n// //                   {item.status === \"active\" ? \"Active\" : \"Inactive\"}\n// //                 </button>\n\n// //                 <div className=\"actions\">\n// //                   <button className=\"btn edit\" onClick={() => handleEdit(item)}>\n// //                     Edit\n// //                   </button>\n\n// //                   <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\n// //                     Delete\n// //                   </button>\n\n// //                   <button\n// //                     className=\"btn small\"\n// //                     style={{ background: \"#6f42c1\", color: \"#fff\" }}\n// //                     onClick={() => handleCopyToEdit(item)}\n// //                   >\n// //                     Copy\n// //                   </button>\n// //                 </div>\n// //               </div>\n// //             ))}\n// //           </div>\n// //         )}\n\n// //         {/* PAGINATION */}\n// //         <div className=\"pagination\">\n// //           <button\n// //             disabled={currentPage === 1}\n// //             onClick={() => setCurrentPage((p) => p - 1)}\n// //           >\n// //             Previous\n// //           </button>\n\n// //           {Array.from({ length: totalPages }).map((_, i) => (\n// //             <button\n// //               key={i}\n// //               className={i + 1 === currentPage ? \"active-page\" : \"\"}\n// //               onClick={() => setCurrentPage(i + 1)}\n// //             >\n// //               {i + 1}\n// //             </button>\n// //           ))}\n\n// //           <button\n// //             disabled={currentPage === totalPages}\n// //             onClick={() => setCurrentPage((p) => p + 1)}\n// //           >\n// //             Next\n// //           </button>\n// //         </div>\n// //       </div>\n// //     </div>\n// //   );\n// // }\n// // src/components/PriceList.js\n// import React, { useEffect, useState, useRef } from \"react\";\n// import axios from \"axios\";\n// import \"./PriceList.css\";\n\n// const API_URL = \"https://grocerrybackend.vercel.app/api/prices\";\n// const CATEGORY_URL = \"https://grocerrybackend.vercel.app/api/categories\";\n\n// export default function PriceList() {\n//   const [items, setItems] = useState([]);\n//   const [categories, setCategories] = useState([]);\n//   const [subcategories, setSubcategories] = useState([]);\n//   const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\n\n//   const [search, setSearch] = useState(\"\");\n\n//   const [form, setForm] = useState({\n//     name: \"\",\n//     category: \"\",\n//     subcategory: \"\",\n//     description: \"\",\n//     basePrice: \"\",\n//     difference: \"\",\n//     validTill: \"\",\n//     file: null,\n//   });\n\n//   const [editId, setEditId] = useState(null);\n//   const [loading, setLoading] = useState(false);\n//   const [csvFile, setCsvFile] = useState(null);\n\n//   // COPY MODE\n//   const [isCopyMode, setIsCopyMode] = useState(false);\n\n//   // CATEGORY ADD\n//   const [addingCategory, setAddingCategory] = useState(false);\n//   const [newCategoryName, setNewCategoryName] = useState(\"\");\n//   const [newCategoryImage, setNewCategoryImage] = useState(null);\n//   const [newCategoryPreview, setNewCategoryPreview] = useState(null);\n\n//   // SUB CATEGORY ADD\n//   const [addingSub, setAddingSub] = useState(false);\n//   const [newSubName, setNewSubName] = useState(\"\");\n//   const [newSubImage, setNewSubImage] = useState(null);\n//   const [newSubPreview, setNewSubPreview] = useState(null);\n\n//   // BULK\n//   const [selectedItems, setSelectedItems] = useState([]);\n//   const [bulkMode, setBulkMode] = useState(false);\n\n//   const csvInputRef = useRef();\n\n//   // PAGINATION\n//   const [currentPage, setCurrentPage] = useState(1);\n//   const itemsPerPage = 30;\n\n//   // ----------------- FETCH ITEMS & CATEGORIES -----------------\n//   useEffect(() => {\n//     fetchItems();\n//     fetchCategories();\n\n//     const handleResize = () => setIsMobile(window.innerWidth < 768);\n//     window.addEventListener(\"resize\", handleResize);\n//     return () => window.removeEventListener(\"resize\", handleResize);\n//   }, []);\n\n//   const fetchItems = async () => {\n//     try {\n//       setLoading(true);\n//       const res = await axios.get(API_URL);\n//       if (res.data.success) setItems(res.data.data || []);\n//     } catch (err) {\n//       console.log(\"Fetch error\", err);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   const fetchCategories = async () => {\n//     try {\n//       const res = await axios.get(CATEGORY_URL);\n//       if (res.data.success) {\n//         // Expecting API to return categories including subcategories array\n//         setCategories(res.data.categories || []);\n//       }\n//     } catch (err) {\n//       console.log(\"Cat fetch err\", err);\n//     }\n//   };\n\n//   // ----------------- WHEN CATEGORY SELECT ‚Üí LOAD SUBCATEGORIES -----------------\n//   // Improved: keep existing subcategory if it still exists in new subcategory list (important for edit flow)\n//   useEffect(() => {\n//     if (!form.category) {\n//       setSubcategories([]);\n//       setForm((prev) => ({ ...prev, subcategory: \"\" }));\n//       return;\n//     }\n\n//     const categoryObj = categories.find((c) => c._id === form.category);\n//     const newSubs = (categoryObj && categoryObj.subcategories) || [];\n\n//     setSubcategories(newSubs);\n\n//     // If current form.subcategory exists in newSubs, keep it, otherwise reset to \"\"\n//     const exists = newSubs.some((s) => s._id === form.subcategory);\n//     if (!exists) {\n//       setForm((prev) => ({ ...prev, subcategory: \"\" }));\n//     }\n//     // else keep the selected subcategory (important when editing)\n//   }, [form.category, categories]); // run when category changes or categories loaded\n\n//   // ----------------- CREATE CATEGORY -----------------\n//   const handleCreateCategory = async () => {\n//     if (!newCategoryName) return alert(\"Enter category name\");\n\n//     try {\n//       const fd = new FormData();\n//       fd.append(\"name\", newCategoryName);\n//       if (newCategoryImage) fd.append(\"image\", newCategoryImage);\n\n//       const res = await axios.post(CATEGORY_URL, fd);\n\n//       if (res.data.success) {\n//         alert(\"Category Created!\");\n//         setNewCategoryName(\"\");\n//         setNewCategoryImage(null);\n//         setNewCategoryPreview(null);\n//         setAddingCategory(false);\n//         fetchCategories();\n//       }\n//     } catch (err) {\n//       console.log(\"Category create error\", err);\n//       alert(\"Category create failed\");\n//     }\n//   };\n\n//   // ----------------- CREATE SUB CATEGORY -----------------\n//   const handleCreateSub = async () => {\n//     if (!newSubName) return alert(\"Enter subcategory name\");\n//     if (!form.category) return alert(\"Select category first\");\n\n//     try {\n//       const fd = new FormData();\n//       fd.append(\"name\", newSubName);\n//       if (newSubImage) fd.append(\"image\", newSubImage);\n\n//       const res = await axios.post(\n//         `${CATEGORY_URL}/${form.category}/sub`,\n//         fd\n//       );\n\n//       if (res.data.success) {\n//         alert(\"Subcategory Created!\");\n//         setNewSubName(\"\");\n//         setNewSubImage(null);\n//         setNewSubPreview(null);\n//         setAddingSub(false);\n//         fetchCategories();\n//         // after categories refreshed, category useEffect will populate subcategories\n//       }\n//     } catch (err) {\n//       console.log(\"Subcategory create error\", err);\n//       alert(\"Subcategory create failed\");\n//     }\n//   };\n\n//   // ----------------- HANDLE INPUTS -----------------\n//   const handleChange = (e) => {\n//     const { name, value, files } = e.target;\n//     if (files) {\n//       setForm((prev) => ({ ...prev, file: files[0] }));\n//     } else {\n//       setForm((prev) => ({ ...prev, [name]: value }));\n//     }\n//   };\n\n//   // ----------------- SUBMIT FORM -----------------\n//   const handleSubmit = async (e) => {\n//     e.preventDefault();\n//     setLoading(true);\n\n//     try {\n//       if (!form.name || !form.category || !form.basePrice) {\n//         alert(\"Name, category & base price required\");\n//         setLoading(false);\n//         return;\n//       }\n\n//       const fd = new FormData();\n//       // Append only non-empty values\n//       Object.keys(form).forEach((k) => {\n//         const val = form[k];\n//         if (val !== \"\" && val !== null && val !== undefined) {\n//           // For file, append file object\n//           fd.append(k, val);\n//         }\n//       });\n\n//       if (isCopyMode) {\n//         await axios.post(API_URL, fd);\n//         alert(\"Copied as new item!\");\n//       } else if (editId) {\n//         await axios.put(`${API_URL}/${editId}`, fd);\n//       } else {\n//         await axios.post(API_URL, fd);\n//       }\n\n//       // Reset form\n//       setForm({\n//         name: \"\",\n//         category: \"\",\n//         subcategory: \"\",\n//         description: \"\",\n//         basePrice: \"\",\n//         difference: \"\",\n//         validTill: \"\",\n//         file: null,\n//       });\n\n//       setEditId(null);\n//       setIsCopyMode(false);\n//       fetchItems();\n//     } catch (err) {\n//       console.log(\"Save error\", err);\n//       alert(\"Save failed\");\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   // ----------------- EDIT -----------------\n//   const handleEdit = (item) => {\n//     // Set form including subcategory id (string)\n//     setForm({\n//       name: item.name || \"\",\n//       category: item.category?._id?.toString() || \"\",\n//       subcategory: item.subcategory?._id?.toString() || \"\",\n//       description: item.description || \"\",\n//       basePrice: item.basePrice || \"\",\n//       difference: item.difference || 0,\n//       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n//       file: null,\n//     });\n\n//     setIsCopyMode(false);\n//     setEditId(item._id);\n//     // Scroll to top for form visibility\n//     window.scrollTo({ top: 0, behavior: \"smooth\" });\n\n//     // Ensure subcategories for this category are set immediately (if categories are loaded)\n//     const categoryObj = categories.find((c) => c._id === item.category?._id);\n//     if (categoryObj && categoryObj.subcategories) {\n//       setSubcategories(categoryObj.subcategories);\n//       // Keep the selected subcategory (we already set it above)\n//     }\n//   };\n\n//   // ----------------- COPY ‚Üí NEW ENTRY -----------------\n//   const handleCopyToEdit = (item) => {\n//     setForm({\n//       name: item.name || \"\",\n//       category: item.category?._id?.toString() || \"\",\n//       subcategory: item.subcategory?._id?.toString() || \"\",\n//       description: item.description || \"\",\n//       basePrice: item.basePrice || \"\",\n//       difference: item.difference || 0,\n//       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\n//       file: null,\n//     });\n\n//     setEditId(null);\n//     setIsCopyMode(true);\n//     window.scrollTo({ top: 0, behavior: \"smooth\" });\n\n//     // preload subcategories for chosen category\n//     const categoryObj = categories.find((c) => c._id === item.category?._id);\n//     if (categoryObj && categoryObj.subcategories) {\n//       setSubcategories(categoryObj.subcategories);\n//     }\n//   };\n\n//   // ----------------- DELETE -----------------\n//   const handleDelete = async (id) => {\n//     if (!window.confirm(\"Delete?\")) return;\n//     try {\n//       await axios.delete(`${API_URL}/${id}`);\n//       fetchItems();\n//     } catch (err) {\n//       console.error(\"Delete error\", err);\n//       alert(\"Delete failed\");\n//     }\n//   };\n\n//   // ----------------- STATUS TOGGLE -----------------\n//   const handleStatusToggle = async (item) => {\n//     const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\n\n//     try {\n//       await axios.put(`${API_URL}/status/${item._id}`, { status: newStatus });\n//       setItems((prev) =>\n//         prev.map((x) => (x._id === item._id ? { ...x, status: newStatus } : x))\n//       );\n//     } catch (err) {\n//       console.error(\"Status toggle error\", err);\n//       alert(\"Status update failed\");\n//     }\n//   };\n\n//   // ----------------- BULK DELETE -----------------\n//   const handleBulkDelete = async () => {\n//     if (!window.confirm(\"Delete selected items?\")) return;\n\n//     try {\n//       await Promise.all(\n//         selectedItems.map((id) => axios.delete(`${API_URL}/${id}`))\n//       );\n//       setSelectedItems([]);\n//       fetchItems();\n//     } catch (err) {\n//       console.error(\"Bulk delete error\", err);\n//       alert(\"Bulk delete failed\");\n//     }\n//   };\n\n//   // ----------------- BULK HELPERS -----------------\n//   const updateLocalItemField = (id, key, value) => {\n//     setItems((prev) =>\n//       prev.map((x) => (x._id === id ? { ...x, [key]: value } : x))\n//     );\n//   };\n\n//   const handleBulkSave = async () => {\n//     const updates = items\n//       .filter((x) => selectedItems.includes(x._id))\n//       .map((x) => ({\n//         id: x._id,\n//         name: x.name,\n//         basePrice: x.basePrice,\n//         difference: x.difference,\n//         validTill: x.validTill,\n//       }));\n\n//     try {\n//       await axios.post(`${API_URL}/bulk-update`, { products: updates });\n//       setBulkMode(false);\n//       setSelectedItems([]);\n//       fetchItems();\n//     } catch (err) {\n//       console.error(\"Bulk save error\", err);\n//       alert(\"Bulk save failed\");\n//     }\n//   };\n\n//   // ----------------- CSV IMPORT -----------------\n//   const handleCsvSelect = (e) => setCsvFile(e.target.files[0]);\n\n//   const handleImportCsv = async () => {\n//     if (!csvFile) return alert(\"Select CSV\");\n\n//     const fd = new FormData();\n//     fd.append(\"file\", csvFile);\n\n//     try {\n//       const res = await axios.post(`${API_URL}/import`, fd);\n//       if (res.data.success) {\n//         fetchItems();\n//         alert(\"CSV Imported!\");\n//         setCsvFile(null);\n//         if (csvInputRef.current) csvInputRef.current.value = null;\n//       } else {\n//         alert(\"CSV import failed\");\n//       }\n//     } catch (err) {\n//       console.error(\"CSV import error\", err);\n//       alert(\"CSV import failed\");\n//     }\n//   };\n\n//   // ----------------- CSV EXPORT (ALL) -----------------\n//   const handleExportCsv = async () => {\n//     try {\n//       const res = await axios.get(`${API_URL}/export`, { responseType: \"blob\" });\n\n//       const url = window.URL.createObjectURL(new Blob([res.data]));\n//       const a = document.createElement(\"a\");\n//       a.href = url;\n//       a.download = \"prices.csv\";\n//       a.click();\n//     } catch (err) {\n//       console.error(\"CSV export error\", err);\n//       alert(\"CSV export failed\");\n//     }\n//   };\n\n//   // ----------------- CSV EXPORT (SELECTED ONLY) -----------------\n//   const handleExportSelectedCsv = () => {\n//     if (selectedItems.length === 0) {\n//       alert(\"Select at least one item\");\n//       return;\n//     }\n\n//     const selectedData = items.filter((x) => selectedItems.includes(x._id));\n\n//     const rows = [\n//       [\n//         \"name\",\n//         \"categoryName\",\n//         \"subcategoryName\",\n//         \"basePrice\",\n//         \"difference\",\n//         \"finalPrice\",\n//         \"status\",\n//         \"validTill\",\n//         \"description\",\n//         \"imageUrl\",\n//       ],\n//       ...selectedData.map((p) => [\n//         p.name,\n//         p.category?.name || \"\",\n//         p.subcategory?.name || \"\",\n//         p.basePrice,\n//         p.difference || 0,\n//         Number(p.basePrice) + Number(p.difference || 0),\n//         p.status,\n//         p.validTill ? (p.validTill.split ? p.validTill.split(\"T\")[0] : new Date(p.validTill).toISOString().split(\"T\")[0]) : \"\",\n//         p.description || \"\",\n//         p.image || \"\",\n//       ]),\n//     ];\n\n//     const csvContent =\n//       \"data:text/csv;charset=utf-8,\" +\n//       rows.map((e) => e.map((v) => {\n//           // Escape double quotes by doubling them and wrap fields containing comma/newline/quote in quotes\n//           const s = v === null || v === undefined ? \"\" : String(v);\n//           if (s.includes(\",\") || s.includes(\"\\n\") || s.includes('\"')) {\n//             return `\"${s.replace(/\"/g, '\"\"')}\"`;\n//           }\n//           return s;\n//         }).join(\",\")\n//       ).join(\"\\n\");\n\n//     const encodedUri = encodeURI(csvContent);\n//     const link = document.createElement(\"a\");\n//     link.href = encodedUri;\n//     link.download = `selected_prices_${Date.now()}.csv`;\n//     link.click();\n//   };\n\n//   // ----------------- SEARCH FILTER -----------------\n//   const filteredItems = items.filter((item) => {\n//     const t = search.toLowerCase();\n//     return (\n//       (item.name || \"\").toString().toLowerCase().includes(t) ||\n//       (item.category?.name || \"\").toLowerCase().includes(t) ||\n//       (item.subcategory?.name || \"\").toLowerCase().includes(t)\n//     );\n//   });\n\n//   // ----------------- PAGINATION -----------------\n//   const indexOfLast = currentPage * itemsPerPage;\n//   const currentItems = filteredItems.slice(\n//     indexOfLast - itemsPerPage,\n//     indexOfLast\n//   );\n//   const totalPages = Math.ceil(filteredItems.length / itemsPerPage) || 1;\n\n//   return (\n//     <div className=\"price-container\">\n//       {/* HEADER */}\n//       <div className=\"header-section\">\n//         <h1>üí∞ Product Management</h1>\n//         <p>Manage prices, categories, images, CSV & bulk actions.</p>\n//       </div>\n\n//       {/* SEARCH */}\n//       <div className=\"search-bar\">\n//         <input\n//           type=\"text\"\n//           placeholder=\"Search product, category or subcategory...\"\n//           value={search}\n//           onChange={(e) => setSearch(e.target.value)}\n//         />\n//       </div>\n\n//       {/* BULK BAR */}\n//       {selectedItems.length > 0 && (\n//         <div className=\"bulk-bar\">\n//           <span>{selectedItems.length} selected</span>\n\n//           {!bulkMode ? (\n//             <div className=\"bulk-actions\">\n//               <button className=\"btn delete\" onClick={handleBulkDelete}>\n//                 üóë Bulk Delete\n//               </button>\n\n//               <button className=\"btn primary\" onClick={() => setBulkMode(true)}>\n//                 ‚úè Bulk Edit\n//               </button>\n//             </div>\n//           ) : (\n//             <div className=\"bulk-panel\">\n//               <h3>‚úè Bulk Edit Selected Items</h3>\n\n//               {items\n//                 .filter((item) => selectedItems.includes(item._id))\n//                 .map((item) => (\n//                   <div key={item._id} className=\"bulk-edit-item-box\">\n//                     <h4>{item.name}</h4>\n\n//                     <div className=\"form-grid\">\n//                       <div className=\"form-group\">\n//                         <label>Name</label>\n//                         <input\n//                           type=\"text\"\n//                           value={item.name}\n//                           onChange={(e) =>\n//                             updateLocalItemField(item._id, \"name\", e.target.value)\n//                           }\n//                         />\n//                       </div>\n\n//                       <div className=\"form-group\">\n//                         <label>Base Price</label>\n//                         <input\n//                           type=\"number\"\n//                           value={item.basePrice}\n//                           onChange={(e) =>\n//                             updateLocalItemField(\n//                               item._id,\n//                               \"basePrice\",\n//                               Number(e.target.value)\n//                             )\n//                           }\n//                         />\n//                       </div>\n\n//                       <div className=\"form-group\">\n//                         <label>Difference</label>\n//                         <input\n//                           type=\"number\"\n//                           value={item.difference || 0}\n//                           onChange={(e) =>\n//                             updateLocalItemField(\n//                               item._id,\n//                               \"difference\",\n//                               Number(e.target.value)\n//                             )\n//                           }\n//                         />\n//                       </div>\n\n//                       <div className=\"form-group\">\n//                         <label>Valid Till</label>\n//                         <input\n//                           type=\"date\"\n//                           value={item.validTill ? (item.validTill.split ? item.validTill.split(\"T\")[0] : new Date(item.validTill).toISOString().split(\"T\")[0]) : \"\"}\n//                           onChange={(e) =>\n//                             updateLocalItemField(\n//                               item._id,\n//                               \"validTill\",\n//                               e.target.value\n//                             )\n//                           }\n//                         />\n//                       </div>\n//                     </div>\n//                   </div>\n//                 ))}\n\n//               <button className=\"btn primary\" onClick={handleBulkSave}>\n//                 ‚úî Save All\n//               </button>\n\n//               <button className=\"btn cancel\" onClick={() => setBulkMode(false)}>\n//                 ‚úñ Cancel\n//               </button>\n//             </div>\n//           )}\n//         </div>\n//       )}\n\n//       {/* ADD / EDIT FORM */}\n//       <div className=\"price-form-card\">\n//         <h2>\n//           {isCopyMode\n//             ? \"üìÑ Save Duplicate Product\"\n//             : editId\n//             ? \"‚úè Update Product\"\n//             : \"‚ûï Add Product\"}\n//         </h2>\n\n//         <form onSubmit={handleSubmit}>\n//           <div className=\"form-grid\">\n//             {/* NAME */}\n//             <div className=\"form-group\">\n//               <label>Product Name *</label>\n//               <input\n//                 required\n//                 name=\"name\"\n//                 value={form.name}\n//                 onChange={handleChange}\n//               />\n//             </div>\n\n//             {/* CATEGORY SELECT */}\n//             <div className=\"form-group\">\n//               <label>Category *</label>\n//               <div className=\"category-row\">\n//                 <select\n//                   required\n//                   name=\"category\"\n//                   value={form.category}\n//                   onChange={handleChange}\n//                 >\n//                   <option value=\"\">Select Category</option>\n//                   {categories.map((c) => (\n//                     <option value={c._id} key={c._id}>\n//                       {c.name}\n//                     </option>\n//                   ))}\n//                 </select>\n\n//                 <button\n//                   type=\"button\"\n//                   className=\"btn small\"\n//                   onClick={() => setAddingCategory(!addingCategory)}\n//                 >\n//                   {addingCategory ? \"Close\" : \"Add\"}\n//                 </button>\n//               </div>\n//             </div>\n\n//             {/* ADD CATEGORY */}\n//             {addingCategory && (\n//               <div className=\"form-group full-width addCategoryBox\">\n//                 <label>Add New Category</label>\n\n//                 <div className=\"category-row\">\n//                   <input\n//                     value={newCategoryName}\n//                     onChange={(e) => setNewCategoryName(e.target.value)}\n//                     placeholder=\"Category name\"\n//                   />\n\n//                   <input\n//                     type=\"file\"\n//                     accept=\"image/*\"\n//                     onChange={(e) => {\n//                       setNewCategoryImage(e.target.files[0]);\n//                       setNewCategoryPreview(\n//                         e.target.files[0]\n//                           ? URL.createObjectURL(e.target.files[0])\n//                           : null\n//                       );\n//                     }}\n//                   />\n\n//                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateCategory}>\n//                     Create\n//                   </button>\n//                 </div>\n\n//                 {newCategoryPreview && (\n//                   <img src={newCategoryPreview} className=\"categoryPreview\" alt=\"preview\" />\n//                 )}\n//               </div>\n//             )}\n\n//             {/* SUBCATEGORY SELECT */}\n//             <div className=\"form-group\">\n//               <label>Subcategory</label>\n//               <div className=\"category-row\">\n//                 <select\n//                   name=\"subcategory\"\n//                   value={form.subcategory}\n//                   onChange={handleChange}\n//                   disabled={!subcategories.length}\n//                 >\n//                   <option value=\"\">Select Subcategory</option>\n//                   {subcategories.map((s) => (\n//                     <option value={s._id} key={s._id}>\n//                       {s.name}\n//                     </option>\n//                   ))}\n//                 </select>\n\n//                 {form.category && (\n//                   <button\n//                     type=\"button\"\n//                     className=\"btn small\"\n//                     onClick={() => setAddingSub(!addingSub)}\n//                   >\n//                     {addingSub ? \"Close\" : \"Add\"}\n//                   </button>\n//                 )}\n//               </div>\n//             </div>\n\n//             {/* ADD SUBCATEGORY */}\n//             {addingSub && (\n//               <div className=\"form-group full-width addCategoryBox\">\n//                 <label>Add New Subcategory</label>\n\n//                 <div className=\"category-row\">\n//                   <input\n//                     value={newSubName}\n//                     onChange={(e) => setNewSubName(e.target.value)}\n//                     placeholder=\"Subcategory name\"\n//                   />\n\n//                   <input\n//                     type=\"file\"\n//                     accept=\"image/*\"\n//                     onChange={(e) => {\n//                       setNewSubImage(e.target.files[0]);\n//                       setNewSubPreview(\n//                         e.target.files[0]\n//                           ? URL.createObjectURL(e.target.files[0])\n//                           : null\n//                       );\n//                     }}\n//                   />\n\n//                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateSub}>\n//                     Create\n//                   </button>\n//                 </div>\n\n//                 {newSubPreview && (\n//                   <img src={newSubPreview} className=\"categoryPreview\" alt=\"preview\" />\n//                 )}\n//               </div>\n//             )}\n\n//             {/* BASE PRICE */}\n//             <div className=\"form-group\">\n//               <label>Base Price *</label>\n//               <input\n//                 type=\"number\"\n//                 required\n//                 name=\"basePrice\"\n//                 value={form.basePrice}\n//                 onChange={handleChange}\n//               />\n//             </div>\n\n//             {/* DIFFERENCE */}\n//             <div className=\"form-group\">\n//               <label>Difference</label>\n//               <input\n//                 type=\"number\"\n//                 name=\"difference\"\n//                 value={form.difference}\n//                 onChange={handleChange}\n//               />\n//             </div>\n\n//             {/* VALID TILL */}\n//             <div className=\"form-group\">\n//               <label>Valid Till</label>\n//               <input\n//                 type=\"date\"\n//                 name=\"validTill\"\n//                 value={form.validTill}\n//                 onChange={handleChange}\n//               />\n//             </div>\n\n//             {/* IMAGE */}\n//             <div className=\"form-group\">\n//               <label>Image</label>\n//               <input type=\"file\" accept=\"image/*\" onChange={handleChange} />\n//             </div>\n//           </div>\n\n//           {/* DESCRIPTION */}\n//           <div className=\"form-group full-width\">\n//             <label>Description</label>\n//             <textarea\n//               name=\"description\"\n//               value={form.description}\n//               onChange={handleChange}\n//             ></textarea>\n//           </div>\n\n//           {/* SUBMIT BUTTON */}\n//           <div className=\"form-actions\">\n//             <button className=\"btn primary\" disabled={loading}>\n//               {loading\n//                 ? \"Saving...\"\n//                 : isCopyMode\n//                 ? \"Save Copy\"\n//                 : editId\n//                 ? \"Update\"\n//                 : \"Add\"}\n//             </button>\n\n//             {(editId || isCopyMode) && (\n//               <button\n//                 type=\"button\"\n//                 className=\"btn cancel\"\n//                 onClick={() => {\n//                   setEditId(null);\n//                   setIsCopyMode(false);\n//                   setForm({\n//                     name: \"\",\n//                     category: \"\",\n//                     subcategory: \"\",\n//                     description: \"\",\n//                     basePrice: \"\",\n//                     difference: \"\",\n//                     validTill: \"\",\n//                     file: null,\n//                   });\n//                 }}\n//               >\n//                 Cancel\n//               </button>\n//             )}\n//           </div>\n//         </form>\n//       </div>\n\n//       {/* CSV IMPORT EXPORT */}\n//       <div className=\"csv-controls\">\n//         <div>\n//           <input\n//             type=\"file\"\n//             accept=\".csv\"\n//             ref={csvInputRef}\n//             onChange={handleCsvSelect}\n//           />\n//           <button className=\"btn small\" onClick={handleImportCsv}>\n//             Import CSV\n//           </button>\n//         </div>\n\n//         <div>\n//           <button className=\"btn small\" onClick={handleExportCsv}>\n//             Export CSV\n//           </button>\n\n//           <button className=\"btn small\" onClick={handleExportSelectedCsv}>\n//             Export Selected CSV\n//           </button>\n//         </div>\n//       </div>\n\n//       {/* TABLE */}\n//       <div className=\"table-card\">\n//         <div className=\"table-header\">\n//           <h2>üìã Items</h2>\n//           <span>Total: {filteredItems.length}</span>\n//         </div>\n\n//         {!isMobile ? (\n//           <table>\n//             <thead>\n//               <tr>\n//                 <th>\n//                   <input\n//                     type=\"checkbox\"\n//                     checked={\n//                       selectedItems.length === filteredItems.length &&\n//                       filteredItems.length > 0\n//                     }\n//                     onChange={() => {\n//                       if (selectedItems.length === filteredItems.length)\n//                         setSelectedItems([]);\n//                       else\n//                         setSelectedItems(filteredItems.map((x) => x._id));\n//                     }}\n//                   />\n//                 </th>\n//                 <th>Sr</th>\n//                 <th>Image</th>\n//                 <th>Name</th>\n//                 <th>Category</th>\n//                 <th>Subcategory</th>\n//                 <th>Base</th>\n//                 <th>Diff</th>\n//                 <th>Final</th>\n//                 <th>Status</th>\n//                 <th>Valid Till</th>\n//                 <th>Actions</th>\n//               </tr>\n//             </thead>\n\n//             <tbody>\n//               {currentItems.map((item, i) => (\n//                 <tr key={item._id}>\n//                   <td>\n//                     <input\n//                       type=\"checkbox\"\n//                       checked={selectedItems.includes(item._id)}\n//                       onChange={() =>\n//                         selectedItems.includes(item._id)\n//                           ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\n//                           : setSelectedItems([...selectedItems, item._id])\n//                       }\n//                     />\n//                   </td>\n\n//                   <td>{(currentPage - 1) * itemsPerPage + (i + 1)}</td>\n\n//                   <td>{item.image ? <img src={item.image} alt=\"img\" /> : \"No Img\"}</td>\n\n//                   <td>{item.name}</td>\n\n//                   <td>{item.category?.name}</td>\n\n//                   <td>{item.subcategory?.name || \"-\"}</td>\n\n//                   <td>‚Çπ{item.basePrice}</td>\n\n//                   <td>{item.difference || 0}</td>\n\n//                   <td>‚Çπ{Number(item.basePrice) + Number(item.difference || 0)}</td>\n\n//                   <td>\n//                     <button\n//                       className={\n//                         item.status === \"active\" ? \"status-active\" : \"status-inactive\"\n//                       }\n//                       onClick={() => handleStatusToggle(item)}\n//                     >\n//                       {item.status === \"active\" ? \"üü¢ Active\" : \"üî¥ Inactive\"}\n//                     </button>\n//                   </td>\n\n//                   <td>\n//                     {item.validTill\n//                       ? new Date(item.validTill).toLocaleDateString()\n//                       : \"-\"}\n//                   </td>\n\n//                   <td className=\"actions\">\n//                     <button className=\"btn edit\" onClick={() => handleEdit(item)}>\n//                       Edit\n//                     </button>\n\n//                     <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\n//                       Delete\n//                     </button>\n\n//                     <button\n//                       className=\"btn small\"\n//                       style={{ background: \"#6f42c1\", color: \"#fff\" }}\n//                       onClick={() => handleCopyToEdit(item)}\n//                     >\n//                       Copy\n//                     </button>\n//                   </td>\n//                 </tr>\n//               ))}\n//             </tbody>\n//           </table>\n//         ) : (\n//           <div className=\"mobile-list\">\n//             {currentItems.map((item) => (\n//               <div key={item._id} className=\"mobile-card\">\n//                 <input\n//                   type=\"checkbox\"\n//                   checked={selectedItems.includes(item._id)}\n//                   onChange={() =>\n//                     selectedItems.includes(item._id)\n//                       ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\n//                       : setSelectedItems([...selectedItems, item._id])\n//                   }\n//                 />\n\n//                 {item.image ? (\n//                   <img src={item.image} alt=\"img\" />\n//                 ) : (\n//                   <div>No Image</div>\n//                 )}\n\n//                 <h3>{item.name}</h3>\n\n//                 <p>\n//                   <b>Category:</b> {item.category?.name}\n//                 </p>\n\n//                 <p>\n//                   <b>Subcategory:</b> {item.subcategory?.name || \"-\"}\n//                 </p>\n\n//                 <p>\n//                   <b>Base:</b> ‚Çπ{item.basePrice}\n//                 </p>\n\n//                 <p>\n//                   <b>Final:</b> ‚Çπ\n//                   {Number(item.basePrice) + Number(item.difference || 0)}\n//                 </p>\n\n//                 <button\n//                   className={\n//                     item.status === \"active\" ? \"status-active\" : \"status-inactive\"\n//                   }\n//                   onClick={() => handleStatusToggle(item)}\n//                 >\n//                   {item.status === \"active\" ? \"Active\" : \"Inactive\"}\n//                 </button>\n\n//                 <div className=\"actions\">\n//                   <button className=\"btn edit\" onClick={() => handleEdit(item)}>\n//                     Edit\n//                   </button>\n\n//                   <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\n//                     Delete\n//                   </button>\n\n//                   <button\n//                     className=\"btn small\"\n//                     style={{ background: \"#6f42c1\", color: \"#fff\" }}\n//                     onClick={() => handleCopyToEdit(item)}\n//                   >\n//                     Copy\n//                   </button>\n//                 </div>\n//               </div>\n//             ))}\n//           </div>\n//         )}\n\n//         {/* PAGINATION */}\n//         <div className=\"pagination\">\n//           <button\n//             disabled={currentPage === 1}\n//             onClick={() => setCurrentPage((p) => p - 1)}\n//           >\n//             Previous\n//           </button>\n\n//           {Array.from({ length: totalPages }).map((_, i) => (\n//             <button\n//               key={i}\n//               className={i + 1 === currentPage ? \"active-page\" : \"\"}\n//               onClick={() => setCurrentPage(i + 1)}\n//             >\n//               {i + 1}\n//             </button>\n//           ))}\n\n//           <button\n//             disabled={currentPage === totalPages}\n//             onClick={() => setCurrentPage((p) => p + 1)}\n//           >\n//             Next\n//           </button>\n//         </div>\n//       </div>\n//     </div>\n//   );\n// }","map":{"version":3,"names":[],"sources":["E:/infyle/Grocerry_final/frontend/src/pages/PriceList.jsx"],"sourcesContent":["\r\n// // // import React, { useEffect, useState, useRef } from \"react\";\r\n// // // import axios from \"axios\";\r\n// // // import \"./PriceList.css\";\r\n\r\n// // // const API_URL = \"https://grocerrybackend.vercel.app/api/prices\";\r\n// // // const CATEGORY_URL = \"https://grocerrybackend.vercel.app/api/categories\";\r\n\r\n// // // export default function PriceList() {\r\n// // //   const [items, setItems] = useState([]);\r\n// // //   const [categories, setCategories] = useState([]);\r\n// // //   const [subcategories, setSubcategories] = useState([]);\r\n// // //   const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\r\n\r\n// // //   const [search, setSearch] = useState(\"\");\r\n\r\n// // //   const [form, setForm] = useState({\r\n// // //     name: \"\",\r\n// // //     category: \"\",\r\n// // //     subcategory: \"\",\r\n// // //     description: \"\",\r\n// // //     basePrice: \"\",\r\n// // //     difference: \"\",\r\n// // //     validTill: \"\",\r\n// // //     file: null,\r\n// // //   });\r\n\r\n// // //   const [editId, setEditId] = useState(null);\r\n// // //   const [loading, setLoading] = useState(false);\r\n// // //   const [csvFile, setCsvFile] = useState(null);\r\n\r\n// // //   // COPY MODE\r\n// // //   const [isCopyMode, setIsCopyMode] = useState(false);\r\n\r\n// // //   // CATEGORY ADD\r\n// // //   const [addingCategory, setAddingCategory] = useState(false);\r\n// // //   const [newCategoryName, setNewCategoryName] = useState(\"\");\r\n// // //   const [newCategoryImage, setNewCategoryImage] = useState(null);\r\n// // //   const [newCategoryPreview, setNewCategoryPreview] = useState(null);\r\n\r\n// // //   // SUB CATEGORY ADD\r\n// // //   const [addingSub, setAddingSub] = useState(false);\r\n// // //   const [newSubName, setNewSubName] = useState(\"\");\r\n// // //   const [newSubImage, setNewSubImage] = useState(null);\r\n// // //   const [newSubPreview, setNewSubPreview] = useState(null);\r\n\r\n// // //   // BULK\r\n// // //   const [selectedItems, setSelectedItems] = useState([]);\r\n// // //   const [bulkMode, setBulkMode] = useState(false);\r\n\r\n// // //   const csvInputRef = useRef();\r\n\r\n// // //   // PAGINATION\r\n// // //   const [currentPage, setCurrentPage] = useState(1);\r\n// // //   const itemsPerPage = 30;\r\n\r\n// // //   // ----------------- FETCH ITEMS -----------------\r\n// // //   useEffect(() => {\r\n// // //     fetchItems();\r\n// // //     fetchCategories();\r\n\r\n// // //     const handleResize = () => setIsMobile(window.innerWidth < 768);\r\n// // //     window.addEventListener(\"resize\", handleResize);\r\n\r\n// // //     return () => window.removeEventListener(\"resize\", handleResize);\r\n// // //   }, []);\r\n\r\n// // //   const fetchItems = async () => {\r\n// // //     try {\r\n// // //       setLoading(true);\r\n// // //       const res = await axios.get(API_URL);\r\n// // //       if (res.data.success) setItems(res.data.data || []);\r\n// // //     } catch (err) {\r\n// // //       console.log(\"Fetch error\", err);\r\n// // //     } finally {\r\n// // //       setLoading(false);\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   const fetchCategories = async () => {\r\n// // //     try {\r\n// // //       const res = await axios.get(CATEGORY_URL);\r\n// // //       if (res.data.success) {\r\n// // //         setCategories(res.data.categories || []);\r\n// // //       }\r\n// // //     } catch (err) {\r\n// // //       console.log(\"Cat fetch err\", err);\r\n// // //     }\r\n// // //   };\r\n// // //   // ----------------- WHEN CATEGORY SELECT ‚Üí LOAD SUBCATEGORIES -----------------\r\n// // //   useEffect(() => {\r\n// // //     if (!form.category) {\r\n// // //       setSubcategories([]);\r\n// // //       setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n// // //       return;\r\n// // //     }\r\n\r\n// // //     const categoryObj = categories.find((c) => c._id === form.category);\r\n// // //     if (categoryObj && categoryObj.subcategories) {\r\n// // //       setSubcategories(categoryObj.subcategories);\r\n// // //     } else {\r\n// // //       setSubcategories([]);\r\n// // //     }\r\n\r\n// // //     setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n// // //   }, [form.category, categories]);\r\n\r\n// // //   // ----------------- CREATE CATEGORY -----------------\r\n// // //   const handleCreateCategory = async () => {\r\n// // //     if (!newCategoryName) return alert(\"Enter category name\");\r\n\r\n// // //     try {\r\n// // //       const fd = new FormData();\r\n// // //       fd.append(\"name\", newCategoryName);\r\n// // //       if (newCategoryImage) fd.append(\"image\", newCategoryImage);\r\n\r\n// // //       const res = await axios.post(CATEGORY_URL, fd);\r\n\r\n// // //       if (res.data.success) {\r\n// // //         alert(\"Category Created!\");\r\n\r\n// // //         setNewCategoryName(\"\");\r\n// // //         setNewCategoryImage(null);\r\n// // //         setNewCategoryPreview(null);\r\n// // //         setAddingCategory(false);\r\n\r\n// // //         fetchCategories();\r\n// // //       }\r\n// // //     } catch (err) {\r\n// // //       console.log(\"Category create error\", err);\r\n// // //       alert(\"Category create failed\");\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   // ----------------- CREATE SUB CATEGORY -----------------\r\n// // //   const handleCreateSub = async () => {\r\n// // //     if (!newSubName) return alert(\"Enter subcategory name\");\r\n// // //     if (!form.category) return alert(\"Select category first\");\r\n\r\n// // //     try {\r\n// // //       const fd = new FormData();\r\n// // //       fd.append(\"name\", newSubName);\r\n// // //       if (newSubImage) fd.append(\"image\", newSubImage);\r\n\r\n// // //       const res = await axios.post(\r\n// // //         `${CATEGORY_URL}/${form.category}/sub`,\r\n// // //         fd\r\n// // //       );\r\n\r\n// // //       if (res.data.success) {\r\n// // //         alert(\"Subcategory Created!\");\r\n\r\n// // //         setNewSubName(\"\");\r\n// // //         setNewSubImage(null);\r\n// // //         setNewSubPreview(null);\r\n// // //         setAddingSub(false);\r\n\r\n// // //         fetchCategories();\r\n// // //       }\r\n// // //     } catch (err) {\r\n// // //       console.log(\"Subcategory create error\", err);\r\n// // //       alert(\"Subcategory create failed\");\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   // ----------------- HANDLE INPUTS -----------------\r\n// // //   const handleChange = (e) => {\r\n// // //     const { name, value, files } = e.target;\r\n// // //     if (files) setForm({ ...form, file: files[0] });\r\n// // //     else setForm({ ...form, [name]: value });\r\n// // //   };\r\n\r\n// // //   // ----------------- SUBMIT FORM -----------------\r\n// // //   const handleSubmit = async (e) => {\r\n// // //     e.preventDefault();\r\n// // //     setLoading(true);\r\n\r\n// // //     try {\r\n// // //       if (!form.name || !form.category || !form.basePrice) {\r\n// // //         alert(\"Name, category & base price required\");\r\n// // //         return;\r\n// // //       }\r\n\r\n// // //       const fd = new FormData();\r\n// // //       Object.keys(form).forEach((k) => {\r\n// // //         if (form[k] !== \"\" && form[k] !== null) fd.append(k, form[k]);\r\n// // //       });\r\n\r\n// // //       if (isCopyMode) {\r\n// // //         await axios.post(API_URL, fd);\r\n// // //         alert(\"Copied as new item!\");\r\n// // //       } else if (editId) {\r\n// // //         await axios.put(`${API_URL}/${editId}`, fd);\r\n// // //       } else {\r\n// // //         await axios.post(API_URL, fd);\r\n// // //       }\r\n\r\n// // //       setForm({\r\n// // //         name: \"\",\r\n// // //         category: \"\",\r\n// // //         subcategory: \"\",\r\n// // //         description: \"\",\r\n// // //         basePrice: \"\",\r\n// // //         difference: \"\",\r\n// // //         validTill: \"\",\r\n// // //         file: null,\r\n// // //       });\r\n\r\n// // //       setEditId(null);\r\n// // //       setIsCopyMode(false);\r\n// // //       fetchItems();\r\n// // //     } catch (err) {\r\n// // //       console.log(\"Save error\", err);\r\n// // //       alert(\"Save failed\");\r\n// // //     } finally {\r\n// // //       setLoading(false);\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   // ----------------- EDIT -----------------\r\n// // //   const handleEdit = (item) => {\r\n// // //     setForm({\r\n// // //       name: item.name,\r\n// // //       category: item.category?._id?.toString() || \"\",\r\n// // //       subcategory: item.subcategory?._id?.toString() || \"\",\r\n// // //       description: item.description || \"\",\r\n// // //       basePrice: item.basePrice,\r\n// // //       difference: item.difference,\r\n// // //       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n// // //       file: null,\r\n// // //     });\r\n\r\n// // //     setIsCopyMode(false);\r\n// // //     setEditId(item._id);\r\n// // //     window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n// // //   };\r\n\r\n// // //   // ----------------- COPY ‚Üí NEW ENTRY -----------------\r\n// // //   const handleCopyToEdit = (item) => {\r\n// // //     setForm({\r\n// // //       name: item.name,\r\n// // //       category: item.category?._id?.toString() || \"\",\r\n// // //       subcategory: item.subcategory?._id?.toString() || \"\",\r\n// // //       description: item.description || \"\",\r\n// // //       basePrice: item.basePrice,\r\n// // //       difference: item.difference,\r\n// // //       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n// // //       file: null,\r\n// // //     });\r\n\r\n// // //     setEditId(null);\r\n// // //     setIsCopyMode(true);\r\n// // //     window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n// // //   };\r\n// // //   // ----------------- DELETE -----------------\r\n// // //   const handleDelete = async (id) => {\r\n// // //     if (!window.confirm(\"Delete?\")) return;\r\n// // //     try {\r\n// // //       await axios.delete(`${API_URL}/${id}`);\r\n// // //       fetchItems();\r\n// // //     } catch (err) {\r\n// // //       console.error(\"Delete error\", err);\r\n// // //       alert(\"Delete failed\");\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   // ----------------- STATUS TOGGLE -----------------\r\n// // //   const handleStatusToggle = async (item) => {\r\n// // //     const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\r\n\r\n// // //     try {\r\n// // //       await axios.put(`${API_URL}/status/${item._id}`, { status: newStatus });\r\n// // //       setItems((prev) =>\r\n// // //         prev.map((x) => (x._id === item._id ? { ...x, status: newStatus } : x))\r\n// // //       );\r\n// // //     } catch (err) {\r\n// // //       console.error(\"Status toggle error\", err);\r\n// // //       alert(\"Status update failed\");\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   // ----------------- BULK DELETE -----------------\r\n// // //   const handleBulkDelete = async () => {\r\n// // //     if (!window.confirm(\"Delete selected items?\")) return;\r\n\r\n// // //     try {\r\n// // //       await Promise.all(\r\n// // //         selectedItems.map((id) => axios.delete(`${API_URL}/${id}`))\r\n// // //       );\r\n// // //       setSelectedItems([]);\r\n// // //       fetchItems();\r\n// // //     } catch (err) {\r\n// // //       console.error(\"Bulk delete error\", err);\r\n// // //       alert(\"Bulk delete failed\");\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   // ----------------- BULK HELPERS -----------------\r\n// // //   const updateLocalItemField = (id, key, value) => {\r\n// // //     setItems((prev) =>\r\n// // //       prev.map((x) => (x._id === id ? { ...x, [key]: value } : x))\r\n// // //     );\r\n// // //   };\r\n\r\n// // //   const handleBulkSave = async () => {\r\n// // //     const updates = items\r\n// // //       .filter((x) => selectedItems.includes(x._id))\r\n// // //       .map((x) => ({\r\n// // //         id: x._id,\r\n// // //         name: x.name,\r\n// // //         basePrice: x.basePrice,\r\n// // //         difference: x.difference,\r\n// // //         validTill: x.validTill,\r\n// // //       }));\r\n\r\n// // //     try {\r\n// // //       await axios.post(`${API_URL}/bulk-update`, { products: updates });\r\n// // //       setBulkMode(false);\r\n// // //       setSelectedItems([]);\r\n// // //       fetchItems();\r\n// // //     } catch (err) {\r\n// // //       console.error(\"Bulk save error\", err);\r\n// // //       alert(\"Bulk save failed\");\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   // ----------------- CSV IMPORT -----------------\r\n// // //   const handleCsvSelect = (e) => setCsvFile(e.target.files[0]);\r\n\r\n// // //   const handleImportCsv = async () => {\r\n// // //     if (!csvFile) return alert(\"Select CSV\");\r\n\r\n// // //     const fd = new FormData();\r\n// // //     fd.append(\"file\", csvFile);\r\n\r\n// // //     try {\r\n// // //       const res = await axios.post(`${API_URL}/import`, fd);\r\n// // //       if (res.data.success) {\r\n// // //         fetchItems();\r\n// // //         alert(\"CSV Imported!\");\r\n// // //         setCsvFile(null);\r\n// // //         if (csvInputRef.current) csvInputRef.current.value = null;\r\n// // //       } else {\r\n// // //         alert(\"CSV import failed\");\r\n// // //       }\r\n// // //     } catch (err) {\r\n// // //       console.error(\"CSV import error\", err);\r\n// // //       alert(\"CSV import failed\");\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   // ----------------- CSV EXPORT -----------------\r\n// // //   const handleExportCsv = async () => {\r\n// // //     try {\r\n// // //       const res = await axios.get(`${API_URL}/export`, { responseType: \"blob\" });\r\n\r\n// // //       const url = window.URL.createObjectURL(new Blob([res.data]));\r\n// // //       const a = document.createElement(\"a\");\r\n// // //       a.href = url;\r\n// // //       a.download = \"prices.csv\";\r\n// // //       a.click();\r\n// // //     } catch (err) {\r\n// // //       console.error(\"CSV export error\", err);\r\n// // //       alert(\"CSV export failed\");\r\n// // //     }\r\n// // //   };\r\n\r\n// // //   // ----------------- SEARCH FILTER -----------------\r\n// // //   const filteredItems = items.filter((item) => {\r\n// // //     const t = search.toLowerCase();\r\n// // //     return (\r\n// // //       item.name.toLowerCase().includes(t) ||\r\n// // //       item.category?.name?.toLowerCase().includes(t) ||\r\n// // //       item.subcategory?.name?.toLowerCase().includes(t)\r\n// // //     );\r\n// // //   });\r\n\r\n// // //   // ----------------- PAGINATION -----------------\r\n// // //   const indexOfLast = currentPage * itemsPerPage;\r\n// // //   const currentItems = filteredItems.slice(\r\n// // //     indexOfLast - itemsPerPage,\r\n// // //     indexOfLast\r\n// // //   );\r\n// // //   const totalPages = Math.ceil(filteredItems.length / itemsPerPage);\r\n\r\n// // //   return (\r\n// // //     <div className=\"price-container\">\r\n\r\n// // //       {/* HEADER */}\r\n// // //       <div className=\"header-section\">\r\n// // //         <h1>üí∞ Product Management</h1>\r\n// // //         <p>Manage prices, categories, images, CSV & bulk actions.</p>\r\n// // //       </div>\r\n\r\n// // //       {/* SEARCH */}\r\n// // //       <div className=\"search-bar\">\r\n// // //         <input\r\n// // //           type=\"text\"\r\n// // //           placeholder=\"Search product, category or subcategory...\"\r\n// // //           value={search}\r\n// // //           onChange={(e) => setSearch(e.target.value)}\r\n// // //         />\r\n// // //       </div>\r\n\r\n// // //       {/* BULK BAR */}\r\n// // //       {selectedItems.length > 0 && (\r\n// // //         <div className=\"bulk-bar\">\r\n// // //           <span>{selectedItems.length} selected</span>\r\n\r\n// // //           {!bulkMode ? (\r\n// // //             <div className=\"bulk-actions\">\r\n// // //               <button className=\"btn delete\" onClick={handleBulkDelete}>\r\n// // //                 üóë Bulk Delete\r\n// // //               </button>\r\n\r\n// // //               <button className=\"btn primary\" onClick={() => setBulkMode(true)}>\r\n// // //                 ‚úè Bulk Edit\r\n// // //               </button>\r\n// // //             </div>\r\n// // //           ) : (\r\n// // //             <div className=\"bulk-panel\">\r\n// // //               <h3>‚úè Bulk Edit Selected Items</h3>\r\n\r\n// // //               {items\r\n// // //                 .filter((item) => selectedItems.includes(item._id))\r\n// // //                 .map((item) => (\r\n// // //                   <div key={item._id} className=\"bulk-edit-item-box\">\r\n// // //                     <h4>{item.name}</h4>\r\n\r\n// // //                     <div className=\"form-grid\">\r\n// // //                       <div className=\"form-group\">\r\n// // //                         <label>Name</label>\r\n// // //                         <input\r\n// // //                           type=\"text\"\r\n// // //                           value={item.name}\r\n// // //                           onChange={(e) =>\r\n// // //                             updateLocalItemField(item._id, \"name\", e.target.value)\r\n// // //                           }\r\n// // //                         />\r\n// // //                       </div>\r\n\r\n// // //                       <div className=\"form-group\">\r\n// // //                         <label>Base Price</label>\r\n// // //                         <input\r\n// // //                           type=\"number\"\r\n// // //                           value={item.basePrice}\r\n// // //                           onChange={(e) =>\r\n// // //                             updateLocalItemField(\r\n// // //                               item._id,\r\n// // //                               \"basePrice\",\r\n// // //                               Number(e.target.value)\r\n// // //                             )\r\n// // //                           }\r\n// // //                         />\r\n// // //                       </div>\r\n\r\n// // //                       <div className=\"form-group\">\r\n// // //                         <label>Difference</label>\r\n// // //                         <input\r\n// // //                           type=\"number\"\r\n// // //                           value={item.difference || 0}\r\n// // //                           onChange={(e) =>\r\n// // //                             updateLocalItemField(\r\n// // //                               item._id,\r\n// // //                               \"difference\",\r\n// // //                               Number(e.target.value)\r\n// // //                             )\r\n// // //                           }\r\n// // //                         />\r\n// // //                       </div>\r\n\r\n// // //                       <div className=\"form-group\">\r\n// // //                         <label>Valid Till</label>\r\n// // //                         <input\r\n// // //                           type=\"date\"\r\n// // //                           value={item.validTill ? item.validTill.split(\"T\")[0] : \"\"}\r\n// // //                           onChange={(e) =>\r\n// // //                             updateLocalItemField(\r\n// // //                               item._id,\r\n// // //                               \"validTill\",\r\n// // //                               e.target.value\r\n// // //                             )\r\n// // //                           }\r\n// // //                         />\r\n// // //                       </div>\r\n// // //                     </div>\r\n// // //                   </div>\r\n// // //                 ))}\r\n\r\n// // //               <button className=\"btn primary\" onClick={handleBulkSave}>\r\n// // //                 ‚úî Save All\r\n// // //               </button>\r\n\r\n// // //               <button className=\"btn cancel\" onClick={() => setBulkMode(false)}>\r\n// // //                 ‚úñ Cancel\r\n// // //               </button>\r\n// // //             </div>\r\n// // //           )}\r\n// // //         </div>\r\n// // //       )}\r\n\r\n// // //       {/* ADD / EDIT FORM */}\r\n// // //       <div className=\"price-form-card\">\r\n// // //         <h2>\r\n// // //           {isCopyMode\r\n// // //             ? \"üìÑ Save Duplicate Product\"\r\n// // //             : editId\r\n// // //             ? \"‚úè Update Product\"\r\n// // //             : \"‚ûï Add Product\"}\r\n// // //         </h2>\r\n\r\n// // //         <form onSubmit={handleSubmit}>\r\n// // //           <div className=\"form-grid\">\r\n\r\n// // //             {/* NAME */}\r\n// // //             <div className=\"form-group\">\r\n// // //               <label>Product Name *</label>\r\n// // //               <input\r\n// // //                 required\r\n// // //                 name=\"name\"\r\n// // //                 value={form.name}\r\n// // //                 onChange={handleChange}\r\n// // //               />\r\n// // //             </div>\r\n\r\n// // //             {/* CATEGORY SELECT */}\r\n// // //             <div className=\"form-group\">\r\n// // //               <label>Category *</label>\r\n// // //               <div className=\"category-row\">\r\n// // //                 <select\r\n// // //                   required\r\n// // //                   name=\"category\"\r\n// // //                   value={form.category}\r\n// // //                   onChange={handleChange}\r\n// // //                 >\r\n// // //                   <option value=\"\">Select Category</option>\r\n// // //                   {categories.map((c) => (\r\n// // //                     <option value={c._id} key={c._id}>\r\n// // //                       {c.name}\r\n// // //                     </option>\r\n// // //                   ))}\r\n// // //                 </select>\r\n\r\n// // //                 <button\r\n// // //                   type=\"button\"\r\n// // //                   className=\"btn small\"\r\n// // //                   onClick={() => setAddingCategory(!addingCategory)}\r\n// // //                 >\r\n// // //                   {addingCategory ? \"Close\" : \"Add\"}\r\n// // //                 </button>\r\n// // //               </div>\r\n// // //             </div>\r\n\r\n// // //             {/* ADD CATEGORY */}\r\n// // //             {addingCategory && (\r\n// // //               <div className=\"form-group full-width addCategoryBox\">\r\n// // //                 <label>Add New Category</label>\r\n\r\n// // //                 <div className=\"category-row\">\r\n// // //                   <input\r\n// // //                     value={newCategoryName}\r\n// // //                     onChange={(e) => setNewCategoryName(e.target.value)}\r\n// // //                     placeholder=\"Category name\"\r\n// // //                   />\r\n\r\n// // //                   <input\r\n// // //                     type=\"file\"\r\n// // //                     accept=\"image/*\"\r\n// // //                     onChange={(e) => {\r\n// // //                       setNewCategoryImage(e.target.files[0]);\r\n// // //                       setNewCategoryPreview(\r\n// // //                         e.target.files[0]\r\n// // //                           ? URL.createObjectURL(e.target.files[0])\r\n// // //                           : null\r\n// // //                       );\r\n// // //                     }}\r\n// // //                   />\r\n\r\n// // //                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateCategory}>\r\n// // //                     Create\r\n// // //                   </button>\r\n// // //                 </div>\r\n\r\n// // //                 {newCategoryPreview && (\r\n// // //                   <img src={newCategoryPreview} className=\"categoryPreview\" />\r\n// // //                 )}\r\n// // //               </div>\r\n// // //             )}\r\n\r\n// // //             {/* SUBCATEGORY SELECT */}\r\n// // //             <div className=\"form-group\">\r\n// // //               <label>Subcategory</label>\r\n// // //               <div className=\"category-row\">\r\n// // //                 <select\r\n// // //                   name=\"subcategory\"\r\n// // //                   value={form.subcategory}\r\n// // //                   onChange={handleChange}\r\n// // //                   disabled={!subcategories.length}\r\n// // //                 >\r\n// // //                   <option value=\"\">Select Subcategory</option>\r\n// // //                   {subcategories.map((s) => (\r\n// // //                     <option value={s._id} key={s._id}>\r\n// // //                       {s.name}\r\n// // //                     </option>\r\n// // //                   ))}\r\n// // //                 </select>\r\n\r\n// // //                 {form.category && (\r\n// // //                   <button\r\n// // //                     type=\"button\"\r\n// // //                     className=\"btn small\"\r\n// // //                     onClick={() => setAddingSub(!addingSub)}\r\n// // //                   >\r\n// // //                     {addingSub ? \"Close\" : \"Add\"}\r\n// // //                   </button>\r\n// // //                 )}\r\n// // //               </div>\r\n// // //             </div>\r\n\r\n// // //             {/* ADD SUBCATEGORY */}\r\n// // //             {addingSub && (\r\n// // //               <div className=\"form-group full-width addCategoryBox\">\r\n// // //                 <label>Add New Subcategory</label>\r\n\r\n// // //                 <div className=\"category-row\">\r\n// // //                   <input\r\n// // //                     value={newSubName}\r\n// // //                     onChange={(e) => setNewSubName(e.target.value)}\r\n// // //                     placeholder=\"Subcategory name\"\r\n// // //                   />\r\n\r\n// // //                   <input\r\n// // //                     type=\"file\"\r\n// // //                     accept=\"image/*\"\r\n// // //                     onChange={(e) => {\r\n// // //                       setNewSubImage(e.target.files[0]);\r\n// // //                       setNewSubPreview(\r\n// // //                         e.target.files[0]\r\n// // //                           ? URL.createObjectURL(e.target.files[0])\r\n// // //                           : null\r\n// // //                       );\r\n// // //                     }}\r\n// // //                   />\r\n\r\n// // //                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateSub}>\r\n// // //                     Create\r\n// // //                   </button>\r\n// // //                 </div>\r\n\r\n// // //                 {newSubPreview && (\r\n// // //                   <img src={newSubPreview} className=\"categoryPreview\" />\r\n// // //                 )}\r\n// // //               </div>\r\n// // //             )}\r\n\r\n// // //             {/* BASE PRICE */}\r\n// // //             <div className=\"form-group\">\r\n// // //               <label>Base Price *</label>\r\n// // //               <input\r\n// // //                 type=\"number\"\r\n// // //                 required\r\n// // //                 name=\"basePrice\"\r\n// // //                 value={form.basePrice}\r\n// // //                 onChange={handleChange}\r\n// // //               />\r\n// // //             </div>\r\n\r\n// // //             {/* DIFFERENCE */}\r\n// // //             <div className=\"form-group\">\r\n// // //               <label>Difference</label>\r\n// // //               <input\r\n// // //                 type=\"number\"\r\n// // //                 name=\"difference\"\r\n// // //                 value={form.difference}\r\n// // //                 onChange={handleChange}\r\n// // //               />\r\n// // //             </div>\r\n\r\n// // //             {/* VALID TILL */}\r\n// // //             <div className=\"form-group\">\r\n// // //               <label>Valid Till</label>\r\n// // //               <input\r\n// // //                 type=\"date\"\r\n// // //                 name=\"validTill\"\r\n// // //                 value={form.validTill}\r\n// // //                 onChange={handleChange}\r\n// // //               />\r\n// // //             </div>\r\n\r\n// // //             {/* IMAGE */}\r\n// // //             <div className=\"form-group\">\r\n// // //               <label>Image</label>\r\n// // //               <input type=\"file\" accept=\"image/*\" onChange={handleChange} />\r\n// // //             </div>\r\n// // //           </div>\r\n\r\n// // //           {/* DESCRIPTION */}\r\n// // //           <div className=\"form-group full-width\">\r\n// // //             <label>Description</label>\r\n// // //             <textarea\r\n// // //               name=\"description\"\r\n// // //               value={form.description}\r\n// // //               onChange={handleChange}\r\n// // //             ></textarea>\r\n// // //           </div>\r\n\r\n// // //           {/* SUBMIT BUTTON */}\r\n// // //           <div className=\"form-actions\">\r\n// // //             <button className=\"btn primary\" disabled={loading}>\r\n// // //               {loading\r\n// // //                 ? \"Saving...\"\r\n// // //                 : isCopyMode\r\n// // //                 ? \"Save Copy\"\r\n// // //                 : editId\r\n// // //                 ? \"Update\"\r\n// // //                 : \"Add\"}\r\n// // //             </button>\r\n\r\n// // //             {(editId || isCopyMode) && (\r\n// // //               <button\r\n// // //                 type=\"button\"\r\n// // //                 className=\"btn cancel\"\r\n// // //                 onClick={() => {\r\n// // //                   setEditId(null);\r\n// // //                   setIsCopyMode(false);\r\n// // //                 }}\r\n// // //               >\r\n// // //                 Cancel\r\n// // //               </button>\r\n// // //             )}\r\n// // //           </div>\r\n// // //         </form>\r\n// // //       </div>\r\n\r\n// // //       {/* CSV IMPORT EXPORT */}\r\n// // //       <div className=\"csv-controls\">\r\n// // //         <div>\r\n// // //           <input\r\n// // //             type=\"file\"\r\n// // //             accept=\".csv\"\r\n// // //             ref={csvInputRef}\r\n// // //             onChange={handleCsvSelect}\r\n// // //           />\r\n// // //           <button className=\"btn small\" onClick={handleImportCsv}>\r\n// // //             Import CSV\r\n// // //           </button>\r\n// // //         </div>\r\n\r\n// // //         <button className=\"btn primary\" onClick={handleExportCsv}>\r\n// // //           Export CSV\r\n// // //         </button>\r\n// // //       </div>\r\n\r\n// // //       {/* TABLE */}\r\n// // //       <div className=\"table-card\">\r\n// // //         <div className=\"table-header\">\r\n// // //           <h2>üìã Items</h2>\r\n// // //           <span>Total: {filteredItems.length}</span>\r\n// // //         </div>\r\n\r\n// // //         {!isMobile ? (\r\n// // //           <table>\r\n// // //             <thead>\r\n// // //               <tr>\r\n// // //                 <th>\r\n// // //                   <input\r\n// // //                     type=\"checkbox\"\r\n// // //                     checked={\r\n// // //                       selectedItems.length === filteredItems.length &&\r\n// // //                       filteredItems.length > 0\r\n// // //                     }\r\n// // //                     onChange={() => {\r\n// // //                       if (selectedItems.length === filteredItems.length)\r\n// // //                         setSelectedItems([]);\r\n// // //                       else\r\n// // //                         setSelectedItems(filteredItems.map((x) => x._id));\r\n// // //                     }}\r\n// // //                   />\r\n// // //                 </th>\r\n// // //                 <th>Sr</th>\r\n// // //                 <th>Image</th>\r\n// // //                 <th>Name</th>\r\n// // //                 <th>Category</th>\r\n// // //                 <th>Subcategory</th>\r\n// // //                 <th>Base</th>\r\n// // //                 <th>Diff</th>\r\n// // //                 <th>Final</th>\r\n// // //                 <th>Status</th>\r\n// // //                 <th>Valid Till</th>\r\n// // //                 <th>Actions</th>\r\n// // //               </tr>\r\n// // //             </thead>\r\n\r\n// // //             <tbody>\r\n// // //               {currentItems.map((item, i) => (\r\n// // //                 <tr key={item._id}>\r\n// // //                   <td>\r\n// // //                     <input\r\n// // //                       type=\"checkbox\"\r\n// // //                       checked={selectedItems.includes(item._id)}\r\n// // //                       onChange={() =>\r\n// // //                         selectedItems.includes(item._id)\r\n// // //                           ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\r\n// // //                           : setSelectedItems([...selectedItems, item._id])\r\n// // //                       }\r\n// // //                     />\r\n// // //                   </td>\r\n\r\n// // //                   <td>{(currentPage - 1) * itemsPerPage + (i + 1)}</td>\r\n\r\n// // //                   <td>{item.image ? <img src={item.image} alt=\"img\" /> : \"No Img\"}</td>\r\n\r\n// // //                   <td>{item.name}</td>\r\n\r\n// // //                   <td>{item.category?.name}</td>\r\n\r\n// // //                   <td>{item.subcategory?.name || \"-\"}</td>\r\n\r\n// // //                   <td>‚Çπ{item.basePrice}</td>\r\n\r\n// // //                   <td>{item.difference || 0}</td>\r\n\r\n// // //                   <td>‚Çπ{Number(item.basePrice) + Number(item.difference || 0)}</td>\r\n\r\n// // //                   <td>\r\n// // //                     <button\r\n// // //                       className={\r\n// // //                         item.status === \"active\" ? \"status-active\" : \"status-inactive\"\r\n// // //                       }\r\n// // //                       onClick={() => handleStatusToggle(item)}\r\n// // //                     >\r\n// // //                       {item.status === \"active\" ? \"üü¢ Active\" : \"üî¥ Inactive\"}\r\n// // //                     </button>\r\n// // //                   </td>\r\n\r\n// // //                   <td>\r\n// // //                     {item.validTill\r\n// // //                       ? new Date(item.validTill).toLocaleDateString()\r\n// // //                       : \"-\"}\r\n// // //                   </td>\r\n\r\n// // //                   <td className=\"actions\">\r\n// // //                     <button className=\"btn edit\" onClick={() => handleEdit(item)}>\r\n// // //                       Edit\r\n// // //                     </button>\r\n\r\n// // //                     <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\r\n// // //                       Delete\r\n// // //                     </button>\r\n\r\n// // //                     <button\r\n// // //                       className=\"btn small\"\r\n// // //                       style={{ background: \"#6f42c1\", color: \"#fff\" }}\r\n// // //                       onClick={() => handleCopyToEdit(item)}\r\n// // //                     >\r\n// // //                       Copy\r\n// // //                     </button>\r\n// // //                   </td>\r\n// // //                 </tr>\r\n// // //               ))}\r\n// // //             </tbody>\r\n// // //           </table>\r\n// // //         ) : (\r\n// // //           <div className=\"mobile-list\">\r\n// // //             {currentItems.map((item) => (\r\n// // //               <div key={item._id} className=\"mobile-card\">\r\n// // //                 <input\r\n// // //                   type=\"checkbox\"\r\n// // //                   checked={selectedItems.includes(item._id)}\r\n// // //                   onChange={() =>\r\n// // //                     selectedItems.includes(item._id)\r\n// // //                       ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\r\n// // //                       : setSelectedItems([...selectedItems, item._id])\r\n// // //                   }\r\n// // //                 />\r\n\r\n// // //                 {item.image ? (\r\n// // //                   <img src={item.image} alt=\"img\" />\r\n// // //                 ) : (\r\n// // //                   <div>No Image</div>\r\n// // //                 )}\r\n\r\n// // //                 <h3>{item.name}</h3>\r\n\r\n// // //                 <p>\r\n// // //                   <b>Category:</b> {item.category?.name}\r\n// // //                 </p>\r\n\r\n// // //                 <p>\r\n// // //                   <b>Subcategory:</b> {item.subcategory?.name || \"-\"}\r\n// // //                 </p>\r\n\r\n// // //                 <p>\r\n// // //                   <b>Base:</b> ‚Çπ{item.basePrice}\r\n// // //                 </p>\r\n\r\n// // //                 <p>\r\n// // //                   <b>Final:</b> ‚Çπ\r\n// // //                   {Number(item.basePrice) + Number(item.difference || 0)}\r\n// // //                 </p>\r\n\r\n// // //                 <button\r\n// // //                   className={\r\n// // //                     item.status === \"active\" ? \"status-active\" : \"status-inactive\"\r\n// // //                   }\r\n// // //                   onClick={() => handleStatusToggle(item)}\r\n// // //                 >\r\n// // //                   {item.status === \"active\" ? \"Active\" : \"Inactive\"}\r\n// // //                 </button>\r\n\r\n// // //                 <div className=\"actions\">\r\n// // //                   <button className=\"btn edit\" onClick={() => handleEdit(item)}>\r\n// // //                     Edit\r\n// // //                   </button>\r\n\r\n// // //                   <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\r\n// // //                     Delete\r\n// // //                   </button>\r\n\r\n// // //                   <button\r\n// // //                     className=\"btn small\"\r\n// // //                     style={{ background: \"#6f42c1\", color: \"#fff\" }}\r\n// // //                     onClick={() => handleCopyToEdit(item)}\r\n// // //                   >\r\n// // //                     Copy\r\n// // //                   </button>\r\n// // //                 </div>\r\n// // //               </div>\r\n// // //             ))}\r\n// // //           </div>\r\n// // //         )}\r\n\r\n// // //         {/* PAGINATION */}\r\n// // //         <div className=\"pagination\">\r\n// // //           <button\r\n// // //             disabled={currentPage === 1}\r\n// // //             onClick={() => setCurrentPage((p) => p - 1)}\r\n// // //           >\r\n// // //             Previous\r\n// // //           </button>\r\n\r\n// // //           {Array.from({ length: totalPages }).map((_, i) => (\r\n// // //             <button\r\n// // //               key={i}\r\n// // //               className={i + 1 === currentPage ? \"active-page\" : \"\"}\r\n// // //               onClick={() => setCurrentPage(i + 1)}\r\n// // //             >\r\n// // //               {i + 1}\r\n// // //             </button>\r\n// // //           ))}\r\n\r\n// // //           <button\r\n// // //             disabled={currentPage === totalPages}\r\n// // //             onClick={() => setCurrentPage((p) => p + 1)}\r\n// // //           >\r\n// // //             Next\r\n// // //           </button>\r\n// // //         </div>\r\n// // //       </div>\r\n// // //     </div>\r\n// // //   );\r\n// // // }\r\n// // import React, { useEffect, useState, useRef } from \"react\";\r\n// // import axios from \"axios\";\r\n// // import \"./PriceList.css\";\r\n\r\n// // const API_URL = \"https://grocerrybackend.vercel.app/api/prices\";\r\n// // const CATEGORY_URL = \"https://grocerrybackend.vercel.app/api/categories\";\r\n\r\n// // export default function PriceList() {\r\n// //   const [items, setItems] = useState([]);\r\n// //   const [categories, setCategories] = useState([]);\r\n// //   const [subcategories, setSubcategories] = useState([]);\r\n// //   const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\r\n\r\n// //   const [search, setSearch] = useState(\"\");\r\n\r\n// //   const [form, setForm] = useState({\r\n// //     name: \"\",\r\n// //     category: \"\",\r\n// //     subcategory: \"\",\r\n// //     description: \"\",\r\n// //     basePrice: \"\",\r\n// //     difference: \"\",\r\n// //     validTill: \"\",\r\n// //     file: null,\r\n// //   });\r\n\r\n// //   const [editId, setEditId] = useState(null);\r\n// //   const [loading, setLoading] = useState(false);\r\n// //   const [csvFile, setCsvFile] = useState(null);\r\n\r\n// //   // COPY MODE\r\n// //   const [isCopyMode, setIsCopyMode] = useState(false);\r\n\r\n// //   // CATEGORY ADD\r\n// //   const [addingCategory, setAddingCategory] = useState(false);\r\n// //   const [newCategoryName, setNewCategoryName] = useState(\"\");\r\n// //   const [newCategoryImage, setNewCategoryImage] = useState(null);\r\n// //   const [newCategoryPreview, setNewCategoryPreview] = useState(null);\r\n\r\n// //   // SUB CATEGORY ADD\r\n// //   const [addingSub, setAddingSub] = useState(false);\r\n// //   const [newSubName, setNewSubName] = useState(\"\");\r\n// //   const [newSubImage, setNewSubImage] = useState(null);\r\n// //   const [newSubPreview, setNewSubPreview] = useState(null);\r\n\r\n// //   // BULK\r\n// //   const [selectedItems, setSelectedItems] = useState([]);\r\n// //   const [bulkMode, setBulkMode] = useState(false);\r\n\r\n// //   const csvInputRef = useRef();\r\n\r\n// //   // PAGINATION\r\n// //   const [currentPage, setCurrentPage] = useState(1);\r\n// //   const itemsPerPage = 30;\r\n\r\n// //   // ----------------- FETCH ITEMS -----------------\r\n// //   useEffect(() => {\r\n// //     fetchItems();\r\n// //     fetchCategories();\r\n\r\n// //     const handleResize = () => setIsMobile(window.innerWidth < 768);\r\n// //     window.addEventListener(\"resize\", handleResize);\r\n\r\n// //     return () => window.removeEventListener(\"resize\", handleResize);\r\n// //   }, []);\r\n\r\n// //   const fetchItems = async () => {\r\n// //     try {\r\n// //       setLoading(true);\r\n// //       const res = await axios.get(API_URL);\r\n// //       if (res.data.success) setItems(res.data.data || []);\r\n// //     } catch (err) {\r\n// //       console.log(\"Fetch error\", err);\r\n// //     } finally {\r\n// //       setLoading(false);\r\n// //     }\r\n// //   };\r\n\r\n// //   const fetchCategories = async () => {\r\n// //     try {\r\n// //       const res = await axios.get(CATEGORY_URL);\r\n// //       if (res.data.success) {\r\n// //         setCategories(res.data.categories || []);\r\n// //       }\r\n// //     } catch (err) {\r\n// //       console.log(\"Cat fetch err\", err);\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- WHEN CATEGORY SELECT ‚Üí LOAD SUBCATEGORIES -----------------\r\n// //   useEffect(() => {\r\n// //     if (!form.category) {\r\n// //       setSubcategories([]);\r\n// //       setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n// //       return;\r\n// //     }\r\n\r\n// //     const categoryObj = categories.find((c) => c._id === form.category);\r\n// //     setSubcategories(categoryObj?.subcategories || []);\r\n\r\n// //     setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n// //   }, [form.category, categories]);\r\n// //   // ----------------- CREATE CATEGORY -----------------\r\n// //   const handleCreateCategory = async () => {\r\n// //     if (!newCategoryName.trim()) return alert(\"Enter category name\");\r\n\r\n// //     try {\r\n// //       const fd = new FormData();\r\n// //       fd.append(\"name\", newCategoryName.trim());\r\n// //       if (newCategoryImage) fd.append(\"image\", newCategoryImage);\r\n\r\n// //       const res = await axios.post(CATEGORY_URL, fd);\r\n// //       if (res.data && (res.data.success || res.status === 200)) {\r\n// //         alert(\"Category Created!\");\r\n// //         setNewCategoryName(\"\");\r\n// //         setNewCategoryImage(null);\r\n// //         setNewCategoryPreview(null);\r\n// //         setAddingCategory(false);\r\n// //         fetchCategories();\r\n// //       } else {\r\n// //         alert(\"Category create failed\");\r\n// //       }\r\n// //     } catch (err) {\r\n// //       console.error(\"Category create error\", err);\r\n// //       alert(\"Category create failed\");\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- CREATE SUB CATEGORY -----------------\r\n// //   const handleCreateSub = async () => {\r\n// //     if (!newSubName.trim()) return alert(\"Enter subcategory name\");\r\n// //     if (!form.category) return alert(\"Select category first\");\r\n\r\n// //     try {\r\n// //       const fd = new FormData();\r\n// //       fd.append(\"name\", newSubName.trim());\r\n// //       if (newSubImage) fd.append(\"image\", newSubImage);\r\n\r\n// //       const res = await axios.post(`${CATEGORY_URL}/${form.category}/sub`, fd);\r\n// //       if (res.data && (res.data.success || res.status === 200)) {\r\n// //         alert(\"Subcategory Created!\");\r\n// //         setNewSubName(\"\");\r\n// //         setNewSubImage(null);\r\n// //         setNewSubPreview(null);\r\n// //         setAddingSub(false);\r\n// //         fetchCategories();\r\n// //       } else {\r\n// //         alert(\"Subcategory create failed\");\r\n// //       }\r\n// //     } catch (err) {\r\n// //       console.error(\"Subcategory create error\", err);\r\n// //       alert(\"Subcategory create failed\");\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- HANDLE INPUTS -----------------\r\n// //   const handleChange = (e) => {\r\n// //     const { name, value, files } = e.target;\r\n// //     if (files && files.length) {\r\n// //       setForm((p) => ({ ...p, file: files[0] }));\r\n// //     } else {\r\n// //       setForm((p) => ({ ...p, [name]: value }));\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- SUBMIT FORM (ADD / UPDATE PRODUCT) -----------------\r\n// //   const handleSubmit = async (e) => {\r\n// //     e.preventDefault();\r\n// //     setLoading(true);\r\n// //     try {\r\n// //       if (!form.name || !form.category || !form.basePrice) {\r\n// //         alert(\"Name, category & base price required\");\r\n// //         setLoading(false);\r\n// //         return;\r\n// //       }\r\n\r\n// //       const fd = new FormData();\r\n// //       Object.keys(form).forEach((k) => {\r\n// //         if (form[k] !== \"\" && form[k] !== null) fd.append(k, form[k]);\r\n// //       });\r\n\r\n// //       let res;\r\n// //       if (isCopyMode) {\r\n// //         res = await axios.post(API_URL, fd);\r\n// //         alert(\"Copied as new item!\");\r\n// //       } else if (editId) {\r\n// //         res = await axios.put(`${API_URL}/${editId}`, fd);\r\n// //         alert(\"Updated!\");\r\n// //       } else {\r\n// //         res = await axios.post(API_URL, fd);\r\n// //         alert(\"Added!\");\r\n// //       }\r\n\r\n// //       // Reset\r\n// //       setForm({\r\n// //         name: \"\",\r\n// //         category: \"\",\r\n// //         subcategory: \"\",\r\n// //         description: \"\",\r\n// //         basePrice: \"\",\r\n// //         difference: \"\",\r\n// //         validTill: \"\",\r\n// //         file: null,\r\n// //       });\r\n// //       setEditId(null);\r\n// //       setIsCopyMode(false);\r\n// //       fetchItems();\r\n// //     } catch (err) {\r\n// //       console.error(\"Save error\", err);\r\n// //       alert(\"Save failed\");\r\n// //     } finally {\r\n// //       setLoading(false);\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- EDIT -----------------\r\n// //   const handleEdit = (item) => {\r\n// //     setForm({\r\n// //       name: item.name || \"\",\r\n// //       category: item.category?._id?.toString() || \"\",\r\n// //       subcategory: item.subcategory?._id?.toString() || \"\",\r\n// //       description: item.description || \"\",\r\n// //       basePrice: item.basePrice || \"\",\r\n// //       difference: item.difference || \"\",\r\n// //       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n// //       file: null,\r\n// //     });\r\n\r\n// //     setIsCopyMode(false);\r\n// //     setEditId(item._id);\r\n// //     window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n// //   };\r\n\r\n// //   // ----------------- COPY ‚Üí NEW ENTRY -----------------\r\n// //   const handleCopyToEdit = (item) => {\r\n// //     setForm({\r\n// //       name: item.name || \"\",\r\n// //       category: item.category?._id?.toString() || \"\",\r\n// //       subcategory: item.subcategory?._id?.toString() || \"\",\r\n// //       description: item.description || \"\",\r\n// //       basePrice: item.basePrice || \"\",\r\n// //       difference: item.difference || \"\",\r\n// //       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n// //       file: null,\r\n// //     });\r\n\r\n// //     setEditId(null);\r\n// //     setIsCopyMode(true);\r\n// //     window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n// //   };\r\n\r\n// //   // ----------------- DELETE -----------------\r\n// //   const handleDelete = async (id) => {\r\n// //     if (!window.confirm(\"Delete?\")) return;\r\n// //     try {\r\n// //       await axios.delete(`${API_URL}/${id}`);\r\n// //       fetchItems();\r\n// //     } catch (err) {\r\n// //       console.error(\"Delete error\", err);\r\n// //       alert(\"Delete failed\");\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- STATUS TOGGLE -----------------\r\n// //   const handleStatusToggle = async (item) => {\r\n// //     const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\r\n// //     try {\r\n// //       await axios.put(`${API_URL}/status/${item._id}`, { status: newStatus });\r\n// //       setItems((prev) =>\r\n// //         prev.map((x) => (x._id === item._id ? { ...x, status: newStatus } : x))\r\n// //       );\r\n// //     } catch (err) {\r\n// //       console.error(\"Status toggle error\", err);\r\n// //       alert(\"Status update failed\");\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- BULK DELETE -----------------\r\n// //   const handleBulkDelete = async () => {\r\n// //     if (!selectedItems.length) return alert(\"No items selected\");\r\n// //     if (!window.confirm(\"Delete selected items?\")) return;\r\n\r\n// //     try {\r\n// //       await Promise.all(selectedItems.map((id) => axios.delete(`${API_URL}/${id}`)));\r\n// //       setSelectedItems([]);\r\n// //       fetchItems();\r\n// //     } catch (err) {\r\n// //       console.error(\"Bulk delete error\", err);\r\n// //       alert(\"Bulk delete failed\");\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- BULK HELPERS -----------------\r\n// //   const updateLocalItemField = (id, key, value) => {\r\n// //     setItems((prev) => prev.map((x) => (x._id === id ? { ...x, [key]: value } : x)));\r\n// //   };\r\n\r\n// //   const handleBulkSave = async () => {\r\n// //     if (!selectedItems.length) return alert(\"No items selected\");\r\n// //     const updates = items\r\n// //       .filter((x) => selectedItems.includes(x._id))\r\n// //       .map((x) => ({\r\n// //         id: x._id,\r\n// //         name: x.name,\r\n// //         basePrice: x.basePrice,\r\n// //         difference: x.difference,\r\n// //         validTill: x.validTill,\r\n// //       }));\r\n\r\n// //     try {\r\n// //       await axios.post(`${API_URL}/bulk-update`, { products: updates });\r\n// //       setBulkMode(false);\r\n// //       setSelectedItems([]);\r\n// //       fetchItems();\r\n// //     } catch (err) {\r\n// //       console.error(\"Bulk save error\", err);\r\n// //       alert(\"Bulk save failed\");\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- CSV IMPORT -----------------\r\n// //   const handleCsvSelect = (e) => setCsvFile(e.target.files[0]);\r\n\r\n// //   const handleImportCsv = async () => {\r\n// //     if (!csvFile) return alert(\"Select CSV\");\r\n\r\n// //     const fd = new FormData();\r\n// //     fd.append(\"file\", csvFile);\r\n\r\n// //     try {\r\n// //       const res = await axios.post(`${API_URL}/import`, fd);\r\n// //       if (res.data && (res.data.success || res.status === 200)) {\r\n// //         fetchItems();\r\n// //         alert(\"CSV Imported!\");\r\n// //         setCsvFile(null);\r\n// //         if (csvInputRef.current) csvInputRef.current.value = null;\r\n// //       } else {\r\n// //         alert(\"CSV import failed\");\r\n// //       }\r\n// //     } catch (err) {\r\n// //       console.error(\"CSV import error\", err);\r\n// //       alert(\"CSV import failed\");\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- CSV EXPORT (ALL) -----------------\r\n// //   const handleExportCsv = async () => {\r\n// //     try {\r\n// //       const res = await axios.get(`${API_URL}/export`, { responseType: \"blob\" });\r\n// //       const url = window.URL.createObjectURL(new Blob([res.data]));\r\n// //       const a = document.createElement(\"a\");\r\n// //       a.href = url;\r\n// //       a.download = \"prices.csv\";\r\n// //       a.click();\r\n// //     } catch (err) {\r\n// //       console.error(\"CSV export error\", err);\r\n// //       alert(\"CSV export failed\");\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- CSV EXPORT (SELECTED) -----------------\r\n// //   const handleExportSelectedCsv = async () => {\r\n// //     if (!selectedItems.length) return alert(\"Select items to export\");\r\n// //     try {\r\n// //       // Prepare CSV from client side (so server not required)\r\n// //       const rows = [\r\n// //         [\"id\", \"name\", \"category\", \"subcategory\", \"basePrice\", \"difference\", \"validTill\", \"status\"]\r\n// //       ];\r\n\r\n// //       const toExport = items.filter((x) => selectedItems.includes(x._id));\r\n// //       toExport.forEach((it) => {\r\n// //         rows.push([\r\n// //           it._id,\r\n// //           it.name,\r\n// //           it.category?.name || \"\",\r\n// //           it.subcategory?.name || \"\",\r\n// //           it.basePrice ?? \"\",\r\n// //           it.difference ?? \"\",\r\n// //           it.validTill ? new Date(it.validTill).toISOString() : \"\",\r\n// //           it.status || \"\"\r\n// //         ]);\r\n// //       });\r\n\r\n// //       const csvContent = rows.map((r) => r.map((c) => `\"${String(c).replace(/\"/g, '\"\"')}\"`).join(\",\")).join(\"\\n\");\r\n// //       const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n// //       const url = URL.createObjectURL(blob);\r\n// //       const a = document.createElement(\"a\");\r\n// //       a.href = url;\r\n// //       a.download = \"selected_prices.csv\";\r\n// //       a.click();\r\n// //       URL.revokeObjectURL(url);\r\n// //     } catch (err) {\r\n// //       console.error(\"Selected CSV export failed\", err);\r\n// //       alert(\"Selected export failed\");\r\n// //     }\r\n// //   };\r\n\r\n// //   // ----------------- SEARCH FILTER -----------------\r\n// //   const filteredItems = items.filter((item) => {\r\n// //     const t = search.toLowerCase();\r\n// //     return (\r\n// //       (item.name || \"\").toLowerCase().includes(t) ||\r\n// //       (item.category?.name || \"\").toLowerCase().includes(t) ||\r\n// //       (item.subcategory?.name || \"\").toLowerCase().includes(t)\r\n// //     );\r\n// //   });\r\n\r\n// //   // ----------------- PAGINATION -----------------\r\n// //   const indexOfLast = currentPage * itemsPerPage;\r\n// //   const currentItems = filteredItems.slice(indexOfLast - itemsPerPage, indexOfLast);\r\n// //   const totalPages = Math.ceil(filteredItems.length / itemsPerPage);\r\n// //   return (\r\n// //     <div className=\"price-container\">\r\n\r\n// //       {/* HEADER */}\r\n// //       <div className=\"header-section\">\r\n// //         <h1>üí∞ Product Management</h1>\r\n// //         <p>Manage prices, categories, images, CSV & bulk actions.</p>\r\n// //       </div>\r\n\r\n// //       {/* SEARCH */}\r\n// //       <div className=\"search-bar\">\r\n// //         <input\r\n// //           type=\"text\"\r\n// //           placeholder=\"Search product, category or subcategory...\"\r\n// //           value={search}\r\n// //           onChange={(e) => {\r\n// //             setSearch(e.target.value);\r\n// //             setCurrentPage(1);\r\n// //           }}\r\n// //         />\r\n// //       </div>\r\n\r\n// //       {/* BULK BAR */}\r\n// //       {selectedItems.length > 0 && (\r\n// //         <div className=\"bulk-bar\">\r\n// //           <span>{selectedItems.length} selected</span>\r\n\r\n// //           {!bulkMode ? (\r\n// //             <div className=\"bulk-actions\">\r\n// //               <button className=\"btn delete\" onClick={handleBulkDelete}>\r\n// //                 üóë Bulk Delete\r\n// //               </button>\r\n\r\n// //               <button className=\"btn primary\" onClick={() => setBulkMode(true)}>\r\n// //                 ‚úè Bulk Edit\r\n// //               </button>\r\n\r\n// //               <button className=\"btn small\" onClick={handleExportSelectedCsv}>\r\n// //                 ‚§ì Export Selected\r\n// //               </button>\r\n// //             </div>\r\n// //           ) : (\r\n// //             <div className=\"bulk-panel\">\r\n// //               <h3>‚úè Bulk Edit Selected Items</h3>\r\n\r\n// //               {items\r\n// //                 .filter((item) => selectedItems.includes(item._id))\r\n// //                 .map((item) => (\r\n// //                   <div key={item._id} className=\"bulk-edit-item-box\">\r\n// //                     <h4>{item.name}</h4>\r\n\r\n// //                     <div className=\"form-grid\">\r\n// //                       <div className=\"form-group\">\r\n// //                         <label>Name</label>\r\n// //                         <input\r\n// //                           type=\"text\"\r\n// //                           value={item.name}\r\n// //                           onChange={(e) =>\r\n// //                             updateLocalItemField(item._id, \"name\", e.target.value)\r\n// //                           }\r\n// //                         />\r\n// //                       </div>\r\n\r\n// //                       <div className=\"form-group\">\r\n// //                         <label>Base Price</label>\r\n// //                         <input\r\n// //                           type=\"number\"\r\n// //                           value={item.basePrice}\r\n// //                           onChange={(e) =>\r\n// //                             updateLocalItemField(\r\n// //                               item._id,\r\n// //                               \"basePrice\",\r\n// //                               Number(e.target.value)\r\n// //                             )\r\n// //                           }\r\n// //                         />\r\n// //                       </div>\r\n\r\n// //                       <div className=\"form-group\">\r\n// //                         <label>Difference</label>\r\n// //                         <input\r\n// //                           type=\"number\"\r\n// //                           value={item.difference || 0}\r\n// //                           onChange={(e) =>\r\n// //                             updateLocalItemField(\r\n// //                               item._id,\r\n// //                               \"difference\",\r\n// //                               Number(e.target.value)\r\n// //                             )\r\n// //                           }\r\n// //                         />\r\n// //                       </div>\r\n\r\n// //                       <div className=\"form-group\">\r\n// //                         <label>Valid Till</label>\r\n// //                         <input\r\n// //                           type=\"date\"\r\n// //                           value={item.validTill ? item.validTill.split(\"T\")[0] : \"\"}\r\n// //                           onChange={(e) =>\r\n// //                             updateLocalItemField(\r\n// //                               item._id,\r\n// //                               \"validTill\",\r\n// //                               e.target.value\r\n// //                             )\r\n// //                           }\r\n// //                         />\r\n// //                       </div>\r\n// //                     </div>\r\n// //                   </div>\r\n// //                 ))}\r\n\r\n// //               <button className=\"btn primary\" onClick={handleBulkSave}>\r\n// //                 ‚úî Save All\r\n// //               </button>\r\n\r\n// //               <button className=\"btn cancel\" onClick={() => setBulkMode(false)}>\r\n// //                 ‚úñ Cancel\r\n// //               </button>\r\n// //             </div>\r\n// //           )}\r\n// //         </div>\r\n// //       )}\r\n\r\n// //       {/* ADD / EDIT FORM */}\r\n// //       <div className=\"price-form-card\">\r\n// //         <h2>\r\n// //           {isCopyMode\r\n// //             ? \"üìÑ Save Duplicate Product\"\r\n// //             : editId\r\n// //             ? \"‚úè Update Product\"\r\n// //             : \"‚ûï Add Product\"}\r\n// //         </h2>\r\n\r\n// //         <form onSubmit={handleSubmit}>\r\n// //           <div className=\"form-grid\">\r\n\r\n// //             {/* NAME */}\r\n// //             <div className=\"form-group\">\r\n// //               <label>Product Name *</label>\r\n// //               <input\r\n// //                 required\r\n// //                 name=\"name\"\r\n// //                 value={form.name}\r\n// //                 onChange={handleChange}\r\n// //               />\r\n// //             </div>\r\n\r\n// //             {/* CATEGORY SELECT */}\r\n// //             <div className=\"form-group\">\r\n// //               <label>Category *</label>\r\n// //               <div className=\"category-row\">\r\n// //                 <select\r\n// //                   required\r\n// //                   name=\"category\"\r\n// //                   value={form.category}\r\n// //                   onChange={(e) => {\r\n// //                     handleChange(e);\r\n// //                     // when selecting a category, reset subcategory (subcategories state updates via useEffect)\r\n// //                     setForm((p) => ({ ...p, subcategory: \"\" }));\r\n// //                   }}\r\n// //                 >\r\n// //                   <option value=\"\">Select Category</option>\r\n// //                   {categories.map((c) => (\r\n// //                     <option value={c._id} key={c._id}>\r\n// //                       {c.name}\r\n// //                     </option>\r\n// //                   ))}\r\n// //                 </select>\r\n\r\n// //                 <button\r\n// //                   type=\"button\"\r\n// //                   className=\"btn small\"\r\n// //                   onClick={() => setAddingCategory(!addingCategory)}\r\n// //                 >\r\n// //                   {addingCategory ? \"Close\" : \"Add\"}\r\n// //                 </button>\r\n// //               </div>\r\n// //             </div>\r\n\r\n// //             {/* ADD CATEGORY */}\r\n// //             {addingCategory && (\r\n// //               <div className=\"form-group full-width addCategoryBox\">\r\n// //                 <label>Add New Category</label>\r\n\r\n// //                 <div className=\"category-row\">\r\n// //                   <input\r\n// //                     value={newCategoryName}\r\n// //                     onChange={(e) => setNewCategoryName(e.target.value)}\r\n// //                     placeholder=\"Category name\"\r\n// //                   />\r\n\r\n// //                   <input\r\n// //                     type=\"file\"\r\n// //                     accept=\"image/*\"\r\n// //                     onChange={(e) => {\r\n// //                       setNewCategoryImage(e.target.files[0]);\r\n// //                       setNewCategoryPreview(\r\n// //                         e.target.files[0] ? URL.createObjectURL(e.target.files[0]) : null\r\n// //                       );\r\n// //                     }}\r\n// //                   />\r\n\r\n// //                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateCategory}>\r\n// //                     Create\r\n// //                   </button>\r\n// //                 </div>\r\n\r\n// //                 {newCategoryPreview && (\r\n// //                   <img src={newCategoryPreview} className=\"categoryPreview\" alt=\"preview\" />\r\n// //                 )}\r\n// //               </div>\r\n// //             )}\r\n\r\n// //             {/* SUBCATEGORY SELECT */}\r\n// //             <div className=\"form-group\">\r\n// //               <label>Subcategory</label>\r\n// //               <div className=\"category-row\">\r\n// //                 <select\r\n// //                   name=\"subcategory\"\r\n// //                   value={form.subcategory}\r\n// //                   onChange={handleChange}\r\n// //                   disabled={!subcategories.length}\r\n// //                 >\r\n// //                   <option value=\"\">Select Subcategory</option>\r\n// //                   {subcategories.map((s) => (\r\n// //                     <option value={s._id} key={s._id}>\r\n// //                       {s.name}\r\n// //                     </option>\r\n// //                   ))}\r\n// //                 </select>\r\n\r\n// //                 {form.category && (\r\n// //                   <button\r\n// //                     type=\"button\"\r\n// //                     className=\"btn small\"\r\n// //                     onClick={() => setAddingSub(!addingSub)}\r\n// //                   >\r\n// //                     {addingSub ? \"Close\" : \"Add\"}\r\n// //                   </button>\r\n// //                 )}\r\n// //               </div>\r\n// //             </div>\r\n\r\n// //             {/* ADD SUBCATEGORY */}\r\n// //             {addingSub && (\r\n// //               <div className=\"form-group full-width addCategoryBox\">\r\n// //                 <label>Add New Subcategory</label>\r\n\r\n// //                 <div className=\"category-row\">\r\n// //                   <input\r\n// //                     value={newSubName}\r\n// //                     onChange={(e) => setNewSubName(e.target.value)}\r\n// //                     placeholder=\"Subcategory name\"\r\n// //                   />\r\n\r\n// //                   <input\r\n// //                     type=\"file\"\r\n// //                     accept=\"image/*\"\r\n// //                     onChange={(e) => {\r\n// //                       setNewSubImage(e.target.files[0]);\r\n// //                       setNewSubPreview(\r\n// //                         e.target.files[0] ? URL.createObjectURL(e.target.files[0]) : null\r\n// //                       );\r\n// //                     }}\r\n// //                   />\r\n\r\n// //                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateSub}>\r\n// //                     Create\r\n// //                   </button>\r\n// //                 </div>\r\n\r\n// //                 {newSubPreview && (\r\n// //                   <img src={newSubPreview} className=\"categoryPreview\" alt=\"preview\" />\r\n// //                 )}\r\n// //               </div>\r\n// //             )}\r\n\r\n// //             {/* BASE PRICE */}\r\n// //             <div className=\"form-group\">\r\n// //               <label>Base Price *</label>\r\n// //               <input\r\n// //                 type=\"number\"\r\n// //                 required\r\n// //                 name=\"basePrice\"\r\n// //                 value={form.basePrice}\r\n// //                 onChange={handleChange}\r\n// //               />\r\n// //             </div>\r\n\r\n// //             {/* DIFFERENCE */}\r\n// //             <div className=\"form-group\">\r\n// //               <label>Difference</label>\r\n// //               <input\r\n// //                 type=\"number\"\r\n// //                 name=\"difference\"\r\n// //                 value={form.difference}\r\n// //                 onChange={handleChange}\r\n// //               />\r\n// //             </div>\r\n\r\n// //             {/* VALID TILL */}\r\n// //             <div className=\"form-group\">\r\n// //               <label>Valid Till</label>\r\n// //               <input\r\n// //                 type=\"date\"\r\n// //                 name=\"validTill\"\r\n// //                 value={form.validTill}\r\n// //                 onChange={handleChange}\r\n// //               />\r\n// //             </div>\r\n\r\n// //             {/* IMAGE */}\r\n// //             <div className=\"form-group\">\r\n// //               <label>Image</label>\r\n// //               <input type=\"file\" accept=\"image/*\" onChange={handleChange} />\r\n// //             </div>\r\n// //           </div>\r\n\r\n// //           {/* DESCRIPTION */}\r\n// //           <div className=\"form-group full-width\">\r\n// //             <label>Description</label>\r\n// //             <textarea\r\n// //               name=\"description\"\r\n// //               value={form.description}\r\n// //               onChange={handleChange}\r\n// //             ></textarea>\r\n// //           </div>\r\n\r\n// //           {/* SUBMIT BUTTON */}\r\n// //           <div className=\"form-actions\">\r\n// //             <button className=\"btn primary\" disabled={loading}>\r\n// //               {loading\r\n// //                 ? \"Saving...\"\r\n// //                 : isCopyMode\r\n// //                 ? \"Save Copy\"\r\n// //                 : editId\r\n// //                 ? \"Update\"\r\n// //                 : \"Add\"}\r\n// //             </button>\r\n\r\n// //             {(editId || isCopyMode) && (\r\n// //               <button\r\n// //                 type=\"button\"\r\n// //                 className=\"btn cancel\"\r\n// //                 onClick={() => {\r\n// //                   setEditId(null);\r\n// //                   setIsCopyMode(false);\r\n// //                 }}\r\n// //               >\r\n// //                 Cancel\r\n// //               </button>\r\n// //             )}\r\n// //           </div>\r\n// //         </form>\r\n// //       </div>\r\n\r\n// //       {/* CSV IMPORT EXPORT */}\r\n// //       <div className=\"csv-controls\">\r\n// //         <div>\r\n// //           <input\r\n// //             type=\"file\"\r\n// //             accept=\".csv\"\r\n// //             ref={csvInputRef}\r\n// //             onChange={handleCsvSelect}\r\n// //           />\r\n// //           <button className=\"btn small\" onClick={handleImportCsv}>\r\n// //             Import CSV\r\n// //           </button>\r\n// //         </div>\r\n\r\n// //         <div style={{ display: \"flex\", gap: 8 }}>\r\n// //           <button className=\"btn primary\" onClick={handleExportCsv}>\r\n// //             Export All CSV\r\n// //           </button>\r\n\r\n// //           <button className=\"btn\" onClick={handleExportSelectedCsv}>\r\n// //             Export Selected CSV\r\n// //           </button>\r\n// //         </div>\r\n// //       </div>\r\n\r\n// //       {/* TABLE */}\r\n// //       <div className=\"table-card\">\r\n// //         <div className=\"table-header\">\r\n// //           <h2>üìã Items</h2>\r\n// //           <span>Total: {filteredItems.length}</span>\r\n// //         </div>\r\n\r\n// //         {!isMobile ? (\r\n// //           <table>\r\n// //             <thead>\r\n// //               <tr>\r\n// //                 <th>\r\n// //                   <input\r\n// //                     type=\"checkbox\"\r\n// //                     checked={\r\n// //                       selectedItems.length === filteredItems.length &&\r\n// //                       filteredItems.length > 0\r\n// //                     }\r\n// //                     onChange={() => {\r\n// //                       if (selectedItems.length === filteredItems.length)\r\n// //                         setSelectedItems([]);\r\n// //                       else\r\n// //                         setSelectedItems(filteredItems.map((x) => x._id));\r\n// //                     }}\r\n// //                   />\r\n// //                 </th>\r\n// //                 <th>Sr</th>\r\n// //                 <th>Image</th>\r\n// //                 <th>Name</th>\r\n// //                 <th>Category</th>\r\n// //                 <th>Subcategory</th>\r\n// //                 <th>Base</th>\r\n// //                 <th>Diff</th>\r\n// //                 <th>Final</th>\r\n// //                 <th>Status</th>\r\n// //                 <th>Valid Till</th>\r\n// //                 <th>Actions</th>\r\n// //               </tr>\r\n// //             </thead>\r\n\r\n// //             <tbody>\r\n// //               {currentItems.map((item, i) => (\r\n// //                 <tr key={item._id}>\r\n// //                   <td>\r\n// //                     <input\r\n// //                       type=\"checkbox\"\r\n// //                       checked={selectedItems.includes(item._id)}\r\n// //                       onChange={() =>\r\n// //                         selectedItems.includes(item._id)\r\n// //                           ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\r\n// //                           : setSelectedItems([...selectedItems, item._id])\r\n// //                       }\r\n// //                     />\r\n// //                   </td>\r\n\r\n// //                   <td>{(currentPage - 1) * itemsPerPage + (i + 1)}</td>\r\n\r\n// //                   <td>{item.image ? <img src={item.image} alt=\"img\" /> : \"No Img\"}</td>\r\n\r\n// //                   <td>{item.name}</td>\r\n\r\n// //                   <td>{item.category?.name}</td>\r\n\r\n// //                   <td>{item.subcategory?.name}</td>\r\n\r\n// //                   <td>‚Çπ{item.basePrice}</td>\r\n\r\n// //                   <td>{item.difference || 0}</td>\r\n\r\n// //                   <td>‚Çπ{Number(item.basePrice) + Number(item.difference || 0)}</td>\r\n\r\n// //                   <td>\r\n// //                     <button\r\n// //                       className={\r\n// //                         item.status === \"active\" ? \"status-active\" : \"status-inactive\"\r\n// //                       }\r\n// //                       onClick={() => handleStatusToggle(item)}\r\n// //                     >\r\n// //                       {item.status === \"active\" ? \"üü¢ Active\" : \"üî¥ Inactive\"}\r\n// //                     </button>\r\n// //                   </td>\r\n\r\n// //                   <td>\r\n// //                     {item.validTill\r\n// //                       ? new Date(item.validTill).toLocaleDateString()\r\n// //                       : \"-\"}\r\n// //                   </td>\r\n\r\n// //                   <td className=\"actions\">\r\n// //                     <button className=\"btn edit\" onClick={() => handleEdit(item)}>\r\n// //                       Edit\r\n// //                     </button>\r\n\r\n// //                     <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\r\n// //                       Delete\r\n// //                     </button>\r\n\r\n// //                     <button\r\n// //                       className=\"btn small\"\r\n// //                       style={{ background: \"#6f42c1\", color: \"#fff\" }}\r\n// //                       onClick={() => handleCopyToEdit(item)}\r\n// //                     >\r\n// //                       Copy\r\n// //                     </button>\r\n// //                   </td>\r\n// //                 </tr>\r\n// //               ))}\r\n// //             </tbody>\r\n// //           </table>\r\n// //         ) : (\r\n// //           <div className=\"mobile-list\">\r\n// //             {currentItems.map((item) => (\r\n// //               <div key={item._id} className=\"mobile-card\">\r\n// //                 <input\r\n// //                   type=\"checkbox\"\r\n// //                   checked={selectedItems.includes(item._id)}\r\n// //                   onChange={() =>\r\n// //                     selectedItems.includes(item._id)\r\n// //                       ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\r\n// //                       : setSelectedItems([...selectedItems, item._id])\r\n// //                   }\r\n// //                 />\r\n\r\n// //                 {item.image ? (\r\n// //                   <img src={item.image} alt=\"img\" />\r\n// //                 ) : (\r\n// //                   <div>No Image</div>\r\n// //                 )}\r\n\r\n// //                 <h3>{item.name}</h3>\r\n\r\n// //                 <p>\r\n// //                   <b>Category:</b> {item.category?.name}\r\n// //                 </p>\r\n\r\n// //                 <p>\r\n// //                   <b>Subcategory:</b> {item.subcategory?.name || \"-\"}\r\n// //                 </p>\r\n\r\n// //                 <p>\r\n// //                   <b>Base:</b> ‚Çπ{item.basePrice}\r\n// //                 </p>\r\n\r\n// //                 <p>\r\n// //                   <b>Final:</b> ‚Çπ\r\n// //                   {Number(item.basePrice) + Number(item.difference || 0)}\r\n// //                 </p>\r\n\r\n// //                 <button\r\n// //                   className={\r\n// //                     item.status === \"active\" ? \"status-active\" : \"status-inactive\"\r\n// //                   }\r\n// //                   onClick={() => handleStatusToggle(item)}\r\n// //                 >\r\n// //                   {item.status === \"active\" ? \"Active\" : \"Inactive\"}\r\n// //                 </button>\r\n\r\n// //                 <div className=\"actions\">\r\n// //                   <button className=\"btn edit\" onClick={() => handleEdit(item)}>\r\n// //                     Edit\r\n// //                   </button>\r\n\r\n// //                   <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\r\n// //                     Delete\r\n// //                   </button>\r\n\r\n// //                   <button\r\n// //                     className=\"btn small\"\r\n// //                     style={{ background: \"#6f42c1\", color: \"#fff\" }}\r\n// //                     onClick={() => handleCopyToEdit(item)}\r\n// //                   >\r\n// //                     Copy\r\n// //                   </button>\r\n// //                 </div>\r\n// //               </div>\r\n// //             ))}\r\n// //           </div>\r\n// //         )}\r\n\r\n// //         {/* PAGINATION */}\r\n// //         <div className=\"pagination\">\r\n// //           <button\r\n// //             disabled={currentPage === 1}\r\n// //             onClick={() => setCurrentPage((p) => p - 1)}\r\n// //           >\r\n// //             Previous\r\n// //           </button>\r\n\r\n// //           {Array.from({ length: totalPages }).map((_, i) => (\r\n// //             <button\r\n// //               key={i}\r\n// //               className={i + 1 === currentPage ? \"active-page\" : \"\"}\r\n// //               onClick={() => setCurrentPage(i + 1)}\r\n// //             >\r\n// //               {i + 1}\r\n// //             </button>\r\n// //           ))}\r\n\r\n// //           <button\r\n// //             disabled={currentPage === totalPages}\r\n// //             onClick={() => setCurrentPage((p) => p + 1)}\r\n// //           >\r\n// //             Next\r\n// //           </button>\r\n// //         </div>\r\n// //       </div>\r\n// //     </div>\r\n// //   );\r\n// // }\r\n// // src/components/PriceList.js\r\n// import React, { useEffect, useState, useRef } from \"react\";\r\n// import axios from \"axios\";\r\n// import \"./PriceList.css\";\r\n\r\n// const API_URL = \"https://grocerrybackend.vercel.app/api/prices\";\r\n// const CATEGORY_URL = \"https://grocerrybackend.vercel.app/api/categories\";\r\n\r\n// export default function PriceList() {\r\n//   const [items, setItems] = useState([]);\r\n//   const [categories, setCategories] = useState([]);\r\n//   const [subcategories, setSubcategories] = useState([]);\r\n//   const [isMobile, setIsMobile] = useState(window.innerWidth < 768);\r\n\r\n//   const [search, setSearch] = useState(\"\");\r\n\r\n//   const [form, setForm] = useState({\r\n//     name: \"\",\r\n//     category: \"\",\r\n//     subcategory: \"\",\r\n//     description: \"\",\r\n//     basePrice: \"\",\r\n//     difference: \"\",\r\n//     validTill: \"\",\r\n//     file: null,\r\n//   });\r\n\r\n//   const [editId, setEditId] = useState(null);\r\n//   const [loading, setLoading] = useState(false);\r\n//   const [csvFile, setCsvFile] = useState(null);\r\n\r\n//   // COPY MODE\r\n//   const [isCopyMode, setIsCopyMode] = useState(false);\r\n\r\n//   // CATEGORY ADD\r\n//   const [addingCategory, setAddingCategory] = useState(false);\r\n//   const [newCategoryName, setNewCategoryName] = useState(\"\");\r\n//   const [newCategoryImage, setNewCategoryImage] = useState(null);\r\n//   const [newCategoryPreview, setNewCategoryPreview] = useState(null);\r\n\r\n//   // SUB CATEGORY ADD\r\n//   const [addingSub, setAddingSub] = useState(false);\r\n//   const [newSubName, setNewSubName] = useState(\"\");\r\n//   const [newSubImage, setNewSubImage] = useState(null);\r\n//   const [newSubPreview, setNewSubPreview] = useState(null);\r\n\r\n//   // BULK\r\n//   const [selectedItems, setSelectedItems] = useState([]);\r\n//   const [bulkMode, setBulkMode] = useState(false);\r\n\r\n//   const csvInputRef = useRef();\r\n\r\n//   // PAGINATION\r\n//   const [currentPage, setCurrentPage] = useState(1);\r\n//   const itemsPerPage = 30;\r\n\r\n//   // ----------------- FETCH ITEMS & CATEGORIES -----------------\r\n//   useEffect(() => {\r\n//     fetchItems();\r\n//     fetchCategories();\r\n\r\n//     const handleResize = () => setIsMobile(window.innerWidth < 768);\r\n//     window.addEventListener(\"resize\", handleResize);\r\n//     return () => window.removeEventListener(\"resize\", handleResize);\r\n//   }, []);\r\n\r\n//   const fetchItems = async () => {\r\n//     try {\r\n//       setLoading(true);\r\n//       const res = await axios.get(API_URL);\r\n//       if (res.data.success) setItems(res.data.data || []);\r\n//     } catch (err) {\r\n//       console.log(\"Fetch error\", err);\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   const fetchCategories = async () => {\r\n//     try {\r\n//       const res = await axios.get(CATEGORY_URL);\r\n//       if (res.data.success) {\r\n//         // Expecting API to return categories including subcategories array\r\n//         setCategories(res.data.categories || []);\r\n//       }\r\n//     } catch (err) {\r\n//       console.log(\"Cat fetch err\", err);\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- WHEN CATEGORY SELECT ‚Üí LOAD SUBCATEGORIES -----------------\r\n//   // Improved: keep existing subcategory if it still exists in new subcategory list (important for edit flow)\r\n//   useEffect(() => {\r\n//     if (!form.category) {\r\n//       setSubcategories([]);\r\n//       setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n//       return;\r\n//     }\r\n\r\n//     const categoryObj = categories.find((c) => c._id === form.category);\r\n//     const newSubs = (categoryObj && categoryObj.subcategories) || [];\r\n\r\n//     setSubcategories(newSubs);\r\n\r\n//     // If current form.subcategory exists in newSubs, keep it, otherwise reset to \"\"\r\n//     const exists = newSubs.some((s) => s._id === form.subcategory);\r\n//     if (!exists) {\r\n//       setForm((prev) => ({ ...prev, subcategory: \"\" }));\r\n//     }\r\n//     // else keep the selected subcategory (important when editing)\r\n//   }, [form.category, categories]); // run when category changes or categories loaded\r\n\r\n//   // ----------------- CREATE CATEGORY -----------------\r\n//   const handleCreateCategory = async () => {\r\n//     if (!newCategoryName) return alert(\"Enter category name\");\r\n\r\n//     try {\r\n//       const fd = new FormData();\r\n//       fd.append(\"name\", newCategoryName);\r\n//       if (newCategoryImage) fd.append(\"image\", newCategoryImage);\r\n\r\n//       const res = await axios.post(CATEGORY_URL, fd);\r\n\r\n//       if (res.data.success) {\r\n//         alert(\"Category Created!\");\r\n//         setNewCategoryName(\"\");\r\n//         setNewCategoryImage(null);\r\n//         setNewCategoryPreview(null);\r\n//         setAddingCategory(false);\r\n//         fetchCategories();\r\n//       }\r\n//     } catch (err) {\r\n//       console.log(\"Category create error\", err);\r\n//       alert(\"Category create failed\");\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- CREATE SUB CATEGORY -----------------\r\n//   const handleCreateSub = async () => {\r\n//     if (!newSubName) return alert(\"Enter subcategory name\");\r\n//     if (!form.category) return alert(\"Select category first\");\r\n\r\n//     try {\r\n//       const fd = new FormData();\r\n//       fd.append(\"name\", newSubName);\r\n//       if (newSubImage) fd.append(\"image\", newSubImage);\r\n\r\n//       const res = await axios.post(\r\n//         `${CATEGORY_URL}/${form.category}/sub`,\r\n//         fd\r\n//       );\r\n\r\n//       if (res.data.success) {\r\n//         alert(\"Subcategory Created!\");\r\n//         setNewSubName(\"\");\r\n//         setNewSubImage(null);\r\n//         setNewSubPreview(null);\r\n//         setAddingSub(false);\r\n//         fetchCategories();\r\n//         // after categories refreshed, category useEffect will populate subcategories\r\n//       }\r\n//     } catch (err) {\r\n//       console.log(\"Subcategory create error\", err);\r\n//       alert(\"Subcategory create failed\");\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- HANDLE INPUTS -----------------\r\n//   const handleChange = (e) => {\r\n//     const { name, value, files } = e.target;\r\n//     if (files) {\r\n//       setForm((prev) => ({ ...prev, file: files[0] }));\r\n//     } else {\r\n//       setForm((prev) => ({ ...prev, [name]: value }));\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- SUBMIT FORM -----------------\r\n//   const handleSubmit = async (e) => {\r\n//     e.preventDefault();\r\n//     setLoading(true);\r\n\r\n//     try {\r\n//       if (!form.name || !form.category || !form.basePrice) {\r\n//         alert(\"Name, category & base price required\");\r\n//         setLoading(false);\r\n//         return;\r\n//       }\r\n\r\n//       const fd = new FormData();\r\n//       // Append only non-empty values\r\n//       Object.keys(form).forEach((k) => {\r\n//         const val = form[k];\r\n//         if (val !== \"\" && val !== null && val !== undefined) {\r\n//           // For file, append file object\r\n//           fd.append(k, val);\r\n//         }\r\n//       });\r\n\r\n//       if (isCopyMode) {\r\n//         await axios.post(API_URL, fd);\r\n//         alert(\"Copied as new item!\");\r\n//       } else if (editId) {\r\n//         await axios.put(`${API_URL}/${editId}`, fd);\r\n//       } else {\r\n//         await axios.post(API_URL, fd);\r\n//       }\r\n\r\n//       // Reset form\r\n//       setForm({\r\n//         name: \"\",\r\n//         category: \"\",\r\n//         subcategory: \"\",\r\n//         description: \"\",\r\n//         basePrice: \"\",\r\n//         difference: \"\",\r\n//         validTill: \"\",\r\n//         file: null,\r\n//       });\r\n\r\n//       setEditId(null);\r\n//       setIsCopyMode(false);\r\n//       fetchItems();\r\n//     } catch (err) {\r\n//       console.log(\"Save error\", err);\r\n//       alert(\"Save failed\");\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- EDIT -----------------\r\n//   const handleEdit = (item) => {\r\n//     // Set form including subcategory id (string)\r\n//     setForm({\r\n//       name: item.name || \"\",\r\n//       category: item.category?._id?.toString() || \"\",\r\n//       subcategory: item.subcategory?._id?.toString() || \"\",\r\n//       description: item.description || \"\",\r\n//       basePrice: item.basePrice || \"\",\r\n//       difference: item.difference || 0,\r\n//       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n//       file: null,\r\n//     });\r\n\r\n//     setIsCopyMode(false);\r\n//     setEditId(item._id);\r\n//     // Scroll to top for form visibility\r\n//     window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n\r\n//     // Ensure subcategories for this category are set immediately (if categories are loaded)\r\n//     const categoryObj = categories.find((c) => c._id === item.category?._id);\r\n//     if (categoryObj && categoryObj.subcategories) {\r\n//       setSubcategories(categoryObj.subcategories);\r\n//       // Keep the selected subcategory (we already set it above)\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- COPY ‚Üí NEW ENTRY -----------------\r\n//   const handleCopyToEdit = (item) => {\r\n//     setForm({\r\n//       name: item.name || \"\",\r\n//       category: item.category?._id?.toString() || \"\",\r\n//       subcategory: item.subcategory?._id?.toString() || \"\",\r\n//       description: item.description || \"\",\r\n//       basePrice: item.basePrice || \"\",\r\n//       difference: item.difference || 0,\r\n//       validTill: item.validTill ? item.validTill.split(\"T\")[0] : \"\",\r\n//       file: null,\r\n//     });\r\n\r\n//     setEditId(null);\r\n//     setIsCopyMode(true);\r\n//     window.scrollTo({ top: 0, behavior: \"smooth\" });\r\n\r\n//     // preload subcategories for chosen category\r\n//     const categoryObj = categories.find((c) => c._id === item.category?._id);\r\n//     if (categoryObj && categoryObj.subcategories) {\r\n//       setSubcategories(categoryObj.subcategories);\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- DELETE -----------------\r\n//   const handleDelete = async (id) => {\r\n//     if (!window.confirm(\"Delete?\")) return;\r\n//     try {\r\n//       await axios.delete(`${API_URL}/${id}`);\r\n//       fetchItems();\r\n//     } catch (err) {\r\n//       console.error(\"Delete error\", err);\r\n//       alert(\"Delete failed\");\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- STATUS TOGGLE -----------------\r\n//   const handleStatusToggle = async (item) => {\r\n//     const newStatus = item.status === \"active\" ? \"inactive\" : \"active\";\r\n\r\n//     try {\r\n//       await axios.put(`${API_URL}/status/${item._id}`, { status: newStatus });\r\n//       setItems((prev) =>\r\n//         prev.map((x) => (x._id === item._id ? { ...x, status: newStatus } : x))\r\n//       );\r\n//     } catch (err) {\r\n//       console.error(\"Status toggle error\", err);\r\n//       alert(\"Status update failed\");\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- BULK DELETE -----------------\r\n//   const handleBulkDelete = async () => {\r\n//     if (!window.confirm(\"Delete selected items?\")) return;\r\n\r\n//     try {\r\n//       await Promise.all(\r\n//         selectedItems.map((id) => axios.delete(`${API_URL}/${id}`))\r\n//       );\r\n//       setSelectedItems([]);\r\n//       fetchItems();\r\n//     } catch (err) {\r\n//       console.error(\"Bulk delete error\", err);\r\n//       alert(\"Bulk delete failed\");\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- BULK HELPERS -----------------\r\n//   const updateLocalItemField = (id, key, value) => {\r\n//     setItems((prev) =>\r\n//       prev.map((x) => (x._id === id ? { ...x, [key]: value } : x))\r\n//     );\r\n//   };\r\n\r\n//   const handleBulkSave = async () => {\r\n//     const updates = items\r\n//       .filter((x) => selectedItems.includes(x._id))\r\n//       .map((x) => ({\r\n//         id: x._id,\r\n//         name: x.name,\r\n//         basePrice: x.basePrice,\r\n//         difference: x.difference,\r\n//         validTill: x.validTill,\r\n//       }));\r\n\r\n//     try {\r\n//       await axios.post(`${API_URL}/bulk-update`, { products: updates });\r\n//       setBulkMode(false);\r\n//       setSelectedItems([]);\r\n//       fetchItems();\r\n//     } catch (err) {\r\n//       console.error(\"Bulk save error\", err);\r\n//       alert(\"Bulk save failed\");\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- CSV IMPORT -----------------\r\n//   const handleCsvSelect = (e) => setCsvFile(e.target.files[0]);\r\n\r\n//   const handleImportCsv = async () => {\r\n//     if (!csvFile) return alert(\"Select CSV\");\r\n\r\n//     const fd = new FormData();\r\n//     fd.append(\"file\", csvFile);\r\n\r\n//     try {\r\n//       const res = await axios.post(`${API_URL}/import`, fd);\r\n//       if (res.data.success) {\r\n//         fetchItems();\r\n//         alert(\"CSV Imported!\");\r\n//         setCsvFile(null);\r\n//         if (csvInputRef.current) csvInputRef.current.value = null;\r\n//       } else {\r\n//         alert(\"CSV import failed\");\r\n//       }\r\n//     } catch (err) {\r\n//       console.error(\"CSV import error\", err);\r\n//       alert(\"CSV import failed\");\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- CSV EXPORT (ALL) -----------------\r\n//   const handleExportCsv = async () => {\r\n//     try {\r\n//       const res = await axios.get(`${API_URL}/export`, { responseType: \"blob\" });\r\n\r\n//       const url = window.URL.createObjectURL(new Blob([res.data]));\r\n//       const a = document.createElement(\"a\");\r\n//       a.href = url;\r\n//       a.download = \"prices.csv\";\r\n//       a.click();\r\n//     } catch (err) {\r\n//       console.error(\"CSV export error\", err);\r\n//       alert(\"CSV export failed\");\r\n//     }\r\n//   };\r\n\r\n//   // ----------------- CSV EXPORT (SELECTED ONLY) -----------------\r\n//   const handleExportSelectedCsv = () => {\r\n//     if (selectedItems.length === 0) {\r\n//       alert(\"Select at least one item\");\r\n//       return;\r\n//     }\r\n\r\n//     const selectedData = items.filter((x) => selectedItems.includes(x._id));\r\n\r\n//     const rows = [\r\n//       [\r\n//         \"name\",\r\n//         \"categoryName\",\r\n//         \"subcategoryName\",\r\n//         \"basePrice\",\r\n//         \"difference\",\r\n//         \"finalPrice\",\r\n//         \"status\",\r\n//         \"validTill\",\r\n//         \"description\",\r\n//         \"imageUrl\",\r\n//       ],\r\n//       ...selectedData.map((p) => [\r\n//         p.name,\r\n//         p.category?.name || \"\",\r\n//         p.subcategory?.name || \"\",\r\n//         p.basePrice,\r\n//         p.difference || 0,\r\n//         Number(p.basePrice) + Number(p.difference || 0),\r\n//         p.status,\r\n//         p.validTill ? (p.validTill.split ? p.validTill.split(\"T\")[0] : new Date(p.validTill).toISOString().split(\"T\")[0]) : \"\",\r\n//         p.description || \"\",\r\n//         p.image || \"\",\r\n//       ]),\r\n//     ];\r\n\r\n//     const csvContent =\r\n//       \"data:text/csv;charset=utf-8,\" +\r\n//       rows.map((e) => e.map((v) => {\r\n//           // Escape double quotes by doubling them and wrap fields containing comma/newline/quote in quotes\r\n//           const s = v === null || v === undefined ? \"\" : String(v);\r\n//           if (s.includes(\",\") || s.includes(\"\\n\") || s.includes('\"')) {\r\n//             return `\"${s.replace(/\"/g, '\"\"')}\"`;\r\n//           }\r\n//           return s;\r\n//         }).join(\",\")\r\n//       ).join(\"\\n\");\r\n\r\n//     const encodedUri = encodeURI(csvContent);\r\n//     const link = document.createElement(\"a\");\r\n//     link.href = encodedUri;\r\n//     link.download = `selected_prices_${Date.now()}.csv`;\r\n//     link.click();\r\n//   };\r\n\r\n//   // ----------------- SEARCH FILTER -----------------\r\n//   const filteredItems = items.filter((item) => {\r\n//     const t = search.toLowerCase();\r\n//     return (\r\n//       (item.name || \"\").toString().toLowerCase().includes(t) ||\r\n//       (item.category?.name || \"\").toLowerCase().includes(t) ||\r\n//       (item.subcategory?.name || \"\").toLowerCase().includes(t)\r\n//     );\r\n//   });\r\n\r\n//   // ----------------- PAGINATION -----------------\r\n//   const indexOfLast = currentPage * itemsPerPage;\r\n//   const currentItems = filteredItems.slice(\r\n//     indexOfLast - itemsPerPage,\r\n//     indexOfLast\r\n//   );\r\n//   const totalPages = Math.ceil(filteredItems.length / itemsPerPage) || 1;\r\n\r\n//   return (\r\n//     <div className=\"price-container\">\r\n//       {/* HEADER */}\r\n//       <div className=\"header-section\">\r\n//         <h1>üí∞ Product Management</h1>\r\n//         <p>Manage prices, categories, images, CSV & bulk actions.</p>\r\n//       </div>\r\n\r\n//       {/* SEARCH */}\r\n//       <div className=\"search-bar\">\r\n//         <input\r\n//           type=\"text\"\r\n//           placeholder=\"Search product, category or subcategory...\"\r\n//           value={search}\r\n//           onChange={(e) => setSearch(e.target.value)}\r\n//         />\r\n//       </div>\r\n\r\n//       {/* BULK BAR */}\r\n//       {selectedItems.length > 0 && (\r\n//         <div className=\"bulk-bar\">\r\n//           <span>{selectedItems.length} selected</span>\r\n\r\n//           {!bulkMode ? (\r\n//             <div className=\"bulk-actions\">\r\n//               <button className=\"btn delete\" onClick={handleBulkDelete}>\r\n//                 üóë Bulk Delete\r\n//               </button>\r\n\r\n//               <button className=\"btn primary\" onClick={() => setBulkMode(true)}>\r\n//                 ‚úè Bulk Edit\r\n//               </button>\r\n//             </div>\r\n//           ) : (\r\n//             <div className=\"bulk-panel\">\r\n//               <h3>‚úè Bulk Edit Selected Items</h3>\r\n\r\n//               {items\r\n//                 .filter((item) => selectedItems.includes(item._id))\r\n//                 .map((item) => (\r\n//                   <div key={item._id} className=\"bulk-edit-item-box\">\r\n//                     <h4>{item.name}</h4>\r\n\r\n//                     <div className=\"form-grid\">\r\n//                       <div className=\"form-group\">\r\n//                         <label>Name</label>\r\n//                         <input\r\n//                           type=\"text\"\r\n//                           value={item.name}\r\n//                           onChange={(e) =>\r\n//                             updateLocalItemField(item._id, \"name\", e.target.value)\r\n//                           }\r\n//                         />\r\n//                       </div>\r\n\r\n//                       <div className=\"form-group\">\r\n//                         <label>Base Price</label>\r\n//                         <input\r\n//                           type=\"number\"\r\n//                           value={item.basePrice}\r\n//                           onChange={(e) =>\r\n//                             updateLocalItemField(\r\n//                               item._id,\r\n//                               \"basePrice\",\r\n//                               Number(e.target.value)\r\n//                             )\r\n//                           }\r\n//                         />\r\n//                       </div>\r\n\r\n//                       <div className=\"form-group\">\r\n//                         <label>Difference</label>\r\n//                         <input\r\n//                           type=\"number\"\r\n//                           value={item.difference || 0}\r\n//                           onChange={(e) =>\r\n//                             updateLocalItemField(\r\n//                               item._id,\r\n//                               \"difference\",\r\n//                               Number(e.target.value)\r\n//                             )\r\n//                           }\r\n//                         />\r\n//                       </div>\r\n\r\n//                       <div className=\"form-group\">\r\n//                         <label>Valid Till</label>\r\n//                         <input\r\n//                           type=\"date\"\r\n//                           value={item.validTill ? (item.validTill.split ? item.validTill.split(\"T\")[0] : new Date(item.validTill).toISOString().split(\"T\")[0]) : \"\"}\r\n//                           onChange={(e) =>\r\n//                             updateLocalItemField(\r\n//                               item._id,\r\n//                               \"validTill\",\r\n//                               e.target.value\r\n//                             )\r\n//                           }\r\n//                         />\r\n//                       </div>\r\n//                     </div>\r\n//                   </div>\r\n//                 ))}\r\n\r\n//               <button className=\"btn primary\" onClick={handleBulkSave}>\r\n//                 ‚úî Save All\r\n//               </button>\r\n\r\n//               <button className=\"btn cancel\" onClick={() => setBulkMode(false)}>\r\n//                 ‚úñ Cancel\r\n//               </button>\r\n//             </div>\r\n//           )}\r\n//         </div>\r\n//       )}\r\n\r\n//       {/* ADD / EDIT FORM */}\r\n//       <div className=\"price-form-card\">\r\n//         <h2>\r\n//           {isCopyMode\r\n//             ? \"üìÑ Save Duplicate Product\"\r\n//             : editId\r\n//             ? \"‚úè Update Product\"\r\n//             : \"‚ûï Add Product\"}\r\n//         </h2>\r\n\r\n//         <form onSubmit={handleSubmit}>\r\n//           <div className=\"form-grid\">\r\n//             {/* NAME */}\r\n//             <div className=\"form-group\">\r\n//               <label>Product Name *</label>\r\n//               <input\r\n//                 required\r\n//                 name=\"name\"\r\n//                 value={form.name}\r\n//                 onChange={handleChange}\r\n//               />\r\n//             </div>\r\n\r\n//             {/* CATEGORY SELECT */}\r\n//             <div className=\"form-group\">\r\n//               <label>Category *</label>\r\n//               <div className=\"category-row\">\r\n//                 <select\r\n//                   required\r\n//                   name=\"category\"\r\n//                   value={form.category}\r\n//                   onChange={handleChange}\r\n//                 >\r\n//                   <option value=\"\">Select Category</option>\r\n//                   {categories.map((c) => (\r\n//                     <option value={c._id} key={c._id}>\r\n//                       {c.name}\r\n//                     </option>\r\n//                   ))}\r\n//                 </select>\r\n\r\n//                 <button\r\n//                   type=\"button\"\r\n//                   className=\"btn small\"\r\n//                   onClick={() => setAddingCategory(!addingCategory)}\r\n//                 >\r\n//                   {addingCategory ? \"Close\" : \"Add\"}\r\n//                 </button>\r\n//               </div>\r\n//             </div>\r\n\r\n//             {/* ADD CATEGORY */}\r\n//             {addingCategory && (\r\n//               <div className=\"form-group full-width addCategoryBox\">\r\n//                 <label>Add New Category</label>\r\n\r\n//                 <div className=\"category-row\">\r\n//                   <input\r\n//                     value={newCategoryName}\r\n//                     onChange={(e) => setNewCategoryName(e.target.value)}\r\n//                     placeholder=\"Category name\"\r\n//                   />\r\n\r\n//                   <input\r\n//                     type=\"file\"\r\n//                     accept=\"image/*\"\r\n//                     onChange={(e) => {\r\n//                       setNewCategoryImage(e.target.files[0]);\r\n//                       setNewCategoryPreview(\r\n//                         e.target.files[0]\r\n//                           ? URL.createObjectURL(e.target.files[0])\r\n//                           : null\r\n//                       );\r\n//                     }}\r\n//                   />\r\n\r\n//                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateCategory}>\r\n//                     Create\r\n//                   </button>\r\n//                 </div>\r\n\r\n//                 {newCategoryPreview && (\r\n//                   <img src={newCategoryPreview} className=\"categoryPreview\" alt=\"preview\" />\r\n//                 )}\r\n//               </div>\r\n//             )}\r\n\r\n//             {/* SUBCATEGORY SELECT */}\r\n//             <div className=\"form-group\">\r\n//               <label>Subcategory</label>\r\n//               <div className=\"category-row\">\r\n//                 <select\r\n//                   name=\"subcategory\"\r\n//                   value={form.subcategory}\r\n//                   onChange={handleChange}\r\n//                   disabled={!subcategories.length}\r\n//                 >\r\n//                   <option value=\"\">Select Subcategory</option>\r\n//                   {subcategories.map((s) => (\r\n//                     <option value={s._id} key={s._id}>\r\n//                       {s.name}\r\n//                     </option>\r\n//                   ))}\r\n//                 </select>\r\n\r\n//                 {form.category && (\r\n//                   <button\r\n//                     type=\"button\"\r\n//                     className=\"btn small\"\r\n//                     onClick={() => setAddingSub(!addingSub)}\r\n//                   >\r\n//                     {addingSub ? \"Close\" : \"Add\"}\r\n//                   </button>\r\n//                 )}\r\n//               </div>\r\n//             </div>\r\n\r\n//             {/* ADD SUBCATEGORY */}\r\n//             {addingSub && (\r\n//               <div className=\"form-group full-width addCategoryBox\">\r\n//                 <label>Add New Subcategory</label>\r\n\r\n//                 <div className=\"category-row\">\r\n//                   <input\r\n//                     value={newSubName}\r\n//                     onChange={(e) => setNewSubName(e.target.value)}\r\n//                     placeholder=\"Subcategory name\"\r\n//                   />\r\n\r\n//                   <input\r\n//                     type=\"file\"\r\n//                     accept=\"image/*\"\r\n//                     onChange={(e) => {\r\n//                       setNewSubImage(e.target.files[0]);\r\n//                       setNewSubPreview(\r\n//                         e.target.files[0]\r\n//                           ? URL.createObjectURL(e.target.files[0])\r\n//                           : null\r\n//                       );\r\n//                     }}\r\n//                   />\r\n\r\n//                   <button className=\"btn primary\" type=\"button\" onClick={handleCreateSub}>\r\n//                     Create\r\n//                   </button>\r\n//                 </div>\r\n\r\n//                 {newSubPreview && (\r\n//                   <img src={newSubPreview} className=\"categoryPreview\" alt=\"preview\" />\r\n//                 )}\r\n//               </div>\r\n//             )}\r\n\r\n//             {/* BASE PRICE */}\r\n//             <div className=\"form-group\">\r\n//               <label>Base Price *</label>\r\n//               <input\r\n//                 type=\"number\"\r\n//                 required\r\n//                 name=\"basePrice\"\r\n//                 value={form.basePrice}\r\n//                 onChange={handleChange}\r\n//               />\r\n//             </div>\r\n\r\n//             {/* DIFFERENCE */}\r\n//             <div className=\"form-group\">\r\n//               <label>Difference</label>\r\n//               <input\r\n//                 type=\"number\"\r\n//                 name=\"difference\"\r\n//                 value={form.difference}\r\n//                 onChange={handleChange}\r\n//               />\r\n//             </div>\r\n\r\n//             {/* VALID TILL */}\r\n//             <div className=\"form-group\">\r\n//               <label>Valid Till</label>\r\n//               <input\r\n//                 type=\"date\"\r\n//                 name=\"validTill\"\r\n//                 value={form.validTill}\r\n//                 onChange={handleChange}\r\n//               />\r\n//             </div>\r\n\r\n//             {/* IMAGE */}\r\n//             <div className=\"form-group\">\r\n//               <label>Image</label>\r\n//               <input type=\"file\" accept=\"image/*\" onChange={handleChange} />\r\n//             </div>\r\n//           </div>\r\n\r\n//           {/* DESCRIPTION */}\r\n//           <div className=\"form-group full-width\">\r\n//             <label>Description</label>\r\n//             <textarea\r\n//               name=\"description\"\r\n//               value={form.description}\r\n//               onChange={handleChange}\r\n//             ></textarea>\r\n//           </div>\r\n\r\n//           {/* SUBMIT BUTTON */}\r\n//           <div className=\"form-actions\">\r\n//             <button className=\"btn primary\" disabled={loading}>\r\n//               {loading\r\n//                 ? \"Saving...\"\r\n//                 : isCopyMode\r\n//                 ? \"Save Copy\"\r\n//                 : editId\r\n//                 ? \"Update\"\r\n//                 : \"Add\"}\r\n//             </button>\r\n\r\n//             {(editId || isCopyMode) && (\r\n//               <button\r\n//                 type=\"button\"\r\n//                 className=\"btn cancel\"\r\n//                 onClick={() => {\r\n//                   setEditId(null);\r\n//                   setIsCopyMode(false);\r\n//                   setForm({\r\n//                     name: \"\",\r\n//                     category: \"\",\r\n//                     subcategory: \"\",\r\n//                     description: \"\",\r\n//                     basePrice: \"\",\r\n//                     difference: \"\",\r\n//                     validTill: \"\",\r\n//                     file: null,\r\n//                   });\r\n//                 }}\r\n//               >\r\n//                 Cancel\r\n//               </button>\r\n//             )}\r\n//           </div>\r\n//         </form>\r\n//       </div>\r\n\r\n//       {/* CSV IMPORT EXPORT */}\r\n//       <div className=\"csv-controls\">\r\n//         <div>\r\n//           <input\r\n//             type=\"file\"\r\n//             accept=\".csv\"\r\n//             ref={csvInputRef}\r\n//             onChange={handleCsvSelect}\r\n//           />\r\n//           <button className=\"btn small\" onClick={handleImportCsv}>\r\n//             Import CSV\r\n//           </button>\r\n//         </div>\r\n\r\n//         <div>\r\n//           <button className=\"btn small\" onClick={handleExportCsv}>\r\n//             Export CSV\r\n//           </button>\r\n\r\n//           <button className=\"btn small\" onClick={handleExportSelectedCsv}>\r\n//             Export Selected CSV\r\n//           </button>\r\n//         </div>\r\n//       </div>\r\n\r\n//       {/* TABLE */}\r\n//       <div className=\"table-card\">\r\n//         <div className=\"table-header\">\r\n//           <h2>üìã Items</h2>\r\n//           <span>Total: {filteredItems.length}</span>\r\n//         </div>\r\n\r\n//         {!isMobile ? (\r\n//           <table>\r\n//             <thead>\r\n//               <tr>\r\n//                 <th>\r\n//                   <input\r\n//                     type=\"checkbox\"\r\n//                     checked={\r\n//                       selectedItems.length === filteredItems.length &&\r\n//                       filteredItems.length > 0\r\n//                     }\r\n//                     onChange={() => {\r\n//                       if (selectedItems.length === filteredItems.length)\r\n//                         setSelectedItems([]);\r\n//                       else\r\n//                         setSelectedItems(filteredItems.map((x) => x._id));\r\n//                     }}\r\n//                   />\r\n//                 </th>\r\n//                 <th>Sr</th>\r\n//                 <th>Image</th>\r\n//                 <th>Name</th>\r\n//                 <th>Category</th>\r\n//                 <th>Subcategory</th>\r\n//                 <th>Base</th>\r\n//                 <th>Diff</th>\r\n//                 <th>Final</th>\r\n//                 <th>Status</th>\r\n//                 <th>Valid Till</th>\r\n//                 <th>Actions</th>\r\n//               </tr>\r\n//             </thead>\r\n\r\n//             <tbody>\r\n//               {currentItems.map((item, i) => (\r\n//                 <tr key={item._id}>\r\n//                   <td>\r\n//                     <input\r\n//                       type=\"checkbox\"\r\n//                       checked={selectedItems.includes(item._id)}\r\n//                       onChange={() =>\r\n//                         selectedItems.includes(item._id)\r\n//                           ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\r\n//                           : setSelectedItems([...selectedItems, item._id])\r\n//                       }\r\n//                     />\r\n//                   </td>\r\n\r\n//                   <td>{(currentPage - 1) * itemsPerPage + (i + 1)}</td>\r\n\r\n//                   <td>{item.image ? <img src={item.image} alt=\"img\" /> : \"No Img\"}</td>\r\n\r\n//                   <td>{item.name}</td>\r\n\r\n//                   <td>{item.category?.name}</td>\r\n\r\n//                   <td>{item.subcategory?.name || \"-\"}</td>\r\n\r\n//                   <td>‚Çπ{item.basePrice}</td>\r\n\r\n//                   <td>{item.difference || 0}</td>\r\n\r\n//                   <td>‚Çπ{Number(item.basePrice) + Number(item.difference || 0)}</td>\r\n\r\n//                   <td>\r\n//                     <button\r\n//                       className={\r\n//                         item.status === \"active\" ? \"status-active\" : \"status-inactive\"\r\n//                       }\r\n//                       onClick={() => handleStatusToggle(item)}\r\n//                     >\r\n//                       {item.status === \"active\" ? \"üü¢ Active\" : \"üî¥ Inactive\"}\r\n//                     </button>\r\n//                   </td>\r\n\r\n//                   <td>\r\n//                     {item.validTill\r\n//                       ? new Date(item.validTill).toLocaleDateString()\r\n//                       : \"-\"}\r\n//                   </td>\r\n\r\n//                   <td className=\"actions\">\r\n//                     <button className=\"btn edit\" onClick={() => handleEdit(item)}>\r\n//                       Edit\r\n//                     </button>\r\n\r\n//                     <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\r\n//                       Delete\r\n//                     </button>\r\n\r\n//                     <button\r\n//                       className=\"btn small\"\r\n//                       style={{ background: \"#6f42c1\", color: \"#fff\" }}\r\n//                       onClick={() => handleCopyToEdit(item)}\r\n//                     >\r\n//                       Copy\r\n//                     </button>\r\n//                   </td>\r\n//                 </tr>\r\n//               ))}\r\n//             </tbody>\r\n//           </table>\r\n//         ) : (\r\n//           <div className=\"mobile-list\">\r\n//             {currentItems.map((item) => (\r\n//               <div key={item._id} className=\"mobile-card\">\r\n//                 <input\r\n//                   type=\"checkbox\"\r\n//                   checked={selectedItems.includes(item._id)}\r\n//                   onChange={() =>\r\n//                     selectedItems.includes(item._id)\r\n//                       ? setSelectedItems(selectedItems.filter((x) => x !== item._id))\r\n//                       : setSelectedItems([...selectedItems, item._id])\r\n//                   }\r\n//                 />\r\n\r\n//                 {item.image ? (\r\n//                   <img src={item.image} alt=\"img\" />\r\n//                 ) : (\r\n//                   <div>No Image</div>\r\n//                 )}\r\n\r\n//                 <h3>{item.name}</h3>\r\n\r\n//                 <p>\r\n//                   <b>Category:</b> {item.category?.name}\r\n//                 </p>\r\n\r\n//                 <p>\r\n//                   <b>Subcategory:</b> {item.subcategory?.name || \"-\"}\r\n//                 </p>\r\n\r\n//                 <p>\r\n//                   <b>Base:</b> ‚Çπ{item.basePrice}\r\n//                 </p>\r\n\r\n//                 <p>\r\n//                   <b>Final:</b> ‚Çπ\r\n//                   {Number(item.basePrice) + Number(item.difference || 0)}\r\n//                 </p>\r\n\r\n//                 <button\r\n//                   className={\r\n//                     item.status === \"active\" ? \"status-active\" : \"status-inactive\"\r\n//                   }\r\n//                   onClick={() => handleStatusToggle(item)}\r\n//                 >\r\n//                   {item.status === \"active\" ? \"Active\" : \"Inactive\"}\r\n//                 </button>\r\n\r\n//                 <div className=\"actions\">\r\n//                   <button className=\"btn edit\" onClick={() => handleEdit(item)}>\r\n//                     Edit\r\n//                   </button>\r\n\r\n//                   <button className=\"btn delete\" onClick={() => handleDelete(item._id)}>\r\n//                     Delete\r\n//                   </button>\r\n\r\n//                   <button\r\n//                     className=\"btn small\"\r\n//                     style={{ background: \"#6f42c1\", color: \"#fff\" }}\r\n//                     onClick={() => handleCopyToEdit(item)}\r\n//                   >\r\n//                     Copy\r\n//                   </button>\r\n//                 </div>\r\n//               </div>\r\n//             ))}\r\n//           </div>\r\n//         )}\r\n\r\n//         {/* PAGINATION */}\r\n//         <div className=\"pagination\">\r\n//           <button\r\n//             disabled={currentPage === 1}\r\n//             onClick={() => setCurrentPage((p) => p - 1)}\r\n//           >\r\n//             Previous\r\n//           </button>\r\n\r\n//           {Array.from({ length: totalPages }).map((_, i) => (\r\n//             <button\r\n//               key={i}\r\n//               className={i + 1 === currentPage ? \"active-page\" : \"\"}\r\n//               onClick={() => setCurrentPage(i + 1)}\r\n//             >\r\n//               {i + 1}\r\n//             </button>\r\n//           ))}\r\n\r\n//           <button\r\n//             disabled={currentPage === totalPages}\r\n//             onClick={() => setCurrentPage((p) => p + 1)}\r\n//           >\r\n//             Next\r\n//           </button>\r\n//         </div>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// }\r\n"],"mappings":";AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}